import SpecialTraitsSection from '../sections/special-traits-section.js';
import GenerateSpellcastingDialog from './generate-spellcasting-dialog.js';

import CurrentContext from '../../../models/current-context.js';
import Spellcasting from '../../../models/spellcasting.js';

import * as TestCustomElements from '../../../helpers/test/test-custom-elements.js';
import { inputValueAndTriggerEvent } from '../../../helpers/element-helpers.js';
import { formatIntegerWithOrdinalIndicator, formatSpellSlotQuantity } from '../../../helpers/string-formatter.js';

import SpellcasterTypes from '../../../data/spellcaster-types.js';

const abilitiesModel = CurrentContext.creature.abilities;
const challengeRatingModel = CurrentContext.creature.challengeRating;
const specialTraitsModel = CurrentContext.creature.specialTraits;

let specialTraitsSection;
let generateSpellcastingDialog;

beforeAll(async() => {
  await TestCustomElements.define();
  await SpecialTraitsSection.define();
  await GenerateSpellcastingDialog.define();
});

beforeEach(() => {
  abilitiesModel.reset();
  challengeRatingModel.reset();
  specialTraitsModel.reset();

  specialTraitsSection = new SpecialTraitsSection();
  TestCustomElements.initializeSection(specialTraitsSection);
  specialTraitsSection.connect();

  generateSpellcastingDialog = specialTraitsSection.editElements.generateSpellcastingDialog;
  generateSpellcastingDialog.connect();
});

describe('when the generate spellcasting dialog is opened', () => {
  beforeEach(() => {
    specialTraitsSection.showElements.section.click();
    specialTraitsSection.editElements.generateSpellcastingButton.click();
  });

  it('should initially have its model and controls set to their defaults, and focus on the spellcaster type field', () => {
    verifyDialogResetToDefaults();
  });

  describe('and the dialog is filled out and the reset button is clicked', () => {
    it('should reset the dialog model and controls back to their defaults, and focus on the spellcaster type field', () => {
      const spellcastingModel = createDummySpellcastingModel();

      setDialogControls(spellcastingModel);

      generateSpellcastingDialog.resetButton.click();

      verifyDialogResetToDefaults();
    });
  });

  describe('and the dialog is submitted and then opened again', () => {
    it('should reset the dialog model and controls back to their defaults, and focus on the spellcaster type field', () => {
      const spellcastingModel = createDummySpellcastingModel();

      setDialogControls(spellcastingModel);

      generateSpellcastingDialog.generateSpellcastingButton.click();
      specialTraitsSection.editElements.generateSpellcastingButton.click();

      verifyDialogResetToDefaults();
    });
  });

  describe('and the dialog fields are populated and then the spellcaster type is changed', () => {
    it('should clear all spells', () => {
      const originalModel = createDummySpellcastingModel();

      const modifiedModel = createDummySpellcastingModel();
      modifiedModel.spellcasterType = 'cleric';
      modifiedModel.spellcasterAbility = 'wisdom';
      modifiedModel.clearAllSpells();

      const expectedGeneratedText = '[name] is a 18th-level spellcaster. Its spellcasting ability is Wisdom (spell save DC sdc[wis], atk[wis] to hit with spell attacks). [name] has the following cleric spells prepared:\n\n';
      const expectedRenderedText = 'The commoner is a 18th-level spellcaster. Its spellcasting ability is Wisdom (spell save DC 10, +2 to hit with spell attacks). The commoner has the following cleric spells prepared:\n\n';

      setDialogControls(originalModel);

      inputValueAndTriggerEvent(generateSpellcastingDialog.spellcasterTypeSelect, modifiedModel.spellcasterType);

      verifyDialogModel(modifiedModel, expectedGeneratedText);
      verifyDialogControls(modifiedModel, expectedRenderedText);

      generateSpellcastingDialog.generateSpellcastingButton.click();

      verifySpecialTraitBlocks(modifiedModel.spellcasterType, expectedGeneratedText, expectedRenderedText);
    });
  });

  describe('and the dialog fields are populated and then the spellcaster level is changed and changed back', () => {
    it('should retain all spells', () => {
      const originalModel = createDummySpellcastingModel();

      const modifiedModel = createDummySpellcastingModel();
      modifiedModel.spellcasterLevel = 9;

      const expectedGeneratedText = '[name] is a 18th-level spellcaster. Its spellcasting ability is Intelligence (spell save DC sdc[int], atk[int] to hit with spell attacks). [name] has the following wizard spells prepared:\n\nCantrips (at will): *fire bolt*, *light*, *mage hand*, *prestidigitation*, *shocking grasp*\n1st level (4 slots): *detect magic*, *identify*, *mage armor*, *magic missile*\n2nd level (3 slots): *detect thoughts*, *mirror image*, *misty step*\n3rd level (3 slots): *counterspell*, *fly*, *lightning bolt*\n4th level (3 slots): *banishment*, *fire shield*, *stoneskin*\n5th level (3 slots): *cone of cold*, *scrying*, *wall of force*\n6th level (1 slot): *globe of invulnerability*\n7th level (1 slot): *teleport*\n8th level (1 slot): *mind blank*\n9th level (1 slot): *time stop*';
      const expectedRenderedText = 'The commoner is a 18th-level spellcaster. Its spellcasting ability is Intelligence (spell save DC 10, +2 to hit with spell attacks). The commoner has the following wizard spells prepared:\n\nCantrips (at will): <em>fire bolt</em>, <em>light</em>, <em>mage hand</em>, <em>prestidigitation</em>, <em>shocking grasp</em>\n1st level (4 slots): <em>detect magic</em>, <em>identify</em>, <em>mage armor</em>, <em>magic missile</em>\n2nd level (3 slots): <em>detect thoughts</em>, <em>mirror image</em>, <em>misty step</em>\n3rd level (3 slots): <em>counterspell</em>, <em>fly</em>, <em>lightning bolt</em>\n4th level (3 slots): <em>banishment</em>, <em>fire shield</em>, <em>stoneskin</em>\n5th level (3 slots): <em>cone of cold</em>, <em>scrying</em>, <em>wall of force</em>\n6th level (1 slot): <em>globe of invulnerability</em>\n7th level (1 slot): <em>teleport</em>\n8th level (1 slot): <em>mind blank</em>\n9th level (1 slot): <em>time stop</em>';

      setDialogControls(originalModel);

      inputValueAndTriggerEvent(generateSpellcastingDialog.spellcasterLevelInput, modifiedModel.spellcasterLevel);
      inputValueAndTriggerEvent(generateSpellcastingDialog.spellcasterLevelInput, originalModel.spellcasterLevel);

      verifyDialogModel(originalModel, expectedGeneratedText);
      verifyDialogControls(originalModel, expectedRenderedText);

      generateSpellcastingDialog.generateSpellcastingButton.click();

      verifySpecialTraitBlocks(originalModel.spellcasterType, expectedGeneratedText, expectedRenderedText);
    });
  });

  describe('and the dialog is submitted with a blank spellcaster level', () => {
    it('should display an error', () => {
      inputValueAndTriggerEvent(generateSpellcastingDialog.spellcasterLevelInput, '');

      generateSpellcastingDialog.generateSpellcastingButton.click();

      expect(generateSpellcastingDialog).toHaveError(
        generateSpellcastingDialog.spellcasterLevelInput,
        'Spellcaster Level must be a valid number.');
    });
  });

  describe('and a spellcaster type is selected, it should have the correct spells in the autocomplete list for each spell level', () => {
    /* eslint-disable indent, no-unexpected-multiline, no-unused-vars */
    it.each
    `
      description   | spellcasterType | cantrips                                                                                                                                                                                                            | level1Spells                                                                                                                                                                                                                                                                                                                                                                                                                                      | level2Spells                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            | level3Spells                                                                                                                                                                                                                                                                                                                                                                                                                         | level4Spells                                                                                                                                                                                                                                                                                                                                                                                                 | level5Spells                                                                                                                                                                                                                                                                                                                                                              | level6Spells                                                                                                                                                                                                                                                                                                                                     | level7Spells                                                                                                                                                                                                                                                 | level8Spells                                                                                                                                                                                     | level9Spells
      ${'Innate'}   | ${'innate'}     | ${[]}                                                                                                                                                                                                               | ${[]}                                                                                                                                                                                                                                                                                                                                                                                                                                             | ${[]}                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   | ${[]}                                                                                                                                                                                                                                                                                                                                                                                                                                | ${[]}                                                                                                                                                                                                                                                                                                                                                                                                        | ${[]}                                                                                                                                                                                                                                                                                                                                                                     | ${[]}                                                                                                                                                                                                                                                                                                                                            | ${[]}                                                                                                                                                                                                                                                        | ${[]}                                                                                                                                                                                            | ${[]}
      ${'Bard'}     | ${'bard'}       | ${['Dancing Lights', 'Light', 'Mage Hand', 'Mending', 'Message', 'Minor Illusion', 'Prestidigitation', 'True Strike', 'Vicious Mockery']}                                                                           | ${['Animal Friendship', 'Bane', 'Charm Person', 'Comprehend Languages', 'Cure Wounds', 'Detect Magic', 'Disguise Self', 'Faerie Fire', 'Feather Fall', 'Healing Word', 'Heroism', 'Hideous Laughter', 'Identify', 'Illusory Script', 'Longstrider', 'Silent Image', 'Sleep', 'Speak with Animals', 'Thunderwave', 'Unseen Servant']}                                                                                                              | ${['Animal Messenger', 'Blindness/Deafness', 'Calm Emotions', 'Detect Thoughts', 'Enhance Ability', 'Enthrall', 'Heat Metal', 'Hold Person', 'Invisibility', 'Knock', 'Lesser Restoration', 'Locate Animals or Plants', 'Locate Object', 'Magic Mouth', 'See Invisibility', 'Shatter', 'Silence', 'Suggestion', 'Zone of Truth']}                                                                                                                                                                       | ${['Bestow Curse', 'Clairvoyance', 'Dispel Magic', 'Fear', 'Glyph of Warding', 'Hypnotic Pattern', 'Major Image', 'Nondetection', 'Plant Growth', 'Sending', 'Speak with Dead', 'Speak with Plants', 'Stinking Cloud', 'Tiny Hut', 'Tongues']}                                                                                                                                                                                       | ${['Compulsion', 'Confusion', 'Dimension Door', 'Freedom of Movement', 'Greater Invisibility', 'Hallucinatory Terrain', 'Locate Creature', 'Polymorph']}                                                                                                                                                                                                                                                     | ${['Animate Objects', 'Awaken', 'Dominate Person', 'Dream', 'Geas', 'Greater Restoration', 'Hold Monster', 'Legend Lore', 'Mass Cure Wounds', 'Mislead', 'Modify Memory', 'Planar Binding', 'Raise Dead', 'Scrying', 'Seeming', 'Teleportation Circle']}                                                                                                                  | ${['Eyebite', 'Find the Path', 'Guards and Wards', 'Irresistible Dance', 'Mass Suggestion', 'Programmed Illusion', 'True Seeing']}                                                                                                                                                                                                               | ${['Arcane Sword', 'Etherealness', 'Forcecage', 'Magnificent Mansion', 'Mirage Arcane', 'Project Image', 'Regenerate', 'Resurrection', 'Symbol', 'Teleport']}                                                                                                | ${['Dominate Monster', 'Feeblemind', 'Glibness', 'Mind Blank', 'Power Word Stun']}                                                                                                               | ${['Foresight', 'Power Word Kill', 'True Polymorph']}
      ${'Cleric'}   | ${'cleric'}     | ${['Guidance', 'Light', 'Mending', 'Resistance', 'Sacred Flame', 'Spare the Dying', 'Thaumaturgy']}                                                                                                                 | ${['Bane', 'Bless', 'Command', 'Create or Destroy Water', 'Cure Wounds', 'Detect Evil and Good', 'Detect Magic', 'Detect Poison and Disease', 'Guiding Bolt', 'Healing Word', 'Inflict Wounds', 'Protection from Evil and Good', 'Purify Food and Drink', 'Sancutary', 'Shield of Faith']}                                                                                                                                                        | ${['Aid', 'Augury', 'Blindness/Deafness', 'Calm Emotions', 'Continual Flame', 'Enhance Ability', 'Find Traps', 'Gentle Repose', 'Hold Person', 'Lesser Restoration', 'Locate Object', 'Prayer of Healing', 'Protection from Poison', 'Silence', 'Spiritual Weapon', 'Warding Bond', 'Zone of Truth']}                                                                                                                                                                                                   | ${['Animate Dead', 'Beacon of Hope', 'Bestow Curse', 'Clairvoyance', 'Create Food and Water', 'Daylight', 'Dispel Magic', 'Glyph of Warding', 'Magic Circle', 'Mass Healing Word', 'Meld into Stone', 'Protection from Energy', 'Remove Curse', 'Revivify', 'Sending', 'Speak with Dead', 'Spirit Guardians', 'Tongues', 'Water Walk']}                                                                                              | ${['Banishment', 'Control Water', 'Death Ward', 'Divination', 'Freedom of Movement', 'Guardian of Faith', 'Locate Creature', 'Stone Shape']}                                                                                                                                                                                                                                                                 | ${['Commune', 'Contagion', 'Dispel Evil and Good', 'Flame Strike', 'Geas', 'Greater Restoration', 'Hallow', 'Insect Plague', 'Legend Lore', 'Mass Cure Wounds', 'Planar Binding', 'Raise Dead', 'Scrying']}                                                                                                                                                               | ${['Blade Barrier', 'Create Undead', 'Find the Path', 'Forbiddance', 'Harm', 'Heal', 'Heroes\' Feast', 'Planar Ally', 'True Seeing', 'Word of Recall']}                                                                                                                                                                                          | ${['Conjure Celestial', 'Divine Word', 'Etherealness', 'Fire Storm', 'Plane Shift', 'Regenerate', 'Resurrection', 'Symbol']}                                                                                                                                 | ${['Antimagic Field', 'Control Weather', 'Earthquake', 'Holy Aura']}                                                                                                                             | ${['Astral Projection', 'Gate', 'Mass Heal', 'True Resurrection']}
      ${'Druid'}    | ${'druid'}      | ${['Druidcraft', 'Guidance', 'Mending', 'Poison Spray', 'Produce Flame', 'Resistance', 'Shillelagh']}                                                                                                               | ${['Animal Friendship', 'Charm Person', 'Create or Destroy Water', 'Cure Wounds', 'Detect Magic', 'Detect Poison and Disease', 'Entangle', 'Faerie Fire', 'Fog Cloud', 'Goodberry', 'Healing Word', 'Jump', 'Longstrider', 'Purify Food and Drink', 'Speak with Animals', 'Thunderwave']}                                                                                                                                                         | ${['Animal Messenger', 'Barkskin', 'Darkvision', 'Enhance Ability', 'Find Traps', 'Flame Blade', 'Flaming Sphere', 'Gust of Wind', 'Heat Metal', 'Hold Person', 'Lesser Restoration', 'Locate Animals or Plants', 'Locate Object', 'Moonbeam', 'Pass without Trace', 'Protection from Poison', 'Spike Growth']}                                                                                                                                                                                         | ${['Call Lightning', 'Conjure Animals', 'Daylight', 'Dispel Magic', 'Meld into Stone', 'Plant Growth', 'Protection from Energy', 'Sleet Storm', 'Speak with Plants', 'Water Breathing', 'Water Walk', 'Wind Wall']}                                                                                                                                                                                                                  | ${['Blight', 'Confusion', 'Conjure Minor Elementals', 'Conjure Woodland Beings', 'Control Water', 'Dominate Beast', 'Freedom of Movement', 'Giant Insect', 'Hallucinatory Terrain', 'Ice Storm', 'Locate Creature', 'Polymorph', 'Stone Shape', 'Stoneskin', 'Wall of Fire']}                                                                                                                                | ${['Antilife Shell', 'Awaken', 'Commune with Nature', 'Conjure Elemental', 'Contagion', 'Geas', 'Greater Restoration', 'Insect Plague', 'Mass Cure Wounds', 'Planar Binding', 'Reincarnate', 'Scrying', 'Tree Stride', 'Wall of Stone']}                                                                                                                                  | ${['Conjure Fey', 'Find the Path', 'Heal', 'Heroes\' Feast', 'Move Earth', 'Sunbeam', 'Transport via Plants', 'Wall of Thorns', 'Wind Walk']}                                                                                                                                                                                                    | ${['Fire Storm', 'Mirage Arcane', 'Plane Shift', 'Regenerate', 'Reverse Gravity']}                                                                                                                                                                           | ${['Animal Shapes', 'Antipathy/Sympathy', 'Control Weather', 'Earthquake', 'Feeblemind', 'Sunburst']}                                                                                            | ${['Foresight', 'Shapechange', 'Storm of Vengeance', 'True Resurrection']}
      ${'Paladin'}  | ${'paladin'}    | ${[]}                                                                                                                                                                                                               | ${['Bless', 'Command', 'Cure Wounds', 'Detect Evil and Good', 'Detect Magic', 'Detect Poison and Disease', 'Divine Favor', 'Heroism', 'Protection from Evil and Good', 'Purify Food and Drink', 'Shield of Faith']}                                                                                                                                                                                                                               | ${['Aid', 'Branding Smite', 'Find Steed', 'Lesser Restoration', 'Locate Object', 'Magic Weapon', 'Protection from Poison', 'Zone of Truth']}                                                                                                                                                                                                                                                                                                                                                            | ${['Create Food and Water', 'Daylight', 'Dispel Magic', 'Magic Circle', 'Remove Curse', 'Revivify']}                                                                                                                                                                                                                                                                                                                                 | ${['Banishment', 'Death Ward', 'Locate Creature']}                                                                                                                                                                                                                                                                                                                                                           | ${['Dispel Evil and Good', 'Geas', 'Raise Dead']}                                                                                                                                                                                                                                                                                                                         | ${[]}                                                                                                                                                                                                                                                                                                                                            | ${[]}                                                                                                                                                                                                                                                        | ${[]}                                                                                                                                                                                            | ${[]}
      ${'Ranger'}   | ${'ranger'}     | ${[]}                                                                                                                                                                                                               | ${['Alarm', 'Animal Friendship', 'Cure Wounds', 'Detect Magic', 'Detect Poison and Disease', 'Fog Cloud', 'Goodberry', 'Hunter\'s Mark', 'Jump', 'Longstrider', 'Speak with Animals']}                                                                                                                                                                                                                                                            | ${['Animal Messenger', 'Barkskin', 'Darkvision', 'Find Traps', 'Lesser Restoration', 'Locate Animals or Plants', 'Locate Object', 'Pass without Trace', 'Protection from Poison', 'Silence', 'Spike Growth']}                                                                                                                                                                                                                                                                                           | ${['Conjure Animals', 'Daylight', 'Nondetection', 'Plant Growth', 'Protection from Energy', 'Speak with Plants', 'Water Breathing', 'Water Walk', 'Wind Wall']}                                                                                                                                                                                                                                                                      | ${['Conjure Woodland Beings', 'Freedom of Movement', 'Locate Creature', 'Stoneskin']}                                                                                                                                                                                                                                                                                                                        | ${['Commune with Nature', 'Tree Stride']}                                                                                                                                                                                                                                                                                                                                 | ${[]}                                                                                                                                                                                                                                                                                                                                            | ${[]}                                                                                                                                                                                                                                                        | ${[]}                                                                                                                                                                                            | ${[]}
      ${'Sorcerer'} | ${'sorcerer'}   | ${['Acid Splash', 'Chill Touch', 'Dancing Lights', 'Fire Bolt', 'Light', 'Mage Hand', 'Mending', 'Message', 'Minor Illusion', 'Poison Spray', 'Prestidigitation', 'Ray of Frost', 'Shocking Grasp', 'True Strike']} | ${['Burning Hands', 'Charm Person', 'Color Spray', 'Comprehend Languages', 'Detect Magic', 'Disguise Self', 'Expeditious Retreat', 'False Life', 'Feather Fall', 'Fog Cloud', 'Jump', 'Mage Armor', 'Magic Missile', 'Shield', 'Silent Image', 'Sleep', 'Thunderwave']}                                                                                                                                                                           | ${['Alter Self', 'Blindness/Deafness', 'Blur', 'Darkness', 'Darkvision', 'Detect Thoughts', 'Enhance Ability', 'Enlarge/Reduce', 'Gust of Wind', 'Hold Person', 'Invisibility', 'Knock', 'Levitate', 'Mirror Image', 'Misty Step', 'Scorching Ray', 'See Invisibility', 'Shatter', 'Spider Climb', 'Suggestion', 'Web']}                                                                                                                                                                                | ${['Blink', 'Clairvoyance', 'Counterspell', 'Daylight', 'Dispel Magic', 'Fear', 'Fireball', 'Fly', 'Gaseous Form', 'Haste', 'Hypnotic Pattern', 'Lightning Bolt', 'Major Image', 'Protection from Energy', 'Sleet Storm', 'Slow', 'Stinking Cloud', 'Tongues', 'Water Breathing', 'Water Walk']}                                                                                                                                     | ${['Banishment', 'Blight', 'Confusion', 'Dimension Door', 'Dominate Beast', 'Greater Invisibility', 'Ice Storm', 'Polymorph', 'Stoneskin', 'Wall of Fire']}                                                                                                                                                                                                                                                  | ${['Animate Objects', 'Cloudkill', 'Cone of Cold', 'Creation', 'Dominate Person', 'Hold Monster', 'Insect Plague', 'Seeming', 'Telekinesis', 'Teleportation Circle', 'Wall of Stone']}                                                                                                                                                                                    | ${['Chain Lightning', 'Circle of Death', 'Disintegrate', 'Eyebite', 'Globe of Invulnerability', 'Mass Suggestion', 'Move Earth', 'Sunbeam', 'True Seeing']}                                                                                                                                                                                      | ${['Delayed Blast Fireball', 'Etherealness', 'Finger of Death', 'Fire Storm', 'Plane Shift', 'Prismatic Spray', 'Reverse Gravity', 'Teleport']}                                                                                                              | ${['Dominate Monster', 'Earthquake', 'Incendiary Cloud', 'Power Word Stun', 'Sunburst']}                                                                                                         | ${['Gate', 'Meteor Swarm', 'Time Stop', 'Wish']}
      ${'Warlock'}  | ${'warlock'}    | ${['Chill Touch', 'Eldritch Blast', 'Mage Hand', 'Minor Illusion', 'Poison Spray', 'Prestidigitation', 'True Strike']}                                                                                              | ${['Charm Person', 'Comprehend Languages', 'Expeditious Retreat', 'Hellish Rebuke', 'Illusory Script', 'Protection from Evil and Good', 'Unseen Servant']}                                                                                                                                                                                                                                                                                        | ${['Darkness', 'Enthrall', 'Hold Person', 'Invisibility', 'Mirror Image', 'Misty Step', 'Ray of Enfeeblement', 'Shatter', 'Spider Climb', 'Suggestion']}                                                                                                                                                                                                                                                                                                                                                | ${['Counterspell', 'Dispel Magic', 'Fear', 'Fly', 'Gaseous Form', 'Hypnotic Pattern', 'Magic Circle', 'Major Image', 'Remove Curse', 'Tongues', 'Vampiric Touch']}                                                                                                                                                                                                                                                                   | ${['Blight', 'Dimension Door', 'Hallucinatory Terrain']}                                                                                                                                                                                                                                                                                                                                                     | ${['Contact Other Plane', 'Dream', 'Hold Monster', 'Scrying']}                                                                                                                                                                                                                                                                                                            | ${['Circle of Death', 'Conjure Fey', 'Create Undead', 'Eyebite', 'Flesh to Stone', 'Mass Suggestion', 'True Seeing']}                                                                                                                                                                                                                            | ${['Etherealness', 'Finger of Death', 'Forcecage', 'Plane Shift']}                                                                                                                                                                                           | ${['Demiplane', 'Dominate Monster', 'Feeblemind', 'Glibness', 'Power Word Stun']}                                                                                                                | ${['Astral Projection', 'Foresight', 'Imprisonment', 'True Polymorph']}
      ${'Wizard'}   | ${'wizard'}     | ${['Acid Splash', 'Chill Touch', 'Dancing Lights', 'Fire Bolt', 'Light', 'Mage Hand', 'Mending', 'Message', 'Minor Illusion', 'Poison Spray', 'Prestidigitation', 'Ray of Frost', 'Shocking Grasp', 'True Strike']} | ${['Alarm', 'Burning Hands', 'Charm Person', 'Color Spray', 'Comprehend Languages', 'Detect Magic', 'Disguise Self', 'Expeditious Retreat', 'False Life', 'Feather Fall', 'Find Familiar', 'Floating Disk', 'Fog Cloud', 'Grease', 'Hideous Laughter', 'Identify', 'Illusory Script', 'Jump', 'Longstrider', 'Mage Armor', 'Magic Missile', 'Protection from Evil and Good', 'Shield', 'Silent Image', 'Sleep', 'Thunderwave', 'Unseen Servant']} | ${['Acid Arrow', 'Alter Self', 'Arcane Lock', 'Arcanist\'s Magic Aura', 'Blindness/Deafness', 'Blur', 'Continual Flame', 'Darkness', 'Darkvision', 'Detect Thoughts', 'Enlarge/Reduce', 'Flaming Sphere', 'Gentle Repose', 'Gust of Wind', 'Hold Person', 'Invisibility', 'Knock', 'Levitate', 'Locate Object', 'Magic Mouth', 'Magic Weapon', 'Mirror Image', 'Misty Step', 'Ray of Enfeeblement', 'Rope Trick', 'Scorching Ray', 'See Invisibility', 'Shatter', 'Spider Climb', 'Suggestion', 'Web']} | ${['Animate Dead', 'Bestow Curse', 'Blink', 'Clairvoyance', 'Counterspell', 'Dispel Magic', 'Fear', 'Fireball', 'Fly', 'Gaseous Form', 'Glyph of Warding', 'Haste', 'Hypnotic Pattern', 'Lightning Bolt', 'Magic Circle', 'Major Image', 'Nondetection', 'Phantom Steed', 'Protection from Energy', 'Remove Curse', 'Sending', 'Sleet Storm', 'Slow', 'Stinking Cloud', 'Tiny Hut', 'Tongues', 'Vampiric Touch', 'Water Breathing']} | ${['Arcane Eye', 'Banishment', 'Black Tentacles', 'Blight', 'Confusion', 'Conjure Minor Elementals', 'Control Water', 'Dimension Door', 'Fabricate', 'Faithful Hound', 'Fire Shield', 'Greater Invisibility', 'Hallucinatory Terrain', 'Ice Storm', 'Locate Creature', 'Phantasmal Killer', 'Polymorph', 'Private Sanctum', 'Resilient Sphere', 'Secret Chest', 'Stone Shape', 'Stoneskin', 'Wall of Fire']} | ${['Animate Objects', 'Arcane Hand', 'Cloudkill', 'Cone of Cold', 'Conjure Elemental', 'Contact Other Plane', 'Creation', 'Dominate Person', 'Dream', 'Geas', 'Hold Monster', 'Legend Lore', 'Mislead', 'Modify Memory', 'Passwall', 'Planar Binding', 'Scrying', 'Seeming', 'Telekinesis', 'Telepathic Bond', 'Teleportation Circle', 'Wall of Force', 'Wall of Stone']} | ${['Chain Lightning', 'Circle of Death', 'Contingency', 'Create Undead', 'Disintegrate', 'Eyebite', 'Flesh to Stone', 'Freezing Sphere', 'Globe of Invulnerability', 'Guards and Wards', 'Instant Summons', 'Irresistible Dance', 'Magic Jar', 'Mass Suggestion', 'Move Earth', 'Programmed Illusion', 'Sunbeam', 'True Seeing', 'Wall of Ice']} | ${['Arcane Sword', 'Delayed Blast Fireball', 'Etherealness', 'Finger of Death', 'Forcecage', 'Magnificent Mansion', 'Mirage Arcane', 'Plane Shift', 'Prismatic Spray', 'Project Image', 'Reverse Gravity', 'Sequester', 'Simulacrum', 'Symbol', 'Teleport']} | ${['Antimagic Field', 'Antipathy/Sympathy', 'Clone', 'Control Weather', 'Demiplane', 'Dominate Monster', 'Feeblemind', 'Incendiary Cloud', 'Maze', 'Mind Blank', 'Power Word Stun', 'Sunburst']} | ${['Astral Projection', 'Foresight', 'Gate', 'Imprisonment', 'Meteor Swarm', 'Prismatic Wall', 'Shapechange', 'Time Stop', 'True Polymorph', 'Weird', 'Wish']}
    `
    ('$description',
    ({spellcasterType, cantrips, level1Spells, level2Spells, level3Spells, level4Spells, level5Spells, level6Spells, level7Spells, level8Spells, level9Spells}) => {
      const spellcastingModel = new Spellcasting();
      spellcastingModel.spellcasterType = spellcasterType;
      spellcastingModel.spellcasterLevel = 20;

      setDialogControls(spellcastingModel);

      for (let spellLevel = 0; spellLevel <= 9; spellLevel++) {
        const expectedSpells = (spellLevel === 0) ? cantrips : eval(`level${spellLevel}Spells`);
        const spellCategoryBox = generateSpellcastingDialog.spellCategoryBoxes[spellLevel];
        const actualSpells = spellCategoryBox.propertyList.dataListOptions.map(object => object.value);

        expect(actualSpells).toStrictEqual(expectedSpells);
      }
    });
    /* eslint-enable indent, no-unexpected-multiline */
  });

  describe('and the dialog is submitted with certain component requirements, it should add a new spellcasting block under special traits', () => {
    /* eslint-disable indent, no-unexpected-multiline */
    it.each
    `
      description                                 | innate   | verbal   | somatic  | material | expectedGeneratedText                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           | expectedRenderedText
      ${'innate spellcaster, no components'}      | ${true}  | ${false} | ${false} | ${false} | ${'[name]\'s innate spellcasting ability is Intelligence (spell save DC sdc[int], atk[int] to hit with spell attacks). It can innately cast the following spells, requiring no components:\n\nAt will: *fire bolt*, *light*, *mage hand*, *prestidigitation*, *shocking grasp*\n3/day each: *detect magic*, *identify*, *mage armor*, *magic missile*\n2/day each: *detect thoughts*, *mirror image*, *misty step*\n1/day each: *counterspell*, *fly*, *lightning bolt*'}                                                                                                                                                                                                                                                                                                                                                                                       | ${'The commoner\'s innate spellcasting ability is Intelligence (spell save DC 10, +2 to hit with spell attacks). It can innately cast the following spells, requiring no components:\n\nAt will: <em>fire bolt</em>, <em>light</em>, <em>mage hand</em>, <em>prestidigitation</em>, <em>shocking grasp</em>\n3/day each: <em>detect magic</em>, <em>identify</em>, <em>mage armor</em>, <em>magic missile</em>\n2/day each: <em>detect thoughts</em>, <em>mirror image</em>, <em>misty step</em>\n1/day each: <em>counterspell</em>, <em>fly</em>, <em>lightning bolt</em>'}
      ${'innate spellcaster, only verbal'}        | ${true}  | ${true}  | ${false} | ${false} | ${'[name]\'s innate spellcasting ability is Intelligence (spell save DC sdc[int], atk[int] to hit with spell attacks). It can innately cast the following spells, requiring only verbal components:\n\nAt will: *fire bolt*, *light*, *mage hand*, *prestidigitation*, *shocking grasp*\n3/day each: *detect magic*, *identify*, *mage armor*, *magic missile*\n2/day each: *detect thoughts*, *mirror image*, *misty step*\n1/day each: *counterspell*, *fly*, *lightning bolt*'}                                                                                                                                                                                                                                                                                                                                                                              | ${'The commoner\'s innate spellcasting ability is Intelligence (spell save DC 10, +2 to hit with spell attacks). It can innately cast the following spells, requiring only verbal components:\n\nAt will: <em>fire bolt</em>, <em>light</em>, <em>mage hand</em>, <em>prestidigitation</em>, <em>shocking grasp</em>\n3/day each: <em>detect magic</em>, <em>identify</em>, <em>mage armor</em>, <em>magic missile</em>\n2/day each: <em>detect thoughts</em>, <em>mirror image</em>, <em>misty step</em>\n1/day each: <em>counterspell</em>, <em>fly</em>, <em>lightning bolt</em>'}
      ${'innate spellcaster, only somatic'}       | ${true}  | ${false} | ${true}  | ${false} | ${'[name]\'s innate spellcasting ability is Intelligence (spell save DC sdc[int], atk[int] to hit with spell attacks). It can innately cast the following spells, requiring only somatic components:\n\nAt will: *fire bolt*, *light*, *mage hand*, *prestidigitation*, *shocking grasp*\n3/day each: *detect magic*, *identify*, *mage armor*, *magic missile*\n2/day each: *detect thoughts*, *mirror image*, *misty step*\n1/day each: *counterspell*, *fly*, *lightning bolt*'}                                                                                                                                                                                                                                                                                                                                                                             | ${'The commoner\'s innate spellcasting ability is Intelligence (spell save DC 10, +2 to hit with spell attacks). It can innately cast the following spells, requiring only somatic components:\n\nAt will: <em>fire bolt</em>, <em>light</em>, <em>mage hand</em>, <em>prestidigitation</em>, <em>shocking grasp</em>\n3/day each: <em>detect magic</em>, <em>identify</em>, <em>mage armor</em>, <em>magic missile</em>\n2/day each: <em>detect thoughts</em>, <em>mirror image</em>, <em>misty step</em>\n1/day each: <em>counterspell</em>, <em>fly</em>, <em>lightning bolt</em>'}
      ${'innate spellcaster, only material'}      | ${true}  | ${false} | ${false} | ${true}  | ${'[name]\'s innate spellcasting ability is Intelligence (spell save DC sdc[int], atk[int] to hit with spell attacks). It can innately cast the following spells, requiring only material components:\n\nAt will: *fire bolt*, *light*, *mage hand*, *prestidigitation*, *shocking grasp*\n3/day each: *detect magic*, *identify*, *mage armor*, *magic missile*\n2/day each: *detect thoughts*, *mirror image*, *misty step*\n1/day each: *counterspell*, *fly*, *lightning bolt*'}                                                                                                                                                                                                                                                                                                                                                                            | ${'The commoner\'s innate spellcasting ability is Intelligence (spell save DC 10, +2 to hit with spell attacks). It can innately cast the following spells, requiring only material components:\n\nAt will: <em>fire bolt</em>, <em>light</em>, <em>mage hand</em>, <em>prestidigitation</em>, <em>shocking grasp</em>\n3/day each: <em>detect magic</em>, <em>identify</em>, <em>mage armor</em>, <em>magic missile</em>\n2/day each: <em>detect thoughts</em>, <em>mirror image</em>, <em>misty step</em>\n1/day each: <em>counterspell</em>, <em>fly</em>, <em>lightning bolt</em>'}
      ${'innate spellcaster, no verbal'}          | ${true}  | ${false} | ${true}  | ${true}  | ${'[name]\'s innate spellcasting ability is Intelligence (spell save DC sdc[int], atk[int] to hit with spell attacks). It can innately cast the following spells, requiring no verbal components:\n\nAt will: *fire bolt*, *light*, *mage hand*, *prestidigitation*, *shocking grasp*\n3/day each: *detect magic*, *identify*, *mage armor*, *magic missile*\n2/day each: *detect thoughts*, *mirror image*, *misty step*\n1/day each: *counterspell*, *fly*, *lightning bolt*'}                                                                                                                                                                                                                                                                                                                                                                                | ${'The commoner\'s innate spellcasting ability is Intelligence (spell save DC 10, +2 to hit with spell attacks). It can innately cast the following spells, requiring no verbal components:\n\nAt will: <em>fire bolt</em>, <em>light</em>, <em>mage hand</em>, <em>prestidigitation</em>, <em>shocking grasp</em>\n3/day each: <em>detect magic</em>, <em>identify</em>, <em>mage armor</em>, <em>magic missile</em>\n2/day each: <em>detect thoughts</em>, <em>mirror image</em>, <em>misty step</em>\n1/day each: <em>counterspell</em>, <em>fly</em>, <em>lightning bolt</em>'}
      ${'innate spellcaster, no somatic'}         | ${true}  | ${true}  | ${false} | ${true}  | ${'[name]\'s innate spellcasting ability is Intelligence (spell save DC sdc[int], atk[int] to hit with spell attacks). It can innately cast the following spells, requiring no somatic components:\n\nAt will: *fire bolt*, *light*, *mage hand*, *prestidigitation*, *shocking grasp*\n3/day each: *detect magic*, *identify*, *mage armor*, *magic missile*\n2/day each: *detect thoughts*, *mirror image*, *misty step*\n1/day each: *counterspell*, *fly*, *lightning bolt*'}                                                                                                                                                                                                                                                                                                                                                                               | ${'The commoner\'s innate spellcasting ability is Intelligence (spell save DC 10, +2 to hit with spell attacks). It can innately cast the following spells, requiring no somatic components:\n\nAt will: <em>fire bolt</em>, <em>light</em>, <em>mage hand</em>, <em>prestidigitation</em>, <em>shocking grasp</em>\n3/day each: <em>detect magic</em>, <em>identify</em>, <em>mage armor</em>, <em>magic missile</em>\n2/day each: <em>detect thoughts</em>, <em>mirror image</em>, <em>misty step</em>\n1/day each: <em>counterspell</em>, <em>fly</em>, <em>lightning bolt</em>'}
      ${'innate spellcaster, no material'}        | ${true}  | ${true}  | ${true}  | ${false} | ${'[name]\'s innate spellcasting ability is Intelligence (spell save DC sdc[int], atk[int] to hit with spell attacks). It can innately cast the following spells, requiring no material components:\n\nAt will: *fire bolt*, *light*, *mage hand*, *prestidigitation*, *shocking grasp*\n3/day each: *detect magic*, *identify*, *mage armor*, *magic missile*\n2/day each: *detect thoughts*, *mirror image*, *misty step*\n1/day each: *counterspell*, *fly*, *lightning bolt*'}                                                                                                                                                                                                                                                                                                                                                                              | ${'The commoner\'s innate spellcasting ability is Intelligence (spell save DC 10, +2 to hit with spell attacks). It can innately cast the following spells, requiring no material components:\n\nAt will: <em>fire bolt</em>, <em>light</em>, <em>mage hand</em>, <em>prestidigitation</em>, <em>shocking grasp</em>\n3/day each: <em>detect magic</em>, <em>identify</em>, <em>mage armor</em>, <em>magic missile</em>\n2/day each: <em>detect thoughts</em>, <em>mirror image</em>, <em>misty step</em>\n1/day each: <em>counterspell</em>, <em>fly</em>, <em>lightning bolt</em>'}
      ${'innate spellcaster, all components'}     | ${true}  | ${true}  | ${true}  | ${true}  | ${'[name]\'s innate spellcasting ability is Intelligence (spell save DC sdc[int], atk[int] to hit with spell attacks). It can innately cast the following spells:\n\nAt will: *fire bolt*, *light*, *mage hand*, *prestidigitation*, *shocking grasp*\n3/day each: *detect magic*, *identify*, *mage armor*, *magic missile*\n2/day each: *detect thoughts*, *mirror image*, *misty step*\n1/day each: *counterspell*, *fly*, *lightning bolt*'}                                                                                                                                                                                                                                                                                                                                                                                                                | ${'The commoner\'s innate spellcasting ability is Intelligence (spell save DC 10, +2 to hit with spell attacks). It can innately cast the following spells:\n\nAt will: <em>fire bolt</em>, <em>light</em>, <em>mage hand</em>, <em>prestidigitation</em>, <em>shocking grasp</em>\n3/day each: <em>detect magic</em>, <em>identify</em>, <em>mage armor</em>, <em>magic missile</em>\n2/day each: <em>detect thoughts</em>, <em>mirror image</em>, <em>misty step</em>\n1/day each: <em>counterspell</em>, <em>fly</em>, <em>lightning bolt</em>'}
      ${'non-innate spellcaster, no components'}  | ${false} | ${false} | ${false} | ${false} | ${'[name] is a 18th-level spellcaster. Its spellcasting ability is Intelligence (spell save DC sdc[int], atk[int] to hit with spell attacks). It requires no components to cast its spells. [name] has the following wizard spells prepared:\n\nCantrips (at will): *fire bolt*, *light*, *mage hand*, *prestidigitation*, *shocking grasp*\n1st level (4 slots): *detect magic*, *identify*, *mage armor*, *magic missile*\n2nd level (3 slots): *detect thoughts*, *mirror image*, *misty step*\n3rd level (3 slots): *counterspell*, *fly*, *lightning bolt*\n4th level (3 slots): *banishment*, *fire shield*, *stoneskin*\n5th level (3 slots): *cone of cold*, *scrying*, *wall of force*\n6th level (1 slot): *globe of invulnerability*\n7th level (1 slot): *teleport*\n8th level (1 slot): *mind blank*\n9th level (1 slot): *time stop*'}            | ${'The commoner is a 18th-level spellcaster. Its spellcasting ability is Intelligence (spell save DC 10, +2 to hit with spell attacks). It requires no components to cast its spells. The commoner has the following wizard spells prepared:\n\nCantrips (at will): <em>fire bolt</em>, <em>light</em>, <em>mage hand</em>, <em>prestidigitation</em>, <em>shocking grasp</em>\n1st level (4 slots): <em>detect magic</em>, <em>identify</em>, <em>mage armor</em>, <em>magic missile</em>\n2nd level (3 slots): <em>detect thoughts</em>, <em>mirror image</em>, <em>misty step</em>\n3rd level (3 slots): <em>counterspell</em>, <em>fly</em>, <em>lightning bolt</em>\n4th level (3 slots): <em>banishment</em>, <em>fire shield</em>, <em>stoneskin</em>\n5th level (3 slots): <em>cone of cold</em>, <em>scrying</em>, <em>wall of force</em>\n6th level (1 slot): <em>globe of invulnerability</em>\n7th level (1 slot): <em>teleport</em>\n8th level (1 slot): <em>mind blank</em>\n9th level (1 slot): <em>time stop</em>'}
      ${'non-innate spellcaster, only verbal'}    | ${false} | ${true}  | ${false} | ${false} | ${'[name] is a 18th-level spellcaster. Its spellcasting ability is Intelligence (spell save DC sdc[int], atk[int] to hit with spell attacks). It requires only verbal components to cast its spells. [name] has the following wizard spells prepared:\n\nCantrips (at will): *fire bolt*, *light*, *mage hand*, *prestidigitation*, *shocking grasp*\n1st level (4 slots): *detect magic*, *identify*, *mage armor*, *magic missile*\n2nd level (3 slots): *detect thoughts*, *mirror image*, *misty step*\n3rd level (3 slots): *counterspell*, *fly*, *lightning bolt*\n4th level (3 slots): *banishment*, *fire shield*, *stoneskin*\n5th level (3 slots): *cone of cold*, *scrying*, *wall of force*\n6th level (1 slot): *globe of invulnerability*\n7th level (1 slot): *teleport*\n8th level (1 slot): *mind blank*\n9th level (1 slot): *time stop*'}   | ${'The commoner is a 18th-level spellcaster. Its spellcasting ability is Intelligence (spell save DC 10, +2 to hit with spell attacks). It requires only verbal components to cast its spells. The commoner has the following wizard spells prepared:\n\nCantrips (at will): <em>fire bolt</em>, <em>light</em>, <em>mage hand</em>, <em>prestidigitation</em>, <em>shocking grasp</em>\n1st level (4 slots): <em>detect magic</em>, <em>identify</em>, <em>mage armor</em>, <em>magic missile</em>\n2nd level (3 slots): <em>detect thoughts</em>, <em>mirror image</em>, <em>misty step</em>\n3rd level (3 slots): <em>counterspell</em>, <em>fly</em>, <em>lightning bolt</em>\n4th level (3 slots): <em>banishment</em>, <em>fire shield</em>, <em>stoneskin</em>\n5th level (3 slots): <em>cone of cold</em>, <em>scrying</em>, <em>wall of force</em>\n6th level (1 slot): <em>globe of invulnerability</em>\n7th level (1 slot): <em>teleport</em>\n8th level (1 slot): <em>mind blank</em>\n9th level (1 slot): <em>time stop</em>'}
      ${'non-innate spellcaster, only somatic'}   | ${false} | ${false} | ${true}  | ${false} | ${'[name] is a 18th-level spellcaster. Its spellcasting ability is Intelligence (spell save DC sdc[int], atk[int] to hit with spell attacks). It requires only somatic components to cast its spells. [name] has the following wizard spells prepared:\n\nCantrips (at will): *fire bolt*, *light*, *mage hand*, *prestidigitation*, *shocking grasp*\n1st level (4 slots): *detect magic*, *identify*, *mage armor*, *magic missile*\n2nd level (3 slots): *detect thoughts*, *mirror image*, *misty step*\n3rd level (3 slots): *counterspell*, *fly*, *lightning bolt*\n4th level (3 slots): *banishment*, *fire shield*, *stoneskin*\n5th level (3 slots): *cone of cold*, *scrying*, *wall of force*\n6th level (1 slot): *globe of invulnerability*\n7th level (1 slot): *teleport*\n8th level (1 slot): *mind blank*\n9th level (1 slot): *time stop*'}  | ${'The commoner is a 18th-level spellcaster. Its spellcasting ability is Intelligence (spell save DC 10, +2 to hit with spell attacks). It requires only somatic components to cast its spells. The commoner has the following wizard spells prepared:\n\nCantrips (at will): <em>fire bolt</em>, <em>light</em>, <em>mage hand</em>, <em>prestidigitation</em>, <em>shocking grasp</em>\n1st level (4 slots): <em>detect magic</em>, <em>identify</em>, <em>mage armor</em>, <em>magic missile</em>\n2nd level (3 slots): <em>detect thoughts</em>, <em>mirror image</em>, <em>misty step</em>\n3rd level (3 slots): <em>counterspell</em>, <em>fly</em>, <em>lightning bolt</em>\n4th level (3 slots): <em>banishment</em>, <em>fire shield</em>, <em>stoneskin</em>\n5th level (3 slots): <em>cone of cold</em>, <em>scrying</em>, <em>wall of force</em>\n6th level (1 slot): <em>globe of invulnerability</em>\n7th level (1 slot): <em>teleport</em>\n8th level (1 slot): <em>mind blank</em>\n9th level (1 slot): <em>time stop</em>'}
      ${'non-innate spellcaster, only material'}  | ${false} | ${false} | ${false} | ${true}  | ${'[name] is a 18th-level spellcaster. Its spellcasting ability is Intelligence (spell save DC sdc[int], atk[int] to hit with spell attacks). It requires only material components to cast its spells. [name] has the following wizard spells prepared:\n\nCantrips (at will): *fire bolt*, *light*, *mage hand*, *prestidigitation*, *shocking grasp*\n1st level (4 slots): *detect magic*, *identify*, *mage armor*, *magic missile*\n2nd level (3 slots): *detect thoughts*, *mirror image*, *misty step*\n3rd level (3 slots): *counterspell*, *fly*, *lightning bolt*\n4th level (3 slots): *banishment*, *fire shield*, *stoneskin*\n5th level (3 slots): *cone of cold*, *scrying*, *wall of force*\n6th level (1 slot): *globe of invulnerability*\n7th level (1 slot): *teleport*\n8th level (1 slot): *mind blank*\n9th level (1 slot): *time stop*'} | ${'The commoner is a 18th-level spellcaster. Its spellcasting ability is Intelligence (spell save DC 10, +2 to hit with spell attacks). It requires only material components to cast its spells. The commoner has the following wizard spells prepared:\n\nCantrips (at will): <em>fire bolt</em>, <em>light</em>, <em>mage hand</em>, <em>prestidigitation</em>, <em>shocking grasp</em>\n1st level (4 slots): <em>detect magic</em>, <em>identify</em>, <em>mage armor</em>, <em>magic missile</em>\n2nd level (3 slots): <em>detect thoughts</em>, <em>mirror image</em>, <em>misty step</em>\n3rd level (3 slots): <em>counterspell</em>, <em>fly</em>, <em>lightning bolt</em>\n4th level (3 slots): <em>banishment</em>, <em>fire shield</em>, <em>stoneskin</em>\n5th level (3 slots): <em>cone of cold</em>, <em>scrying</em>, <em>wall of force</em>\n6th level (1 slot): <em>globe of invulnerability</em>\n7th level (1 slot): <em>teleport</em>\n8th level (1 slot): <em>mind blank</em>\n9th level (1 slot): <em>time stop</em>'}
      ${'non-innate spellcaster, no verbal'}      | ${false} | ${false} | ${true}  | ${true}  | ${'[name] is a 18th-level spellcaster. Its spellcasting ability is Intelligence (spell save DC sdc[int], atk[int] to hit with spell attacks). It requires no verbal components to cast its spells. [name] has the following wizard spells prepared:\n\nCantrips (at will): *fire bolt*, *light*, *mage hand*, *prestidigitation*, *shocking grasp*\n1st level (4 slots): *detect magic*, *identify*, *mage armor*, *magic missile*\n2nd level (3 slots): *detect thoughts*, *mirror image*, *misty step*\n3rd level (3 slots): *counterspell*, *fly*, *lightning bolt*\n4th level (3 slots): *banishment*, *fire shield*, *stoneskin*\n5th level (3 slots): *cone of cold*, *scrying*, *wall of force*\n6th level (1 slot): *globe of invulnerability*\n7th level (1 slot): *teleport*\n8th level (1 slot): *mind blank*\n9th level (1 slot): *time stop*'}     | ${'The commoner is a 18th-level spellcaster. Its spellcasting ability is Intelligence (spell save DC 10, +2 to hit with spell attacks). It requires no verbal components to cast its spells. The commoner has the following wizard spells prepared:\n\nCantrips (at will): <em>fire bolt</em>, <em>light</em>, <em>mage hand</em>, <em>prestidigitation</em>, <em>shocking grasp</em>\n1st level (4 slots): <em>detect magic</em>, <em>identify</em>, <em>mage armor</em>, <em>magic missile</em>\n2nd level (3 slots): <em>detect thoughts</em>, <em>mirror image</em>, <em>misty step</em>\n3rd level (3 slots): <em>counterspell</em>, <em>fly</em>, <em>lightning bolt</em>\n4th level (3 slots): <em>banishment</em>, <em>fire shield</em>, <em>stoneskin</em>\n5th level (3 slots): <em>cone of cold</em>, <em>scrying</em>, <em>wall of force</em>\n6th level (1 slot): <em>globe of invulnerability</em>\n7th level (1 slot): <em>teleport</em>\n8th level (1 slot): <em>mind blank</em>\n9th level (1 slot): <em>time stop</em>'}
      ${'non-innate spellcaster, no somatic'}     | ${false} | ${true}  | ${false} | ${true}  | ${'[name] is a 18th-level spellcaster. Its spellcasting ability is Intelligence (spell save DC sdc[int], atk[int] to hit with spell attacks). It requires no somatic components to cast its spells. [name] has the following wizard spells prepared:\n\nCantrips (at will): *fire bolt*, *light*, *mage hand*, *prestidigitation*, *shocking grasp*\n1st level (4 slots): *detect magic*, *identify*, *mage armor*, *magic missile*\n2nd level (3 slots): *detect thoughts*, *mirror image*, *misty step*\n3rd level (3 slots): *counterspell*, *fly*, *lightning bolt*\n4th level (3 slots): *banishment*, *fire shield*, *stoneskin*\n5th level (3 slots): *cone of cold*, *scrying*, *wall of force*\n6th level (1 slot): *globe of invulnerability*\n7th level (1 slot): *teleport*\n8th level (1 slot): *mind blank*\n9th level (1 slot): *time stop*'}    | ${'The commoner is a 18th-level spellcaster. Its spellcasting ability is Intelligence (spell save DC 10, +2 to hit with spell attacks). It requires no somatic components to cast its spells. The commoner has the following wizard spells prepared:\n\nCantrips (at will): <em>fire bolt</em>, <em>light</em>, <em>mage hand</em>, <em>prestidigitation</em>, <em>shocking grasp</em>\n1st level (4 slots): <em>detect magic</em>, <em>identify</em>, <em>mage armor</em>, <em>magic missile</em>\n2nd level (3 slots): <em>detect thoughts</em>, <em>mirror image</em>, <em>misty step</em>\n3rd level (3 slots): <em>counterspell</em>, <em>fly</em>, <em>lightning bolt</em>\n4th level (3 slots): <em>banishment</em>, <em>fire shield</em>, <em>stoneskin</em>\n5th level (3 slots): <em>cone of cold</em>, <em>scrying</em>, <em>wall of force</em>\n6th level (1 slot): <em>globe of invulnerability</em>\n7th level (1 slot): <em>teleport</em>\n8th level (1 slot): <em>mind blank</em>\n9th level (1 slot): <em>time stop</em>'}
      ${'non-innate spellcaster, no material'}    | ${false} | ${true}  | ${true}  | ${false} | ${'[name] is a 18th-level spellcaster. Its spellcasting ability is Intelligence (spell save DC sdc[int], atk[int] to hit with spell attacks). It requires no material components to cast its spells. [name] has the following wizard spells prepared:\n\nCantrips (at will): *fire bolt*, *light*, *mage hand*, *prestidigitation*, *shocking grasp*\n1st level (4 slots): *detect magic*, *identify*, *mage armor*, *magic missile*\n2nd level (3 slots): *detect thoughts*, *mirror image*, *misty step*\n3rd level (3 slots): *counterspell*, *fly*, *lightning bolt*\n4th level (3 slots): *banishment*, *fire shield*, *stoneskin*\n5th level (3 slots): *cone of cold*, *scrying*, *wall of force*\n6th level (1 slot): *globe of invulnerability*\n7th level (1 slot): *teleport*\n8th level (1 slot): *mind blank*\n9th level (1 slot): *time stop*'}   | ${'The commoner is a 18th-level spellcaster. Its spellcasting ability is Intelligence (spell save DC 10, +2 to hit with spell attacks). It requires no material components to cast its spells. The commoner has the following wizard spells prepared:\n\nCantrips (at will): <em>fire bolt</em>, <em>light</em>, <em>mage hand</em>, <em>prestidigitation</em>, <em>shocking grasp</em>\n1st level (4 slots): <em>detect magic</em>, <em>identify</em>, <em>mage armor</em>, <em>magic missile</em>\n2nd level (3 slots): <em>detect thoughts</em>, <em>mirror image</em>, <em>misty step</em>\n3rd level (3 slots): <em>counterspell</em>, <em>fly</em>, <em>lightning bolt</em>\n4th level (3 slots): <em>banishment</em>, <em>fire shield</em>, <em>stoneskin</em>\n5th level (3 slots): <em>cone of cold</em>, <em>scrying</em>, <em>wall of force</em>\n6th level (1 slot): <em>globe of invulnerability</em>\n7th level (1 slot): <em>teleport</em>\n8th level (1 slot): <em>mind blank</em>\n9th level (1 slot): <em>time stop</em>'}
      ${'non-innate spellcaster, all components'} | ${false} | ${true}  | ${true}  | ${true}  | ${'[name] is a 18th-level spellcaster. Its spellcasting ability is Intelligence (spell save DC sdc[int], atk[int] to hit with spell attacks). [name] has the following wizard spells prepared:\n\nCantrips (at will): *fire bolt*, *light*, *mage hand*, *prestidigitation*, *shocking grasp*\n1st level (4 slots): *detect magic*, *identify*, *mage armor*, *magic missile*\n2nd level (3 slots): *detect thoughts*, *mirror image*, *misty step*\n3rd level (3 slots): *counterspell*, *fly*, *lightning bolt*\n4th level (3 slots): *banishment*, *fire shield*, *stoneskin*\n5th level (3 slots): *cone of cold*, *scrying*, *wall of force*\n6th level (1 slot): *globe of invulnerability*\n7th level (1 slot): *teleport*\n8th level (1 slot): *mind blank*\n9th level (1 slot): *time stop*'}                                                          | ${'The commoner is a 18th-level spellcaster. Its spellcasting ability is Intelligence (spell save DC 10, +2 to hit with spell attacks). The commoner has the following wizard spells prepared:\n\nCantrips (at will): <em>fire bolt</em>, <em>light</em>, <em>mage hand</em>, <em>prestidigitation</em>, <em>shocking grasp</em>\n1st level (4 slots): <em>detect magic</em>, <em>identify</em>, <em>mage armor</em>, <em>magic missile</em>\n2nd level (3 slots): <em>detect thoughts</em>, <em>mirror image</em>, <em>misty step</em>\n3rd level (3 slots): <em>counterspell</em>, <em>fly</em>, <em>lightning bolt</em>\n4th level (3 slots): <em>banishment</em>, <em>fire shield</em>, <em>stoneskin</em>\n5th level (3 slots): <em>cone of cold</em>, <em>scrying</em>, <em>wall of force</em>\n6th level (1 slot): <em>globe of invulnerability</em>\n7th level (1 slot): <em>teleport</em>\n8th level (1 slot): <em>mind blank</em>\n9th level (1 slot): <em>time stop</em>'}
    `
    ('$description:',
    ({innate, verbal, somatic, material, expectedGeneratedText, expectedRenderedText}) => {
      const spellcastingModel = createDummySpellcastingModel();

      if (innate) {
        spellcastingModel.spellcasterType = 'innate';
        spellcastingModel.spellcasterAbility = 'intelligence';
      }

      spellcastingModel.requiresVerbalComponents = verbal;
      spellcastingModel.requiresSomaticComponents = somatic;
      spellcastingModel.requiresMaterialComponents = material;

      setDialogControls(spellcastingModel, true);

      verifyDialogModel(spellcastingModel, expectedGeneratedText);
      verifyDialogControls(spellcastingModel, expectedRenderedText);

      generateSpellcastingDialog.generateSpellcastingButton.click();

      verifySpecialTraitBlocks(spellcastingModel.spellcasterType, expectedGeneratedText, expectedRenderedText);
    });
    /* eslint-enable indent, no-unexpected-multiline */
  });

  describe('and the dialog is submitted for an innate spellcaster, it should add a new spellcasting block under special traits', () => {
    /* eslint-disable indent, no-unexpected-multiline */
    it.each
    `
      description                   | abilityName       | abilityScore | proficiencyBonus | verbal   | somatic  | material | atWillSpells                                                       | threePerDaySpells                                                                                                           | twoPerDaySpells                                    | onePerDaySpells                                          | expectedGeneratedText | expectedRenderedText
      ${'Couatl'}                   | ${'charisma'}     | ${18}        | ${2}             | ${true}  | ${false} | ${false} | ${['Detect Evil and Good'], ['Detect Magic'], ['Detect Thoughts']} | ${['Bless', 'Create Food and Water', 'Cure Wounds', 'Lesser Restoration', 'Protection from Poison', 'Sanctuary', 'Shield']} | ${[]}                                              | ${['Dream', 'Greater Restoration', 'Scrying']}           | ${'[name]\'s innate spellcasting ability is Charisma (spell save DC sdc[cha], atk[cha] to hit with spell attacks). It can innately cast the following spells, requiring only verbal components:\n\nAt will: *detect thoughts*\n3/day each: *bless*, *create food and water*, *cure wounds*, *lesser restoration*, *protection from poison*, *sanctuary*, *shield*\n1/day each: *dream*, *greater restoration*, *scrying*'} | ${'The commoner\'s innate spellcasting ability is Charisma (spell save DC 14, +6 to hit with spell attacks). It can innately cast the following spells, requiring only verbal components:\n\nAt will: <em>detect thoughts</em>\n3/day each: <em>bless</em>, <em>create food and water</em>, <em>cure wounds</em>, <em>lesser restoration</em>, <em>protection from poison</em>, <em>sanctuary</em>, <em>shield</em>\n1/day each: <em>dream</em>, <em>greater restoration</em>, <em>scrying</em>'}
      ${'Deva'}                     | ${'charisma'}     | ${20}        | ${4}             | ${true}  | ${false} | ${false} | ${['Detect Evil and Good']}                                        | ${[]}                                                                                                                       | ${[]}                                              | ${['Commune', 'Raise Dead']}                             | ${'[name]\'s innate spellcasting ability is Charisma (spell save DC sdc[cha], atk[cha] to hit with spell attacks). It can innately cast the following spells, requiring only verbal components:\n\nAt will: *detect evil and good*\n1/day each: *commune*, *raise dead*'}                                                                                                                                                  | ${'The commoner\'s innate spellcasting ability is Charisma (spell save DC 17, +9 to hit with spell attacks). It can innately cast the following spells, requiring only verbal components:\n\nAt will: <em>detect evil and good</em>\n1/day each: <em>commune</em>, <em>raise dead</em>'}
      ${'Deep Gnome (Svirfneblin)'} | ${'intelligence'} | ${12}        | ${2}             | ${true}  | ${true}  | ${false} | ${['Nondetection']}                                                | ${[]}                                                                                                                       | ${[]}                                              | ${['Blindness/Deafness', 'Blur', 'Disguise Self']}       | ${'[name]\'s innate spellcasting ability is Intelligence (spell save DC sdc[int], atk[int] to hit with spell attacks). It can innately cast the following spells, requiring no material components:\n\nAt will: *nondetection*\n1/day each: *blindness/deafness*, *blur*, *disguise self*'}                                                                                                                                | ${'The commoner\'s innate spellcasting ability is Intelligence (spell save DC 11, +3 to hit with spell attacks). It can innately cast the following spells, requiring no material components:\n\nAt will: <em>nondetection</em>\n1/day each: <em>blindness/deafness</em>, <em>blur</em>, <em>disguise self</em>'}
      ${'Drider'}                   | ${'wisdom'}       | ${14}        | ${3}             | ${true}  | ${true}  | ${false} | ${['Dancing Lights']}                                              | ${[]}                                                                                                                       | ${[]}                                              | ${['Darkness', 'Faerie Fire']}                           | ${'[name]\'s innate spellcasting ability is Wisdom (spell save DC sdc[wis], atk[wis] to hit with spell attacks). It can innately cast the following spells, requiring no material components:\n\nAt will: *dancing lights*\n1/day each: *darkness*, *faerie fire*'}                                                                                                                                                        | ${'The commoner\'s innate spellcasting ability is Wisdom (spell save DC 13, +5 to hit with spell attacks). It can innately cast the following spells, requiring no material components:\n\nAt will: <em>dancing lights</em>\n1/day each: <em>darkness</em>, <em>faerie fire</em>'}
      ${'Night Hag'}                | ${'charisma'}     | ${16}        | ${3}             | ${true}  | ${true}  | ${false} | ${['Detect Magic', 'Magic Missile']}                               | ${[]}                                                                                                                       | ${['Plane Shift', 'Ray of Enfeeblement', 'Sleep']} | ${[]}                                                    | ${'[name]\'s innate spellcasting ability is Charisma (spell save DC sdc[cha], atk[cha] to hit with spell attacks). It can innately cast the following spells, requiring no material components:\n\nAt will: *detect magic*, *magic missile*\n2/day each: *plane shift*, *ray of enfeeblement*, *sleep*'}                                                                                                                   | ${'The commoner\'s innate spellcasting ability is Charisma (spell save DC 14, +6 to hit with spell attacks). It can innately cast the following spells, requiring no material components:\n\nAt will: <em>detect magic</em>, <em>magic missile</em>\n2/day each: <em>plane shift</em>, <em>ray of enfeeblement</em>, <em>sleep</em>'}
      ${'Pit Fiend'}                | ${'charisma'}     | ${24}        | ${6}             | ${true}  | ${true}  | ${false} | ${['Detect Magic', 'Fireball']}                                    | ${['Hold monster', 'Wall of fire']}                                                                                         | ${[]}                                              | ${[]}                                                    | ${'[name]\'s innate spellcasting ability is Charisma (spell save DC sdc[cha], atk[cha] to hit with spell attacks). It can innately cast the following spells, requiring no material components:\n\nAt will: *detect magic*, *fireball*\n3/day each: *hold monster*, *wall of fire*'}                                                                                                                                       | ${'The commoner\'s innate spellcasting ability is Charisma (spell save DC 21, +13 to hit with spell attacks). It can innately cast the following spells, requiring no material components:\n\nAt will: <em>detect magic</em>, <em>fireball</em>\n3/day each: <em>hold monster</em>, <em>wall of fire</em>'}
      ${'Solar'}                    | ${'charisma'}     | ${30}        | ${7}             | ${true}  | ${true}  | ${false} | ${['Detect Evil and Good', 'Invisibility']}                        | ${['Blade barrier', 'Dispel Evil and Good', 'Resurrection']}                                                                | ${[]}                                              | ${['Commune', 'Control Weather']}                        | ${'[name]\'s innate spellcasting ability is Charisma (spell save DC sdc[cha], atk[cha] to hit with spell attacks). It can innately cast the following spells, requiring no material components:\n\nAt will: *detect evil and good*, *invisibility*\n3/day each: *blade barrier*, *dispel evil and good*, *resurrection*\n1/day each: *commune*, *control weather*'}                                                        | ${'The commoner\'s innate spellcasting ability is Charisma (spell save DC 25, +17 to hit with spell attacks). It can innately cast the following spells, requiring no material components:\n\nAt will: <em>detect evil and good</em>, <em>invisibility</em>\n3/day each: <em>blade barrier</em>, <em>dispel evil and good</em>, <em>resurrection</em>\n1/day each: <em>commune</em>, <em>control weather</em>'}
      ${'Unicorn'}                  | ${'charisma'}     | ${16}        | ${3}             | ${false} | ${false} | ${false} | ${['Detect Evil and Good', 'Druidcraft', 'Pass without Trace']}    | ${[]}                                                                                                                       | ${[]}                                              | ${['Calm Emotions', 'Dispel Evil and Good', 'Entangle']} | ${'[name]\'s innate spellcasting ability is Charisma (spell save DC sdc[cha], atk[cha] to hit with spell attacks). It can innately cast the following spells, requiring no components:\n\nAt will: *detect evil and good*, *druidcraft*, *pass without trace*\n1/day each: *calm emotions*, *dispel evil and good*, *entangle*'}                                                                                           | ${'The commoner\'s innate spellcasting ability is Charisma (spell save DC 14, +6 to hit with spell attacks). It can innately cast the following spells, requiring no components:\n\nAt will: <em>detect evil and good</em>, <em>druidcraft</em>, <em>pass without trace</em>\n1/day each: <em>calm emotions</em>, <em>dispel evil and good</em>, <em>entangle</em>'}
    `
    ('$description',
    ({abilityName, abilityScore, proficiencyBonus, verbal, somatic, material, atWillSpells, threePerDaySpells, twoPerDaySpells, onePerDaySpells, expectedGeneratedText, expectedRenderedText}) => {
      abilitiesModel.abilities[abilityName].score = abilityScore;
      challengeRatingModel.proficiencyBonus = proficiencyBonus;

      const spellcastingModel = new Spellcasting();
      spellcastingModel.spellcasterType = 'innate';
      spellcastingModel.spellcasterAbility = abilityName;
      spellcastingModel.spellcasterLevel = 1;

      spellcastingModel.requiresVerbalComponents = verbal;
      spellcastingModel.requiresSomaticComponents = somatic;
      spellcastingModel.requiresMaterialComponents = material;

      spellcastingModel.spellCategories[0].spells = atWillSpells;
      spellcastingModel.spellCategories[1].spells = threePerDaySpells;
      spellcastingModel.spellCategories[2].spells = twoPerDaySpells;
      spellcastingModel.spellCategories[3].spells = onePerDaySpells;

      setDialogControls(spellcastingModel, true);

      verifyDialogModel(spellcastingModel, expectedGeneratedText);
      verifyDialogControls(spellcastingModel, expectedRenderedText);

      generateSpellcastingDialog.generateSpellcastingButton.click();

      verifySpecialTraitBlocks(spellcastingModel.spellcasterType, expectedGeneratedText, expectedRenderedText);
    });
    /* eslint-enable indent, no-unexpected-multiline */
  });

  describe('and the dialog is submitted for a generic spellcaster, it should add a new spellcasting block under special traits', () => {
    // TODO
  });

  describe('and the dialog is submitted for a bard spellcaster, it should add a new spellcasting block under special traits', () => {
    /* eslint-disable indent, no-unexpected-multiline, no-unused-vars */
    it.each
    `
      description        | level | abilityScore | proficiencyBonus | cantrips                                                         | level1Spells                                                                        | level2Spells                                     | level3Spells                             | level4Spells                                     | level5Spells                                       | level6Spells                                 | level7Spells               | level8Spells    | level9Spells          | expectedGeneratedText                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                | expectedRenderedText
      ${'Level 1 Bard'}  | ${1}  | ${12}        | ${2}             | ${['Dancing Lights', 'Vicious Mockery']}                         | ${['Disguise Self', 'Healing Word', 'Heroism', 'Hideous Laughter']}                 | ${[]}                                            | ${[]}                                    | ${[]}                                            | ${[]}                                              | ${[]}                                        | ${[]}                      | ${[]}           | ${[]}                 | ${'[name] is a 1st-level spellcaster. Its spellcasting ability is Charisma (spell save DC sdc[cha], atk[cha] to hit with spell attacks). [name] has the following bard spells prepared:\n\nCantrips (at will): *dancing lights*, *vicious mockery*\n1st level (2 slots): *disguise self*, *healing word*, *heroism*, *hideous laughter*'}                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            | ${'The commoner is a 1st-level spellcaster. Its spellcasting ability is Charisma (spell save DC 11, +3 to hit with spell attacks). The commoner has the following bard spells prepared:\n\nCantrips (at will): <em>dancing lights</em>, <em>vicious mockery</em>\n1st level (2 slots): <em>disguise self</em>, <em>healing word</em>, <em>heroism</em>, <em>hideous laughter</em>'}
      ${'Level 2 Bard'}  | ${2}  | ${12}        | ${2}             | ${['Dancing Lights', 'Vicious Mockery']}                         | ${['Charm Person', 'Disguise Self', 'Healing Word', 'Heroism', 'Hideous Laughter']} | ${[]}                                            | ${[]}                                    | ${[]}                                            | ${[]}                                              | ${[]}                                        | ${[]}                      | ${[]}           | ${[]}                 | ${'[name] is a 2nd-level spellcaster. Its spellcasting ability is Charisma (spell save DC sdc[cha], atk[cha] to hit with spell attacks). [name] has the following bard spells prepared:\n\nCantrips (at will): *dancing lights*, *vicious mockery*\n1st level (3 slots): *charm person*, *disguise self*, *healing word*, *heroism*, *hideous laughter*'}                                                                                                                                                                                                                                                                                                                                                                                                                                                                            | ${'The commoner is a 2nd-level spellcaster. Its spellcasting ability is Charisma (spell save DC 11, +3 to hit with spell attacks). The commoner has the following bard spells prepared:\n\nCantrips (at will): <em>dancing lights</em>, <em>vicious mockery</em>\n1st level (3 slots): <em>charm person</em>, <em>disguise self</em>, <em>healing word</em>, <em>heroism</em>, <em>hideous laughter</em>'}
      ${'Level 3 Bard'}  | ${3}  | ${12}        | ${2}             | ${['Dancing Lights', 'Vicious Mockery']}                         | ${['Charm Person', 'Disguise Self', 'Healing Word', 'Hideous Laughter']}            | ${['Detect Thoughts', 'Suggestion']}             | ${[]}                                    | ${[]}                                            | ${[]}                                              | ${[]}                                        | ${[]}                      | ${[]}           | ${[]}                 | ${'[name] is a 3rd-level spellcaster. Its spellcasting ability is Charisma (spell save DC sdc[cha], atk[cha] to hit with spell attacks). [name] has the following bard spells prepared:\n\nCantrips (at will): *dancing lights*, *vicious mockery*\n1st level (4 slots): *charm person*, *disguise self*, *healing word*, *hideous laughter*\n2nd level (2 slots): *detect thoughts*, *suggestion*'}                                                                                                                                                                                                                                                                                                                                                                                                                                 | ${'The commoner is a 3rd-level spellcaster. Its spellcasting ability is Charisma (spell save DC 11, +3 to hit with spell attacks). The commoner has the following bard spells prepared:\n\nCantrips (at will): <em>dancing lights</em>, <em>vicious mockery</em>\n1st level (4 slots): <em>charm person</em>, <em>disguise self</em>, <em>healing word</em>, <em>hideous laughter</em>\n2nd level (2 slots): <em>detect thoughts</em>, <em>suggestion</em>'}
      ${'Level 4 Bard'}  | ${4}  | ${14}        | ${2}             | ${['Dancing Lights', 'Message', 'Vicious Mockery']}              | ${['Charm Person', 'Disguise Self', 'Healing Word', 'Hideous Laughter']}            | ${['Detect Thoughts', 'Enthrall', 'Suggestion']} | ${[]}                                    | ${[]}                                            | ${[]}                                              | ${[]}                                        | ${[]}                      | ${[]}           | ${[]}                 | ${'[name] is a 4th-level spellcaster. Its spellcasting ability is Charisma (spell save DC sdc[cha], atk[cha] to hit with spell attacks). [name] has the following bard spells prepared:\n\nCantrips (at will): *dancing lights*, *message*, *vicious mockery*\n1st level (4 slots): *charm person*, *disguise self*, *healing word*, *hideous laughter*\n2nd level (3 slots): *detect thoughts*, *enthrall*, *suggestion*'}                                                                                                                                                                                                                                                                                                                                                                                                          | ${'The commoner is a 4th-level spellcaster. Its spellcasting ability is Charisma (spell save DC 12, +4 to hit with spell attacks). The commoner has the following bard spells prepared:\n\nCantrips (at will): <em>dancing lights</em>, <em>message</em>, <em>vicious mockery</em>\n1st level (4 slots): <em>charm person</em>, <em>disguise self</em>, <em>healing word</em>, <em>hideous laughter</em>\n2nd level (3 slots): <em>detect thoughts</em>, <em>enthrall</em>, <em>suggestion</em>'}
      ${'Level 5 Bard'}  | ${5}  | ${14}        | ${3}             | ${['Dancing Lights', 'Message', 'Vicious Mockery']}              | ${['Charm Person', 'Disguise Self', 'Healing Word', 'Hideous Laughter']}            | ${['Detect Thoughts', 'Enthrall', 'Suggestion']} | ${['Stinking Cloud']}                    | ${[]}                                            | ${[]}                                              | ${[]}                                        | ${[]}                      | ${[]}           | ${[]}                 | ${'[name] is a 5th-level spellcaster. Its spellcasting ability is Charisma (spell save DC sdc[cha], atk[cha] to hit with spell attacks). [name] has the following bard spells prepared:\n\nCantrips (at will): *dancing lights*, *message*, *vicious mockery*\n1st level (4 slots): *charm person*, *disguise self*, *healing word*, *hideous laughter*\n2nd level (3 slots): *detect thoughts*, *enthrall*, *suggestion*\n3rd level (2 slots): *stinking cloud*'}                                                                                                                                                                                                                                                                                                                                                                   | ${'The commoner is a 5th-level spellcaster. Its spellcasting ability is Charisma (spell save DC 13, +5 to hit with spell attacks). The commoner has the following bard spells prepared:\n\nCantrips (at will): <em>dancing lights</em>, <em>message</em>, <em>vicious mockery</em>\n1st level (4 slots): <em>charm person</em>, <em>disguise self</em>, <em>healing word</em>, <em>hideous laughter</em>\n2nd level (3 slots): <em>detect thoughts</em>, <em>enthrall</em>, <em>suggestion</em>\n3rd level (2 slots): <em>stinking cloud</em>'}
      ${'Level 6 Bard'}  | ${6}  | ${14}        | ${3}             | ${['Dancing Lights', 'Message', 'Vicious Mockery']}              | ${['Charm Person', 'Disguise Self', 'Healing Word', 'Hideous Laughter']}            | ${['Detect Thoughts', 'Enthrall', 'Suggestion']} | ${['Fear', 'Stinking Cloud']}            | ${[]}                                            | ${[]}                                              | ${[]}                                        | ${[]}                      | ${[]}           | ${[]}                 | ${'[name] is a 6th-level spellcaster. Its spellcasting ability is Charisma (spell save DC sdc[cha], atk[cha] to hit with spell attacks). [name] has the following bard spells prepared:\n\nCantrips (at will): *dancing lights*, *message*, *vicious mockery*\n1st level (4 slots): *charm person*, *disguise self*, *healing word*, *hideous laughter*\n2nd level (3 slots): *detect thoughts*, *enthrall*, *suggestion*\n3rd level (3 slots): *fear*, *stinking cloud*'}                                                                                                                                                                                                                                                                                                                                                           | ${'The commoner is a 6th-level spellcaster. Its spellcasting ability is Charisma (spell save DC 13, +5 to hit with spell attacks). The commoner has the following bard spells prepared:\n\nCantrips (at will): <em>dancing lights</em>, <em>message</em>, <em>vicious mockery</em>\n1st level (4 slots): <em>charm person</em>, <em>disguise self</em>, <em>healing word</em>, <em>hideous laughter</em>\n2nd level (3 slots): <em>detect thoughts</em>, <em>enthrall</em>, <em>suggestion</em>\n3rd level (3 slots): <em>fear</em>, <em>stinking cloud</em>'}
      ${'Level 7 Bard'}  | ${7}  | ${14}        | ${3}             | ${['Dancing Lights', 'Message', 'Vicious Mockery']}              | ${['Charm Person', 'Disguise Self', 'Healing Word', 'Hideous Laughter']}            | ${['Detect Thoughts', 'Enthrall', 'Suggestion']} | ${['Fear', 'Stinking Cloud']}            | ${['Compulsion']}                                | ${[]}                                              | ${[]}                                        | ${[]}                      | ${[]}           | ${[]}                 | ${'[name] is a 7th-level spellcaster. Its spellcasting ability is Charisma (spell save DC sdc[cha], atk[cha] to hit with spell attacks). [name] has the following bard spells prepared:\n\nCantrips (at will): *dancing lights*, *message*, *vicious mockery*\n1st level (4 slots): *charm person*, *disguise self*, *healing word*, *hideous laughter*\n2nd level (3 slots): *detect thoughts*, *enthrall*, *suggestion*\n3rd level (3 slots): *fear*, *stinking cloud*\n4th level (1 slot): *compulsion*'}                                                                                                                                                                                                                                                                                                                         | ${'The commoner is a 7th-level spellcaster. Its spellcasting ability is Charisma (spell save DC 13, +5 to hit with spell attacks). The commoner has the following bard spells prepared:\n\nCantrips (at will): <em>dancing lights</em>, <em>message</em>, <em>vicious mockery</em>\n1st level (4 slots): <em>charm person</em>, <em>disguise self</em>, <em>healing word</em>, <em>hideous laughter</em>\n2nd level (3 slots): <em>detect thoughts</em>, <em>enthrall</em>, <em>suggestion</em>\n3rd level (3 slots): <em>fear</em>, <em>stinking cloud</em>\n4th level (1 slot): <em>compulsion</em>'}
      ${'Level 8 Bard'}  | ${8}  | ${16}        | ${3}             | ${['Dancing Lights', 'Message', 'Vicious Mockery']}              | ${['Charm Person', 'Disguise Self', 'Healing Word', 'Hideous Laughter']}            | ${['Detect Thoughts', 'Enthrall', 'Suggestion']} | ${['Fear', 'Stinking Cloud']}            | ${['Compulsion', 'Polymorph']}                   | ${[]}                                              | ${[]}                                        | ${[]}                      | ${[]}           | ${[]}                 | ${'[name] is a 8th-level spellcaster. Its spellcasting ability is Charisma (spell save DC sdc[cha], atk[cha] to hit with spell attacks). [name] has the following bard spells prepared:\n\nCantrips (at will): *dancing lights*, *message*, *vicious mockery*\n1st level (4 slots): *charm person*, *disguise self*, *healing word*, *hideous laughter*\n2nd level (3 slots): *detect thoughts*, *enthrall*, *suggestion*\n3rd level (3 slots): *fear*, *stinking cloud*\n4th level (2 slots): *compulsion*, *polymorph*'}                                                                                                                                                                                                                                                                                                           | ${'The commoner is a 8th-level spellcaster. Its spellcasting ability is Charisma (spell save DC 14, +6 to hit with spell attacks). The commoner has the following bard spells prepared:\n\nCantrips (at will): <em>dancing lights</em>, <em>message</em>, <em>vicious mockery</em>\n1st level (4 slots): <em>charm person</em>, <em>disguise self</em>, <em>healing word</em>, <em>hideous laughter</em>\n2nd level (3 slots): <em>detect thoughts</em>, <em>enthrall</em>, <em>suggestion</em>\n3rd level (3 slots): <em>fear</em>, <em>stinking cloud</em>\n4th level (2 slots): <em>compulsion</em>, <em>polymorph</em>'}
      ${'Level 9 Bard'}  | ${9}  | ${16}        | ${4}             | ${['Dancing Lights', 'Message', 'Vicious Mockery']}              | ${['Charm Person', 'Disguise Self', 'Healing Word', 'Hideous Laughter']}            | ${['Detect Thoughts', 'Enthrall', 'Suggestion']} | ${['Fear', 'Stinking Cloud']}            | ${['Compulsion', 'Polymorph']}                   | ${['Modify Memory']}                               | ${[]}                                        | ${[]}                      | ${[]}           | ${[]}                 | ${'[name] is a 9th-level spellcaster. Its spellcasting ability is Charisma (spell save DC sdc[cha], atk[cha] to hit with spell attacks). [name] has the following bard spells prepared:\n\nCantrips (at will): *dancing lights*, *message*, *vicious mockery*\n1st level (4 slots): *charm person*, *disguise self*, *healing word*, *hideous laughter*\n2nd level (3 slots): *detect thoughts*, *enthrall*, *suggestion*\n3rd level (3 slots): *fear*, *stinking cloud*\n4th level (3 slots): *compulsion*, *polymorph*\n5th level (1 slot): *modify memory*'}                                                                                                                                                                                                                                                                      | ${'The commoner is a 9th-level spellcaster. Its spellcasting ability is Charisma (spell save DC 15, +7 to hit with spell attacks). The commoner has the following bard spells prepared:\n\nCantrips (at will): <em>dancing lights</em>, <em>message</em>, <em>vicious mockery</em>\n1st level (4 slots): <em>charm person</em>, <em>disguise self</em>, <em>healing word</em>, <em>hideous laughter</em>\n2nd level (3 slots): <em>detect thoughts</em>, <em>enthrall</em>, <em>suggestion</em>\n3rd level (3 slots): <em>fear</em>, <em>stinking cloud</em>\n4th level (3 slots): <em>compulsion</em>, <em>polymorph</em>\n5th level (1 slot): <em>modify memory</em>'}
      ${'Level 10 Bard'} | ${10} | ${16}        | ${4}             | ${['Dancing Lights', 'Mage Hand', 'Message', 'Vicious Mockery']} | ${['Charm Person', 'Disguise Self', 'Healing Word', 'Hideous Laughter']}            | ${['Detect Thoughts', 'Enthrall', 'Suggestion']} | ${['Fear', 'Stinking Cloud', 'Tongues']} | ${['Compulsion', 'Polymorph']}                   | ${['Mislead', 'Modify Memory']}                    | ${[]}                                        | ${[]}                      | ${[]}           | ${[]}                 | ${'[name] is a 10th-level spellcaster. Its spellcasting ability is Charisma (spell save DC sdc[cha], atk[cha] to hit with spell attacks). [name] has the following bard spells prepared:\n\nCantrips (at will): *dancing lights*, *mage hand*, *message*, *vicious mockery*\n1st level (4 slots): *charm person*, *disguise self*, *healing word*, *hideous laughter*\n2nd level (3 slots): *detect thoughts*, *enthrall*, *suggestion*\n3rd level (3 slots): *fear*, *stinking cloud*, *tongues*\n4th level (3 slots): *compulsion*, *polymorph*\n5th level (2 slots): *mislead*, *modify memory*'}                                                                                                                                                                                                                                 | ${'The commoner is a 10th-level spellcaster. Its spellcasting ability is Charisma (spell save DC 15, +7 to hit with spell attacks). The commoner has the following bard spells prepared:\n\nCantrips (at will): <em>dancing lights</em>, <em>mage hand</em>, <em>message</em>, <em>vicious mockery</em>\n1st level (4 slots): <em>charm person</em>, <em>disguise self</em>, <em>healing word</em>, <em>hideous laughter</em>\n2nd level (3 slots): <em>detect thoughts</em>, <em>enthrall</em>, <em>suggestion</em>\n3rd level (3 slots): <em>fear</em>, <em>stinking cloud</em>, <em>tongues</em>\n4th level (3 slots): <em>compulsion</em>, <em>polymorph</em>\n5th level (2 slots): <em>mislead</em>, <em>modify memory</em>'}
      ${'Level 11 Bard'} | ${11} | ${16}        | ${4}             | ${['Dancing Lights', 'Mage Hand', 'Message', 'Vicious Mockery']} | ${['Charm Person', 'Disguise Self', 'Healing Word', 'Hideous Laughter']}            | ${['Detect Thoughts', 'Enthrall', 'Suggestion']} | ${['Fear', 'Stinking Cloud', 'Tongues']} | ${['Compulsion', 'Polymorph']}                   | ${['Mislead', 'Modify Memory']}                    | ${['Irresistible Dance']}                    | ${[]}                      | ${[]}           | ${[]}                 | ${'[name] is a 11th-level spellcaster. Its spellcasting ability is Charisma (spell save DC sdc[cha], atk[cha] to hit with spell attacks). [name] has the following bard spells prepared:\n\nCantrips (at will): *dancing lights*, *mage hand*, *message*, *vicious mockery*\n1st level (4 slots): *charm person*, *disguise self*, *healing word*, *hideous laughter*\n2nd level (3 slots): *detect thoughts*, *enthrall*, *suggestion*\n3rd level (3 slots): *fear*, *stinking cloud*, *tongues*\n4th level (3 slots): *compulsion*, *polymorph*\n5th level (2 slots): *mislead*, *modify memory*\n6th level (1 slot): *irresistible dance*'}                                                                                                                                                                                       | ${'The commoner is a 11th-level spellcaster. Its spellcasting ability is Charisma (spell save DC 15, +7 to hit with spell attacks). The commoner has the following bard spells prepared:\n\nCantrips (at will): <em>dancing lights</em>, <em>mage hand</em>, <em>message</em>, <em>vicious mockery</em>\n1st level (4 slots): <em>charm person</em>, <em>disguise self</em>, <em>healing word</em>, <em>hideous laughter</em>\n2nd level (3 slots): <em>detect thoughts</em>, <em>enthrall</em>, <em>suggestion</em>\n3rd level (3 slots): <em>fear</em>, <em>stinking cloud</em>, <em>tongues</em>\n4th level (3 slots): <em>compulsion</em>, <em>polymorph</em>\n5th level (2 slots): <em>mislead</em>, <em>modify memory</em>\n6th level (1 slot): <em>irresistible dance</em>'}
      ${'Level 12 Bard'} | ${12} | ${18}        | ${4}             | ${['Dancing Lights', 'Mage Hand', 'Message', 'Vicious Mockery']} | ${['Charm Person', 'Disguise Self', 'Healing Word', 'Hideous Laughter']}            | ${['Detect Thoughts', 'Enthrall', 'Suggestion']} | ${['Fear', 'Stinking Cloud', 'Tongues']} | ${['Compulsion', 'Polymorph']}                   | ${['Mislead', 'Modify Memory']}                    | ${['Irresistible Dance']}                    | ${[]}                      | ${[]}           | ${[]}                 | ${'[name] is a 12th-level spellcaster. Its spellcasting ability is Charisma (spell save DC sdc[cha], atk[cha] to hit with spell attacks). [name] has the following bard spells prepared:\n\nCantrips (at will): *dancing lights*, *mage hand*, *message*, *vicious mockery*\n1st level (4 slots): *charm person*, *disguise self*, *healing word*, *hideous laughter*\n2nd level (3 slots): *detect thoughts*, *enthrall*, *suggestion*\n3rd level (3 slots): *fear*, *stinking cloud*, *tongues*\n4th level (3 slots): *compulsion*, *polymorph*\n5th level (2 slots): *mislead*, *modify memory*\n6th level (1 slot): *irresistible dance*'}                                                                                                                                                                                       | ${'The commoner is a 12th-level spellcaster. Its spellcasting ability is Charisma (spell save DC 16, +8 to hit with spell attacks). The commoner has the following bard spells prepared:\n\nCantrips (at will): <em>dancing lights</em>, <em>mage hand</em>, <em>message</em>, <em>vicious mockery</em>\n1st level (4 slots): <em>charm person</em>, <em>disguise self</em>, <em>healing word</em>, <em>hideous laughter</em>\n2nd level (3 slots): <em>detect thoughts</em>, <em>enthrall</em>, <em>suggestion</em>\n3rd level (3 slots): <em>fear</em>, <em>stinking cloud</em>, <em>tongues</em>\n4th level (3 slots): <em>compulsion</em>, <em>polymorph</em>\n5th level (2 slots): <em>mislead</em>, <em>modify memory</em>\n6th level (1 slot): <em>irresistible dance</em>'}
      ${'Level 13 Bard'} | ${13} | ${18}        | ${5}             | ${['Dancing Lights', 'Mage Hand', 'Message', 'Vicious Mockery']} | ${['Charm Person', 'Disguise Self', 'Healing Word', 'Hideous Laughter']}            | ${['Detect Thoughts', 'Enthrall', 'Suggestion']} | ${['Fear', 'Stinking Cloud', 'Tongues']} | ${['Compulsion', 'Polymorph']}                   | ${['Mislead', 'Modify Memory']}                    | ${['Irresistible Dance']}                    | ${['Magnificent Mansion']} | ${[]}           | ${[]}                 | ${'[name] is a 13th-level spellcaster. Its spellcasting ability is Charisma (spell save DC sdc[cha], atk[cha] to hit with spell attacks). [name] has the following bard spells prepared:\n\nCantrips (at will): *dancing lights*, *mage hand*, *message*, *vicious mockery*\n1st level (4 slots): *charm person*, *disguise self*, *healing word*, *hideous laughter*\n2nd level (3 slots): *detect thoughts*, *enthrall*, *suggestion*\n3rd level (3 slots): *fear*, *stinking cloud*, *tongues*\n4th level (3 slots): *compulsion*, *polymorph*\n5th level (2 slots): *mislead*, *modify memory*\n6th level (1 slot): *irresistible dance*\n7th level (1 slot): *magnificent mansion*'}                                                                                                                                            | ${'The commoner is a 13th-level spellcaster. Its spellcasting ability is Charisma (spell save DC 17, +9 to hit with spell attacks). The commoner has the following bard spells prepared:\n\nCantrips (at will): <em>dancing lights</em>, <em>mage hand</em>, <em>message</em>, <em>vicious mockery</em>\n1st level (4 slots): <em>charm person</em>, <em>disguise self</em>, <em>healing word</em>, <em>hideous laughter</em>\n2nd level (3 slots): <em>detect thoughts</em>, <em>enthrall</em>, <em>suggestion</em>\n3rd level (3 slots): <em>fear</em>, <em>stinking cloud</em>, <em>tongues</em>\n4th level (3 slots): <em>compulsion</em>, <em>polymorph</em>\n5th level (2 slots): <em>mislead</em>, <em>modify memory</em>\n6th level (1 slot): <em>irresistible dance</em>\n7th level (1 slot): <em>magnificent mansion</em>'}
      ${'Level 14 Bard'} | ${14} | ${18}        | ${5}             | ${['Dancing Lights', 'Mage Hand', 'Message', 'Vicious Mockery']} | ${['Charm Person', 'Disguise Self', 'Healing Word', 'Heroism', 'Hideous Laughter']} | ${['Detect Thoughts', 'Enthrall', 'Suggestion']} | ${['Fear', 'Stinking Cloud', 'Tongues']} | ${['Compulsion', 'Dimension Door', 'Polymorph']} | ${['Mislead', 'Modify Memory']}                    | ${['Irresistible Dance']}                    | ${['Magnificent Mansion']} | ${[]}           | ${[]}                 | ${'[name] is a 14th-level spellcaster. Its spellcasting ability is Charisma (spell save DC sdc[cha], atk[cha] to hit with spell attacks). [name] has the following bard spells prepared:\n\nCantrips (at will): *dancing lights*, *mage hand*, *message*, *vicious mockery*\n1st level (4 slots): *charm person*, *disguise self*, *healing word*, *heroism*, *hideous laughter*\n2nd level (3 slots): *detect thoughts*, *enthrall*, *suggestion*\n3rd level (3 slots): *fear*, *stinking cloud*, *tongues*\n4th level (3 slots): *compulsion*, *dimension door*, *polymorph*\n5th level (2 slots): *mislead*, *modify memory*\n6th level (1 slot): *irresistible dance*\n7th level (1 slot): *magnificent mansion*'}                                                                                                               | ${'The commoner is a 14th-level spellcaster. Its spellcasting ability is Charisma (spell save DC 17, +9 to hit with spell attacks). The commoner has the following bard spells prepared:\n\nCantrips (at will): <em>dancing lights</em>, <em>mage hand</em>, <em>message</em>, <em>vicious mockery</em>\n1st level (4 slots): <em>charm person</em>, <em>disguise self</em>, <em>healing word</em>, <em>heroism</em>, <em>hideous laughter</em>\n2nd level (3 slots): <em>detect thoughts</em>, <em>enthrall</em>, <em>suggestion</em>\n3rd level (3 slots): <em>fear</em>, <em>stinking cloud</em>, <em>tongues</em>\n4th level (3 slots): <em>compulsion</em>, <em>dimension door</em>, <em>polymorph</em>\n5th level (2 slots): <em>mislead</em>, <em>modify memory</em>\n6th level (1 slot): <em>irresistible dance</em>\n7th level (1 slot): <em>magnificent mansion</em>'}
      ${'Level 15 Bard'} | ${15} | ${18}        | ${5}             | ${['Dancing Lights', 'Mage Hand', 'Message', 'Vicious Mockery']} | ${['Charm Person', 'Disguise Self', 'Healing Word', 'Heroism', 'Hideous Laughter']} | ${['Detect Thoughts', 'Enthrall', 'Suggestion']} | ${['Fear', 'Stinking Cloud', 'Tongues']} | ${['Compulsion', 'Dimension Door', 'Polymorph']} | ${['Mislead', 'Modify Memory']}                    | ${['Irresistible Dance']}                    | ${['Magnificent Mansion']} | ${['Glibness']} | ${[]}                 | ${'[name] is a 15th-level spellcaster. Its spellcasting ability is Charisma (spell save DC sdc[cha], atk[cha] to hit with spell attacks). [name] has the following bard spells prepared:\n\nCantrips (at will): *dancing lights*, *mage hand*, *message*, *vicious mockery*\n1st level (4 slots): *charm person*, *disguise self*, *healing word*, *heroism*, *hideous laughter*\n2nd level (3 slots): *detect thoughts*, *enthrall*, *suggestion*\n3rd level (3 slots): *fear*, *stinking cloud*, *tongues*\n4th level (3 slots): *compulsion*, *dimension door*, *polymorph*\n5th level (2 slots): *mislead*, *modify memory*\n6th level (1 slot): *irresistible dance*\n7th level (1 slot): *magnificent mansion*\n8th level (1 slot): *glibness*'}                                                                               | ${'The commoner is a 15th-level spellcaster. Its spellcasting ability is Charisma (spell save DC 17, +9 to hit with spell attacks). The commoner has the following bard spells prepared:\n\nCantrips (at will): <em>dancing lights</em>, <em>mage hand</em>, <em>message</em>, <em>vicious mockery</em>\n1st level (4 slots): <em>charm person</em>, <em>disguise self</em>, <em>healing word</em>, <em>heroism</em>, <em>hideous laughter</em>\n2nd level (3 slots): <em>detect thoughts</em>, <em>enthrall</em>, <em>suggestion</em>\n3rd level (3 slots): <em>fear</em>, <em>stinking cloud</em>, <em>tongues</em>\n4th level (3 slots): <em>compulsion</em>, <em>dimension door</em>, <em>polymorph</em>\n5th level (2 slots): <em>mislead</em>, <em>modify memory</em>\n6th level (1 slot): <em>irresistible dance</em>\n7th level (1 slot): <em>magnificent mansion</em>\n8th level (1 slot): <em>glibness</em>'}
      ${'Level 16 Bard'} | ${16} | ${20}        | ${5}             | ${['Dancing Lights', 'Mage Hand', 'Message', 'Vicious Mockery']} | ${['Charm Person', 'Disguise Self', 'Healing Word', 'Heroism', 'Hideous Laughter']} | ${['Detect Thoughts', 'Enthrall', 'Suggestion']} | ${['Fear', 'Stinking Cloud', 'Tongues']} | ${['Compulsion', 'Dimension Door', 'Polymorph']} | ${['Mislead', 'Modify Memory']}                    | ${['Irresistible Dance']}                    | ${['Magnificent Mansion']} | ${['Glibness']} | ${[]}                 | ${'[name] is a 16th-level spellcaster. Its spellcasting ability is Charisma (spell save DC sdc[cha], atk[cha] to hit with spell attacks). [name] has the following bard spells prepared:\n\nCantrips (at will): *dancing lights*, *mage hand*, *message*, *vicious mockery*\n1st level (4 slots): *charm person*, *disguise self*, *healing word*, *heroism*, *hideous laughter*\n2nd level (3 slots): *detect thoughts*, *enthrall*, *suggestion*\n3rd level (3 slots): *fear*, *stinking cloud*, *tongues*\n4th level (3 slots): *compulsion*, *dimension door*, *polymorph*\n5th level (2 slots): *mislead*, *modify memory*\n6th level (1 slot): *irresistible dance*\n7th level (1 slot): *magnificent mansion*\n8th level (1 slot): *glibness*'}                                                                               | ${'The commoner is a 16th-level spellcaster. Its spellcasting ability is Charisma (spell save DC 18, +10 to hit with spell attacks). The commoner has the following bard spells prepared:\n\nCantrips (at will): <em>dancing lights</em>, <em>mage hand</em>, <em>message</em>, <em>vicious mockery</em>\n1st level (4 slots): <em>charm person</em>, <em>disguise self</em>, <em>healing word</em>, <em>heroism</em>, <em>hideous laughter</em>\n2nd level (3 slots): <em>detect thoughts</em>, <em>enthrall</em>, <em>suggestion</em>\n3rd level (3 slots): <em>fear</em>, <em>stinking cloud</em>, <em>tongues</em>\n4th level (3 slots): <em>compulsion</em>, <em>dimension door</em>, <em>polymorph</em>\n5th level (2 slots): <em>mislead</em>, <em>modify memory</em>\n6th level (1 slot): <em>irresistible dance</em>\n7th level (1 slot): <em>magnificent mansion</em>\n8th level (1 slot): <em>glibness</em>'}
      ${'Level 17 Bard'} | ${17} | ${20}        | ${6}             | ${['Dancing Lights', 'Mage Hand', 'Message', 'Vicious Mockery']} | ${['Charm Person', 'Disguise Self', 'Healing Word', 'Heroism', 'Hideous Laughter']} | ${['Detect Thoughts', 'Enthrall', 'Suggestion']} | ${['Fear', 'Stinking Cloud', 'Tongues']} | ${['Compulsion', 'Dimension Door', 'Polymorph']} | ${['Mislead', 'Modify Memory']}                    | ${['Irresistible Dance']}                    | ${['Magnificent Mansion']} | ${['Glibness']} | ${['True Polymorph']} | ${'[name] is a 17th-level spellcaster. Its spellcasting ability is Charisma (spell save DC sdc[cha], atk[cha] to hit with spell attacks). [name] has the following bard spells prepared:\n\nCantrips (at will): *dancing lights*, *mage hand*, *message*, *vicious mockery*\n1st level (4 slots): *charm person*, *disguise self*, *healing word*, *heroism*, *hideous laughter*\n2nd level (3 slots): *detect thoughts*, *enthrall*, *suggestion*\n3rd level (3 slots): *fear*, *stinking cloud*, *tongues*\n4th level (3 slots): *compulsion*, *dimension door*, *polymorph*\n5th level (2 slots): *mislead*, *modify memory*\n6th level (1 slot): *irresistible dance*\n7th level (1 slot): *magnificent mansion*\n8th level (1 slot): *glibness*\n9th level (1 slot): *true polymorph*'}                                         | ${'The commoner is a 17th-level spellcaster. Its spellcasting ability is Charisma (spell save DC 19, +11 to hit with spell attacks). The commoner has the following bard spells prepared:\n\nCantrips (at will): <em>dancing lights</em>, <em>mage hand</em>, <em>message</em>, <em>vicious mockery</em>\n1st level (4 slots): <em>charm person</em>, <em>disguise self</em>, <em>healing word</em>, <em>heroism</em>, <em>hideous laughter</em>\n2nd level (3 slots): <em>detect thoughts</em>, <em>enthrall</em>, <em>suggestion</em>\n3rd level (3 slots): <em>fear</em>, <em>stinking cloud</em>, <em>tongues</em>\n4th level (3 slots): <em>compulsion</em>, <em>dimension door</em>, <em>polymorph</em>\n5th level (2 slots): <em>mislead</em>, <em>modify memory</em>\n6th level (1 slot): <em>irresistible dance</em>\n7th level (1 slot): <em>magnificent mansion</em>\n8th level (1 slot): <em>glibness</em>\n9th level (1 slot): <em>true polymorph</em>'}
      ${'Level 18 Bard'} | ${18} | ${20}        | ${6}             | ${['Dancing Lights', 'Mage Hand', 'Message', 'Vicious Mockery']} | ${['Charm Person', 'Disguise Self', 'Healing Word', 'Heroism', 'Hideous Laughter']} | ${['Detect Thoughts', 'Enthrall', 'Suggestion']} | ${['Fear', 'Stinking Cloud', 'Tongues']} | ${['Compulsion', 'Dimension Door', 'Polymorph']} | ${['Dominate Person', 'Mislead', 'Modify Memory']} | ${['Irresistible Dance', 'Mass Suggestion']} | ${['Magnificent Mansion']} | ${['Glibness']} | ${['True Polymorph']} | ${'[name] is a 18th-level spellcaster. Its spellcasting ability is Charisma (spell save DC sdc[cha], atk[cha] to hit with spell attacks). [name] has the following bard spells prepared:\n\nCantrips (at will): *dancing lights*, *mage hand*, *message*, *vicious mockery*\n1st level (4 slots): *charm person*, *disguise self*, *healing word*, *heroism*, *hideous laughter*\n2nd level (3 slots): *detect thoughts*, *enthrall*, *suggestion*\n3rd level (3 slots): *fear*, *stinking cloud*, *tongues*\n4th level (3 slots): *compulsion*, *dimension door*, *polymorph*\n5th level (3 slots): *dominate person*, *mislead*, *modify memory*\n6th level (1 slot): *irresistible dance*, *mass suggestion*\n7th level (1 slot): *magnificent mansion*\n8th level (1 slot): *glibness*\n9th level (1 slot): *true polymorph*'}   | ${'The commoner is a 18th-level spellcaster. Its spellcasting ability is Charisma (spell save DC 19, +11 to hit with spell attacks). The commoner has the following bard spells prepared:\n\nCantrips (at will): <em>dancing lights</em>, <em>mage hand</em>, <em>message</em>, <em>vicious mockery</em>\n1st level (4 slots): <em>charm person</em>, <em>disguise self</em>, <em>healing word</em>, <em>heroism</em>, <em>hideous laughter</em>\n2nd level (3 slots): <em>detect thoughts</em>, <em>enthrall</em>, <em>suggestion</em>\n3rd level (3 slots): <em>fear</em>, <em>stinking cloud</em>, <em>tongues</em>\n4th level (3 slots): <em>compulsion</em>, <em>dimension door</em>, <em>polymorph</em>\n5th level (3 slots): <em>dominate person</em>, <em>mislead</em>, <em>modify memory</em>\n6th level (1 slot): <em>irresistible dance</em>, <em>mass suggestion</em>\n7th level (1 slot): <em>magnificent mansion</em>\n8th level (1 slot): <em>glibness</em>\n9th level (1 slot): <em>true polymorph</em>'}
      ${'Level 19 Bard'} | ${19} | ${22}        | ${6}             | ${['Dancing Lights', 'Mage Hand', 'Message', 'Vicious Mockery']} | ${['Charm Person', 'Disguise Self', 'Healing Word', 'Heroism', 'Hideous Laughter']} | ${['Detect Thoughts', 'Enthrall', 'Suggestion']} | ${['Fear', 'Stinking Cloud', 'Tongues']} | ${['Compulsion', 'Dimension Door', 'Polymorph']} | ${['Dominate Person', 'Mislead', 'Modify Memory']} | ${['Irresistible Dance', 'Mass Suggestion']} | ${['Magnificent Mansion']} | ${['Glibness']} | ${['True Polymorph']} | ${'[name] is a 19th-level spellcaster. Its spellcasting ability is Charisma (spell save DC sdc[cha], atk[cha] to hit with spell attacks). [name] has the following bard spells prepared:\n\nCantrips (at will): *dancing lights*, *mage hand*, *message*, *vicious mockery*\n1st level (4 slots): *charm person*, *disguise self*, *healing word*, *heroism*, *hideous laughter*\n2nd level (3 slots): *detect thoughts*, *enthrall*, *suggestion*\n3rd level (3 slots): *fear*, *stinking cloud*, *tongues*\n4th level (3 slots): *compulsion*, *dimension door*, *polymorph*\n5th level (3 slots): *dominate person*, *mislead*, *modify memory*\n6th level (2 slots): *irresistible dance*, *mass suggestion*\n7th level (1 slot): *magnificent mansion*\n8th level (1 slot): *glibness*\n9th level (1 slot): *true polymorph*'}  | ${'The commoner is a 19th-level spellcaster. Its spellcasting ability is Charisma (spell save DC 20, +12 to hit with spell attacks). The commoner has the following bard spells prepared:\n\nCantrips (at will): <em>dancing lights</em>, <em>mage hand</em>, <em>message</em>, <em>vicious mockery</em>\n1st level (4 slots): <em>charm person</em>, <em>disguise self</em>, <em>healing word</em>, <em>heroism</em>, <em>hideous laughter</em>\n2nd level (3 slots): <em>detect thoughts</em>, <em>enthrall</em>, <em>suggestion</em>\n3rd level (3 slots): <em>fear</em>, <em>stinking cloud</em>, <em>tongues</em>\n4th level (3 slots): <em>compulsion</em>, <em>dimension door</em>, <em>polymorph</em>\n5th level (3 slots): <em>dominate person</em>, <em>mislead</em>, <em>modify memory</em>\n6th level (2 slots): <em>irresistible dance</em>, <em>mass suggestion</em>\n7th level (1 slot): <em>magnificent mansion</em>\n8th level (1 slot): <em>glibness</em>\n9th level (1 slot): <em>true polymorph</em>'}
      ${'Level 20 Bard'} | ${20} | ${22}        | ${6}             | ${['Dancing Lights', 'Mage Hand', 'Message', 'Vicious Mockery']} | ${['Charm Person', 'Disguise Self', 'Healing Word', 'Heroism', 'Hideous Laughter']} | ${['Detect Thoughts', 'Enthrall', 'Suggestion']} | ${['Fear', 'Stinking Cloud', 'Tongues']} | ${['Compulsion', 'Dimension Door', 'Polymorph']} | ${['Dominate Person', 'Mislead', 'Modify Memory']} | ${['Irresistible Dance', 'Mass Suggestion']} | ${['Magnificent Mansion']} | ${['Glibness']} | ${['True Polymorph']} | ${'[name] is a 20th-level spellcaster. Its spellcasting ability is Charisma (spell save DC sdc[cha], atk[cha] to hit with spell attacks). [name] has the following bard spells prepared:\n\nCantrips (at will): *dancing lights*, *mage hand*, *message*, *vicious mockery*\n1st level (4 slots): *charm person*, *disguise self*, *healing word*, *heroism*, *hideous laughter*\n2nd level (3 slots): *detect thoughts*, *enthrall*, *suggestion*\n3rd level (3 slots): *fear*, *stinking cloud*, *tongues*\n4th level (3 slots): *compulsion*, *dimension door*, *polymorph*\n5th level (3 slots): *dominate person*, *mislead*, *modify memory*\n6th level (2 slots): *irresistible dance*, *mass suggestion*\n7th level (2 slots): *magnificent mansion*\n8th level (1 slot): *glibness*\n9th level (1 slot): *true polymorph*'} | ${'The commoner is a 20th-level spellcaster. Its spellcasting ability is Charisma (spell save DC 20, +12 to hit with spell attacks). The commoner has the following bard spells prepared:\n\nCantrips (at will): <em>dancing lights</em>, <em>mage hand</em>, <em>message</em>, <em>vicious mockery</em>\n1st level (4 slots): <em>charm person</em>, <em>disguise self</em>, <em>healing word</em>, <em>heroism</em>, <em>hideous laughter</em>\n2nd level (3 slots): <em>detect thoughts</em>, <em>enthrall</em>, <em>suggestion</em>\n3rd level (3 slots): <em>fear</em>, <em>stinking cloud</em>, <em>tongues</em>\n4th level (3 slots): <em>compulsion</em>, <em>dimension door</em>, <em>polymorph</em>\n5th level (3 slots): <em>dominate person</em>, <em>mislead</em>, <em>modify memory</em>\n6th level (2 slots): <em>irresistible dance</em>, <em>mass suggestion</em>\n7th level (2 slots): <em>magnificent mansion</em>\n8th level (1 slot): <em>glibness</em>\n9th level (1 slot): <em>true polymorph</em>'}
    `
    ('$description',
    ({level, abilityScore, proficiencyBonus, cantrips, level1Spells, level2Spells, level3Spells, level4Spells, level5Spells, level6Spells, level7Spells, level8Spells, level9Spells, expectedGeneratedText, expectedRenderedText}) => {
      const abilityName = 'charisma';

      abilitiesModel.abilities[abilityName].score = abilityScore;
      challengeRatingModel.proficiencyBonus = proficiencyBonus;

      const spellcastingModel = new Spellcasting();
      spellcastingModel.spellcasterType = 'bard';
      spellcastingModel.spellcasterAbility = abilityName;
      spellcastingModel.spellcasterLevel = level;

      spellcastingModel.spellCategories[0].spells = cantrips;
      for (let spellLevel = 1; spellLevel <= 9; spellLevel++) {
        spellcastingModel.spellCategories[spellLevel].spells = eval(`level${spellLevel}Spells`);
      }

      setDialogControls(spellcastingModel);

      verifyDialogModel(spellcastingModel, expectedGeneratedText);
      verifyDialogControls(spellcastingModel, expectedRenderedText);

      generateSpellcastingDialog.generateSpellcastingButton.click();

      verifySpecialTraitBlocks(spellcastingModel.spellcasterType, expectedGeneratedText, expectedRenderedText);
    });
    /* eslint-enable indent, no-unexpected-multiline, no-unused-vars */
  });

  describe('and the dialog is submitted for a cleric spellcaster, it should add a new spellcasting block under special traits', () => {
    /* eslint-disable indent, no-unexpected-multiline, no-unused-vars */
    it.each
    `
      description          | level | abilityScore | proficiencyBonus | cantrips                                                                   | level1Spells                                                        | level2Spells                                                                  | level3Spells                                                                      | level4Spells                                         | level5Spells                            | level6Spells                         | level7Spells                       | level8Spells     | level9Spells     | expectedGeneratedText                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     | expectedRenderedText
      ${'Level 1 Cleric'}  | ${1}  | ${12}        | ${2}             | ${['Sacred Flame', 'Spare the Dying', 'Thaumaturgy']}                      | ${['Guiding Bolt', 'Sanctuary']}                                    | ${[]}                                                                         | ${[]}                                                                             | ${[]}                                                | ${[]}                                   | ${[]}                                | ${[]}                              | ${[]}            | ${[]}            | ${'[name] is a 1st-level spellcaster. Its spellcasting ability is Wisdom (spell save DC sdc[wis], atk[wis] to hit with spell attacks). [name] has the following cleric spells prepared:\n\nCantrips (at will): *sacred flame*, *spare the dying*, *thaumaturgy*\n1st level (2 slots): *guiding bolt*, *sanctuary*'}                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       | ${'The commoner is a 1st-level spellcaster. Its spellcasting ability is Wisdom (spell save DC 11, +3 to hit with spell attacks). The commoner has the following cleric spells prepared:\n\nCantrips (at will): <em>sacred flame</em>, <em>spare the dying</em>, <em>thaumaturgy</em>\n1st level (2 slots): <em>guiding bolt</em>, <em>sanctuary</em>'}
      ${'Level 2 Cleric'}  | ${2}  | ${12}        | ${2}             | ${['Sacred Flame', 'Spare the Dying', 'Thaumaturgy']}                      | ${['Guiding Bolt', 'Inflict Wounds', 'Sanctuary']}                  | ${[]}                                                                         | ${[]}                                                                             | ${[]}                                                | ${[]}                                   | ${[]}                                | ${[]}                              | ${[]}            | ${[]}            | ${'[name] is a 2nd-level spellcaster. Its spellcasting ability is Wisdom (spell save DC sdc[wis], atk[wis] to hit with spell attacks). [name] has the following cleric spells prepared:\n\nCantrips (at will): *sacred flame*, *spare the dying*, *thaumaturgy*\n1st level (3 slots): *guiding bolt*, *inflict wounds*, *sanctuary*'}                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     | ${'The commoner is a 2nd-level spellcaster. Its spellcasting ability is Wisdom (spell save DC 11, +3 to hit with spell attacks). The commoner has the following cleric spells prepared:\n\nCantrips (at will): <em>sacred flame</em>, <em>spare the dying</em>, <em>thaumaturgy</em>\n1st level (3 slots): <em>guiding bolt</em>, <em>inflict wounds</em>, <em>sanctuary</em>'}
      ${'Level 3 Cleric'}  | ${3}  | ${12}        | ${2}             | ${['Sacred Flame', 'Spare the Dying', 'Thaumaturgy']}                      | ${['Guiding Bolt', 'Inflict Wounds', 'Sanctuary']}                  | ${['Prayer of Healing']}                                                      | ${[]}                                                                             | ${[]}                                                | ${[]}                                   | ${[]}                                | ${[]}                              | ${[]}            | ${[]}            | ${'[name] is a 3rd-level spellcaster. Its spellcasting ability is Wisdom (spell save DC sdc[wis], atk[wis] to hit with spell attacks). [name] has the following cleric spells prepared:\n\nCantrips (at will): *sacred flame*, *spare the dying*, *thaumaturgy*\n1st level (4 slots): *guiding bolt*, *inflict wounds*, *sanctuary*\n2nd level (2 slots): *prayer of healing*'}                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           | ${'The commoner is a 3rd-level spellcaster. Its spellcasting ability is Wisdom (spell save DC 11, +3 to hit with spell attacks). The commoner has the following cleric spells prepared:\n\nCantrips (at will): <em>sacred flame</em>, <em>spare the dying</em>, <em>thaumaturgy</em>\n1st level (4 slots): <em>guiding bolt</em>, <em>inflict wounds</em>, <em>sanctuary</em>\n2nd level (2 slots): <em>prayer of healing</em>'}
      ${'Level 4 Cleric'}  | ${4}  | ${14}        | ${2}             | ${['Guidance', 'Sacred Flame', 'Spare the Dying', 'Thaumaturgy']}          | ${['Bane', 'Guiding Bolt', 'Inflict Wounds', 'Sanctuary']}          | ${['Prayer of Healing', 'Warding Bond']}                                      | ${[]}                                                                             | ${[]}                                                | ${[]}                                   | ${[]}                                | ${[]}                              | ${[]}            | ${[]}            | ${'[name] is a 4th-level spellcaster. Its spellcasting ability is Wisdom (spell save DC sdc[wis], atk[wis] to hit with spell attacks). [name] has the following cleric spells prepared:\n\nCantrips (at will): *guidance*, *sacred flame*, *spare the dying*, *thaumaturgy*\n1st level (4 slots): *bane*, *guiding bolt*, *inflict wounds*, *sanctuary*\n2nd level (3 slots): *prayer of healing*, *warding bond*'}                                                                                                                                                                                                                                                                                                                                                                                                                                                                       | ${'The commoner is a 4th-level spellcaster. Its spellcasting ability is Wisdom (spell save DC 12, +4 to hit with spell attacks). The commoner has the following cleric spells prepared:\n\nCantrips (at will): <em>guidance</em>, <em>sacred flame</em>, <em>spare the dying</em>, <em>thaumaturgy</em>\n1st level (4 slots): <em>bane</em>, <em>guiding bolt</em>, <em>inflict wounds</em>, <em>sanctuary</em>\n2nd level (3 slots): <em>prayer of healing</em>, <em>warding bond</em>'}
      ${'Level 5 Cleric'}  | ${5}  | ${14}        | ${3}             | ${['Guidance', 'Sacred Flame', 'Spare the Dying', 'Thaumaturgy']}          | ${['Bane', 'Guiding Bolt', 'Inflict Wounds', 'Sanctuary']}          | ${['Prayer of Healing', 'Warding Bond']}                                      | ${['Spirit Guardians']}                                                           | ${[]}                                                | ${[]}                                   | ${[]}                                | ${[]}                              | ${[]}            | ${[]}            | ${'[name] is a 5th-level spellcaster. Its spellcasting ability is Wisdom (spell save DC sdc[wis], atk[wis] to hit with spell attacks). [name] has the following cleric spells prepared:\n\nCantrips (at will): *guidance*, *sacred flame*, *spare the dying*, *thaumaturgy*\n1st level (4 slots): *bane*, *guiding bolt*, *inflict wounds*, *sanctuary*\n2nd level (3 slots): *prayer of healing*, *warding bond*\n3rd level (2 slots): *spirit guardians*'}                                                                                                                                                                                                                                                                                                                                                                                                                              | ${'The commoner is a 5th-level spellcaster. Its spellcasting ability is Wisdom (spell save DC 13, +5 to hit with spell attacks). The commoner has the following cleric spells prepared:\n\nCantrips (at will): <em>guidance</em>, <em>sacred flame</em>, <em>spare the dying</em>, <em>thaumaturgy</em>\n1st level (4 slots): <em>bane</em>, <em>guiding bolt</em>, <em>inflict wounds</em>, <em>sanctuary</em>\n2nd level (3 slots): <em>prayer of healing</em>, <em>warding bond</em>\n3rd level (2 slots): <em>spirit guardians</em>'}
      ${'Level 6 Cleric'}  | ${6}  | ${14}        | ${3}             | ${['Guidance', 'Sacred Flame', 'Spare the Dying', 'Thaumaturgy']}          | ${['Bane', 'Guiding Bolt', 'Inflict Wounds', 'Sanctuary']}          | ${['Prayer of Healing', 'Warding Bond']}                                      | ${['Mass Healing Word', 'Spirit Guardians']}                                      | ${[]}                                                | ${[]}                                   | ${[]}                                | ${[]}                              | ${[]}            | ${[]}            | ${'[name] is a 6th-level spellcaster. Its spellcasting ability is Wisdom (spell save DC sdc[wis], atk[wis] to hit with spell attacks). [name] has the following cleric spells prepared:\n\nCantrips (at will): *guidance*, *sacred flame*, *spare the dying*, *thaumaturgy*\n1st level (4 slots): *bane*, *guiding bolt*, *inflict wounds*, *sanctuary*\n2nd level (3 slots): *prayer of healing*, *warding bond*\n3rd level (3 slots): *mass healing word*, *spirit guardians*'}                                                                                                                                                                                                                                                                                                                                                                                                         | ${'The commoner is a 6th-level spellcaster. Its spellcasting ability is Wisdom (spell save DC 13, +5 to hit with spell attacks). The commoner has the following cleric spells prepared:\n\nCantrips (at will): <em>guidance</em>, <em>sacred flame</em>, <em>spare the dying</em>, <em>thaumaturgy</em>\n1st level (4 slots): <em>bane</em>, <em>guiding bolt</em>, <em>inflict wounds</em>, <em>sanctuary</em>\n2nd level (3 slots): <em>prayer of healing</em>, <em>warding bond</em>\n3rd level (3 slots): <em>mass healing word</em>, <em>spirit guardians</em>'}
      ${'Level 7 Cleric'}  | ${7}  | ${14}        | ${3}             | ${['Guidance', 'Sacred Flame', 'Spare the Dying', 'Thaumaturgy']}          | ${['Bane', 'Guiding Bolt', 'Inflict Wounds', 'Sanctuary']}          | ${['Prayer of Healing', 'Warding Bond']}                                      | ${['Mass Healing Word', 'Spirit Guardians']}                                      | ${['Divination']}                                    | ${[]}                                   | ${[]}                                | ${[]}                              | ${[]}            | ${[]}            | ${'[name] is a 7th-level spellcaster. Its spellcasting ability is Wisdom (spell save DC sdc[wis], atk[wis] to hit with spell attacks). [name] has the following cleric spells prepared:\n\nCantrips (at will): *guidance*, *sacred flame*, *spare the dying*, *thaumaturgy*\n1st level (4 slots): *bane*, *guiding bolt*, *inflict wounds*, *sanctuary*\n2nd level (3 slots): *prayer of healing*, *warding bond*\n3rd level (3 slots): *mass healing word*, *spirit guardians*\n4th level (1 slot): *divination*'}                                                                                                                                                                                                                                                                                                                                                                       | ${'The commoner is a 7th-level spellcaster. Its spellcasting ability is Wisdom (spell save DC 13, +5 to hit with spell attacks). The commoner has the following cleric spells prepared:\n\nCantrips (at will): <em>guidance</em>, <em>sacred flame</em>, <em>spare the dying</em>, <em>thaumaturgy</em>\n1st level (4 slots): <em>bane</em>, <em>guiding bolt</em>, <em>inflict wounds</em>, <em>sanctuary</em>\n2nd level (3 slots): <em>prayer of healing</em>, <em>warding bond</em>\n3rd level (3 slots): <em>mass healing word</em>, <em>spirit guardians</em>\n4th level (1 slot): <em>divination</em>'}
      ${'Level 8 Cleric'}  | ${8}  | ${16}        | ${3}             | ${['Guidance', 'Sacred Flame', 'Spare the Dying', 'Thaumaturgy']}          | ${['Bane', 'Guiding Bolt', 'Inflict Wounds', 'Sanctuary']}          | ${['Prayer of Healing', 'Spiritual Weapon', 'Warding Bond']}                  | ${['Mass Healing Word', 'Spirit Guardians']}                                      | ${['Banishment', 'Divination']}                      | ${[]}                                   | ${[]}                                | ${[]}                              | ${[]}            | ${[]}            | ${'[name] is a 8th-level spellcaster. Its spellcasting ability is Wisdom (spell save DC sdc[wis], atk[wis] to hit with spell attacks). [name] has the following cleric spells prepared:\n\nCantrips (at will): *guidance*, *sacred flame*, *spare the dying*, *thaumaturgy*\n1st level (4 slots): *bane*, *guiding bolt*, *inflict wounds*, *sanctuary*\n2nd level (3 slots): *prayer of healing*, *spiritual weapon*, *warding bond*\n3rd level (3 slots): *mass healing word*, *spirit guardians*\n4th level (2 slots): *banishment*, *divination*'}                                                                                                                                                                                                                                                                                                                                    | ${'The commoner is a 8th-level spellcaster. Its spellcasting ability is Wisdom (spell save DC 14, +6 to hit with spell attacks). The commoner has the following cleric spells prepared:\n\nCantrips (at will): <em>guidance</em>, <em>sacred flame</em>, <em>spare the dying</em>, <em>thaumaturgy</em>\n1st level (4 slots): <em>bane</em>, <em>guiding bolt</em>, <em>inflict wounds</em>, <em>sanctuary</em>\n2nd level (3 slots): <em>prayer of healing</em>, <em>spiritual weapon</em>, <em>warding bond</em>\n3rd level (3 slots): <em>mass healing word</em>, <em>spirit guardians</em>\n4th level (2 slots): <em>banishment</em>, <em>divination</em>'}
      ${'Level 9 Cleric'}  | ${9}  | ${16}        | ${4}             | ${['Guidance', 'Sacred Flame', 'Spare the Dying', 'Thaumaturgy']}          | ${['Bane', 'Guiding Bolt', 'Inflict Wounds', 'Sanctuary']}          | ${['Prayer of Healing', 'Spiritual Weapon', 'Warding Bond']}                  | ${['Mass Healing Word', 'Spirit Guardians']}                                      | ${['Banishment', 'Divination']}                      | ${['Commune']}                          | ${[]}                                | ${[]}                              | ${[]}            | ${[]}            | ${'[name] is a 9th-level spellcaster. Its spellcasting ability is Wisdom (spell save DC sdc[wis], atk[wis] to hit with spell attacks). [name] has the following cleric spells prepared:\n\nCantrips (at will): *guidance*, *sacred flame*, *spare the dying*, *thaumaturgy*\n1st level (4 slots): *bane*, *guiding bolt*, *inflict wounds*, *sanctuary*\n2nd level (3 slots): *prayer of healing*, *spiritual weapon*, *warding bond*\n3rd level (3 slots): *mass healing word*, *spirit guardians*\n4th level (3 slots): *banishment*, *divination*\n5th level (1 slot): *commune*'}                                                                                                                                                                                                                                                                                                     | ${'The commoner is a 9th-level spellcaster. Its spellcasting ability is Wisdom (spell save DC 15, +7 to hit with spell attacks). The commoner has the following cleric spells prepared:\n\nCantrips (at will): <em>guidance</em>, <em>sacred flame</em>, <em>spare the dying</em>, <em>thaumaturgy</em>\n1st level (4 slots): <em>bane</em>, <em>guiding bolt</em>, <em>inflict wounds</em>, <em>sanctuary</em>\n2nd level (3 slots): <em>prayer of healing</em>, <em>spiritual weapon</em>, <em>warding bond</em>\n3rd level (3 slots): <em>mass healing word</em>, <em>spirit guardians</em>\n4th level (3 slots): <em>banishment</em>, <em>divination</em>\n5th level (1 slot): <em>commune</em>'}
      ${'Level 10 Cleric'} | ${10} | ${16}        | ${4}             | ${['Guidance', 'Sacred Flame', 'Spare the Dying', 'Thaumaturgy']}          | ${['Bane', 'Guiding Bolt', 'Inflict Wounds', 'Sanctuary']}          | ${['Prayer of Healing', 'Spiritual Weapon', 'Warding Bond']}                  | ${['Mass Healing Word', 'Spirit Guardians']}                                      | ${['Banishment', 'Divination']}                      | ${['Commune', 'Hallow']}                | ${[]}                                | ${[]}                              | ${[]}            | ${[]}            | ${'[name] is a 10th-level spellcaster. Its spellcasting ability is Wisdom (spell save DC sdc[wis], atk[wis] to hit with spell attacks). [name] has the following cleric spells prepared:\n\nCantrips (at will): *guidance*, *sacred flame*, *spare the dying*, *thaumaturgy*\n1st level (4 slots): *bane*, *guiding bolt*, *inflict wounds*, *sanctuary*\n2nd level (3 slots): *prayer of healing*, *spiritual weapon*, *warding bond*\n3rd level (3 slots): *mass healing word*, *spirit guardians*\n4th level (3 slots): *banishment*, *divination*\n5th level (2 slots): *commune*, *hallow*'}                                                                                                                                                                                                                                                                                         | ${'The commoner is a 10th-level spellcaster. Its spellcasting ability is Wisdom (spell save DC 15, +7 to hit with spell attacks). The commoner has the following cleric spells prepared:\n\nCantrips (at will): <em>guidance</em>, <em>sacred flame</em>, <em>spare the dying</em>, <em>thaumaturgy</em>\n1st level (4 slots): <em>bane</em>, <em>guiding bolt</em>, <em>inflict wounds</em>, <em>sanctuary</em>\n2nd level (3 slots): <em>prayer of healing</em>, <em>spiritual weapon</em>, <em>warding bond</em>\n3rd level (3 slots): <em>mass healing word</em>, <em>spirit guardians</em>\n4th level (3 slots): <em>banishment</em>, <em>divination</em>\n5th level (2 slots): <em>commune</em>, <em>hallow</em>'}
      ${'Level 11 Cleric'} | ${11} | ${16}        | ${4}             | ${['Guidance', 'Light', 'Sacred Flame', 'Spare the Dying', 'Thaumaturgy']} | ${['Bane', 'Guiding Bolt', 'Inflict Wounds', 'Sanctuary']}          | ${['Prayer of Healing', 'Spiritual Weapon', 'Warding Bond']}                  | ${['Mass Healing Word', 'Spirit Guardians']}                                      | ${['Banishment', 'Divination']}                      | ${['Commune', 'Hallow']}                | ${['Planar Ally']}                   | ${[]}                              | ${[]}            | ${[]}            | ${'[name] is a 11th-level spellcaster. Its spellcasting ability is Wisdom (spell save DC sdc[wis], atk[wis] to hit with spell attacks). [name] has the following cleric spells prepared:\n\nCantrips (at will): *guidance*, *light*, *sacred flame*, *spare the dying*, *thaumaturgy*\n1st level (4 slots): *bane*, *guiding bolt*, *inflict wounds*, *sanctuary*\n2nd level (3 slots): *prayer of healing*, *spiritual weapon*, *warding bond*\n3rd level (3 slots): *mass healing word*, *spirit guardians*\n4th level (3 slots): *banishment*, *divination*\n5th level (2 slots): *commune*, *hallow*\n6th level (1 slot): *planar ally*'}                                                                                                                                                                                                                                             | ${'The commoner is a 11th-level spellcaster. Its spellcasting ability is Wisdom (spell save DC 15, +7 to hit with spell attacks). The commoner has the following cleric spells prepared:\n\nCantrips (at will): <em>guidance</em>, <em>light</em>, <em>sacred flame</em>, <em>spare the dying</em>, <em>thaumaturgy</em>\n1st level (4 slots): <em>bane</em>, <em>guiding bolt</em>, <em>inflict wounds</em>, <em>sanctuary</em>\n2nd level (3 slots): <em>prayer of healing</em>, <em>spiritual weapon</em>, <em>warding bond</em>\n3rd level (3 slots): <em>mass healing word</em>, <em>spirit guardians</em>\n4th level (3 slots): <em>banishment</em>, <em>divination</em>\n5th level (2 slots): <em>commune</em>, <em>hallow</em>\n6th level (1 slot): <em>planar ally</em>'}
      ${'Level 12 Cleric'} | ${12} | ${18}        | ${4}             | ${['Guidance', 'Light', 'Sacred Flame', 'Spare the Dying', 'Thaumaturgy']} | ${['Bane', 'Guiding Bolt', 'Inflict Wounds', 'Sanctuary']}          | ${['Prayer of Healing', 'Spiritual Weapon', 'Warding Bond']}                  | ${['Beacon of Hope', 'Mass Healing Word', 'Spirit Guardians']}                    | ${['Banishment', 'Divination', 'Guardian of Faith']} | ${['Commune', 'Hallow']}                | ${['Planar Ally']}                   | ${[]}                              | ${[]}            | ${[]}            | ${'[name] is a 12th-level spellcaster. Its spellcasting ability is Wisdom (spell save DC sdc[wis], atk[wis] to hit with spell attacks). [name] has the following cleric spells prepared:\n\nCantrips (at will): *guidance*, *light*, *sacred flame*, *spare the dying*, *thaumaturgy*\n1st level (4 slots): *bane*, *guiding bolt*, *inflict wounds*, *sanctuary*\n2nd level (3 slots): *prayer of healing*, *spiritual weapon*, *warding bond*\n3rd level (3 slots): *beacon of hope*, *mass healing word*, *spirit guardians*\n4th level (3 slots): *banishment*, *divination*, *guardian of faith*\n5th level (2 slots): *commune*, *hallow*\n6th level (1 slot): *planar ally*'}                                                                                                                                                                                                      | ${'The commoner is a 12th-level spellcaster. Its spellcasting ability is Wisdom (spell save DC 16, +8 to hit with spell attacks). The commoner has the following cleric spells prepared:\n\nCantrips (at will): <em>guidance</em>, <em>light</em>, <em>sacred flame</em>, <em>spare the dying</em>, <em>thaumaturgy</em>\n1st level (4 slots): <em>bane</em>, <em>guiding bolt</em>, <em>inflict wounds</em>, <em>sanctuary</em>\n2nd level (3 slots): <em>prayer of healing</em>, <em>spiritual weapon</em>, <em>warding bond</em>\n3rd level (3 slots): <em>beacon of hope</em>, <em>mass healing word</em>, <em>spirit guardians</em>\n4th level (3 slots): <em>banishment</em>, <em>divination</em>, <em>guardian of faith</em>\n5th level (2 slots): <em>commune</em>, <em>hallow</em>\n6th level (1 slot): <em>planar ally</em>'}
      ${'Level 13 Cleric'} | ${13} | ${18}        | ${5}             | ${['Guidance', 'Light', 'Sacred Flame', 'Spare the Dying', 'Thaumaturgy']} | ${['Bane', 'Guiding Bolt', 'Inflict Wounds', 'Sanctuary']}          | ${['Prayer of Healing', 'Spiritual Weapon', 'Warding Bond']}                  | ${['Beacon of Hope', 'Mass Healing Word', 'Spirit Guardians']}                    | ${['Banishment', 'Divination', 'Guardian of Faith']} | ${['Commune', 'Hallow']}                | ${['Planar Ally']}                   | ${['Resurrection']}                | ${[]}            | ${[]}            | ${'[name] is a 13th-level spellcaster. Its spellcasting ability is Wisdom (spell save DC sdc[wis], atk[wis] to hit with spell attacks). [name] has the following cleric spells prepared:\n\nCantrips (at will): *guidance*, *light*, *sacred flame*, *spare the dying*, *thaumaturgy*\n1st level (4 slots): *bane*, *guiding bolt*, *inflict wounds*, *sanctuary*\n2nd level (3 slots): *prayer of healing*, *spiritual weapon*, *warding bond*\n3rd level (3 slots): *beacon of hope*, *mass healing word*, *spirit guardians*\n4th level (3 slots): *banishment*, *divination*, *guardian of faith*\n5th level (2 slots): *commune*, *hallow*\n6th level (1 slot): *planar ally*\n7th level (1 slot): *resurrection*'}                                                                                                                                                                  | ${'The commoner is a 13th-level spellcaster. Its spellcasting ability is Wisdom (spell save DC 17, +9 to hit with spell attacks). The commoner has the following cleric spells prepared:\n\nCantrips (at will): <em>guidance</em>, <em>light</em>, <em>sacred flame</em>, <em>spare the dying</em>, <em>thaumaturgy</em>\n1st level (4 slots): <em>bane</em>, <em>guiding bolt</em>, <em>inflict wounds</em>, <em>sanctuary</em>\n2nd level (3 slots): <em>prayer of healing</em>, <em>spiritual weapon</em>, <em>warding bond</em>\n3rd level (3 slots): <em>beacon of hope</em>, <em>mass healing word</em>, <em>spirit guardians</em>\n4th level (3 slots): <em>banishment</em>, <em>divination</em>, <em>guardian of faith</em>\n5th level (2 slots): <em>commune</em>, <em>hallow</em>\n6th level (1 slot): <em>planar ally</em>\n7th level (1 slot): <em>resurrection</em>'}
      ${'Level 14 Cleric'} | ${14} | ${18}        | ${5}             | ${['Guidance', 'Light', 'Sacred Flame', 'Spare the Dying', 'Thaumaturgy']} | ${['Bane', 'Guiding Bolt', 'Inflict Wounds', 'Sanctuary']}          | ${['Prayer of Healing', 'Spiritual Weapon', 'Warding Bond']}                  | ${['Beacon of Hope', 'Mass Healing Word', 'Spirit Guardians']}                    | ${['Banishment', 'Divination', 'Guardian of Faith']} | ${['Commune', 'Hallow', 'Legend Lore']} | ${['Planar Ally']}                   | ${['Resurrection']}                | ${[]}            | ${[]}            | ${'[name] is a 14th-level spellcaster. Its spellcasting ability is Wisdom (spell save DC sdc[wis], atk[wis] to hit with spell attacks). [name] has the following cleric spells prepared:\n\nCantrips (at will): *guidance*, *light*, *sacred flame*, *spare the dying*, *thaumaturgy*\n1st level (4 slots): *bane*, *guiding bolt*, *inflict wounds*, *sanctuary*\n2nd level (3 slots): *prayer of healing*, *spiritual weapon*, *warding bond*\n3rd level (3 slots): *beacon of hope*, *mass healing word*, *spirit guardians*\n4th level (3 slots): *banishment*, *divination*, *guardian of faith*\n5th level (2 slots): *commune*, *hallow*, *legend lore*\n6th level (1 slot): *planar ally*\n7th level (1 slot): *resurrection*'}                                                                                                                                                   | ${'The commoner is a 14th-level spellcaster. Its spellcasting ability is Wisdom (spell save DC 17, +9 to hit with spell attacks). The commoner has the following cleric spells prepared:\n\nCantrips (at will): <em>guidance</em>, <em>light</em>, <em>sacred flame</em>, <em>spare the dying</em>, <em>thaumaturgy</em>\n1st level (4 slots): <em>bane</em>, <em>guiding bolt</em>, <em>inflict wounds</em>, <em>sanctuary</em>\n2nd level (3 slots): <em>prayer of healing</em>, <em>spiritual weapon</em>, <em>warding bond</em>\n3rd level (3 slots): <em>beacon of hope</em>, <em>mass healing word</em>, <em>spirit guardians</em>\n4th level (3 slots): <em>banishment</em>, <em>divination</em>, <em>guardian of faith</em>\n5th level (2 slots): <em>commune</em>, <em>hallow</em>, <em>legend lore</em>\n6th level (1 slot): <em>planar ally</em>\n7th level (1 slot): <em>resurrection</em>'}
      ${'Level 15 Cleric'} | ${15} | ${18}        | ${5}             | ${['Guidance', 'Light', 'Sacred Flame', 'Spare the Dying', 'Thaumaturgy']} | ${['Bane', 'Guiding Bolt', 'Inflict Wounds', 'Sanctuary']}          | ${['Prayer of Healing', 'Spiritual Weapon', 'Warding Bond']}                  | ${['Beacon of Hope', 'Mass Healing Word', 'Spirit Guardians']}                    | ${['Banishment', 'Divination', 'Guardian of Faith']} | ${['Commune', 'Hallow', 'Legend Lore']} | ${['Planar Ally']}                   | ${['Resurrection']}                | ${['Holy Aura']} | ${[]}            | ${'[name] is a 15th-level spellcaster. Its spellcasting ability is Wisdom (spell save DC sdc[wis], atk[wis] to hit with spell attacks). [name] has the following cleric spells prepared:\n\nCantrips (at will): *guidance*, *light*, *sacred flame*, *spare the dying*, *thaumaturgy*\n1st level (4 slots): *bane*, *guiding bolt*, *inflict wounds*, *sanctuary*\n2nd level (3 slots): *prayer of healing*, *spiritual weapon*, *warding bond*\n3rd level (3 slots): *beacon of hope*, *mass healing word*, *spirit guardians*\n4th level (3 slots): *banishment*, *divination*, *guardian of faith*\n5th level (2 slots): *commune*, *hallow*, *legend lore*\n6th level (1 slot): *planar ally*\n7th level (1 slot): *resurrection*\n8th level (1 slot): *holy aura*'}                                                                                                                  | ${'The commoner is a 15th-level spellcaster. Its spellcasting ability is Wisdom (spell save DC 17, +9 to hit with spell attacks). The commoner has the following cleric spells prepared:\n\nCantrips (at will): <em>guidance</em>, <em>light</em>, <em>sacred flame</em>, <em>spare the dying</em>, <em>thaumaturgy</em>\n1st level (4 slots): <em>bane</em>, <em>guiding bolt</em>, <em>inflict wounds</em>, <em>sanctuary</em>\n2nd level (3 slots): <em>prayer of healing</em>, <em>spiritual weapon</em>, <em>warding bond</em>\n3rd level (3 slots): <em>beacon of hope</em>, <em>mass healing word</em>, <em>spirit guardians</em>\n4th level (3 slots): <em>banishment</em>, <em>divination</em>, <em>guardian of faith</em>\n5th level (2 slots): <em>commune</em>, <em>hallow</em>, <em>legend lore</em>\n6th level (1 slot): <em>planar ally</em>\n7th level (1 slot): <em>resurrection</em>\n8th level (1 slot): <em>holy aura</em>'}
      ${'Level 16 Cleric'} | ${16} | ${20}        | ${5}             | ${['Guidance', 'Light', 'Sacred Flame', 'Spare the Dying', 'Thaumaturgy']} | ${['Bane', 'Guiding Bolt', 'Inflict Wounds', 'Sanctuary']}          | ${['Prayer of Healing', 'Spiritual Weapon', 'Warding Bond']}                  | ${['Beacon of Hope', 'Mass Healing Word', 'Spirit Guardians']}                    | ${['Banishment', 'Divination', 'Guardian of Faith']} | ${['Commune', 'Hallow', 'Legend Lore']} | ${['Planar Ally', 'Word of Recall']} | ${['Divine Word', 'Resurrection']} | ${['Holy Aura']} | ${[]}            | ${'[name] is a 16th-level spellcaster. Its spellcasting ability is Wisdom (spell save DC sdc[wis], atk[wis] to hit with spell attacks). [name] has the following cleric spells prepared:\n\nCantrips (at will): *guidance*, *light*, *sacred flame*, *spare the dying*, *thaumaturgy*\n1st level (4 slots): *bane*, *guiding bolt*, *inflict wounds*, *sanctuary*\n2nd level (3 slots): *prayer of healing*, *spiritual weapon*, *warding bond*\n3rd level (3 slots): *beacon of hope*, *mass healing word*, *spirit guardians*\n4th level (3 slots): *banishment*, *divination*, *guardian of faith*\n5th level (2 slots): *commune*, *hallow*, *legend lore*\n6th level (1 slot): *planar ally*, *word of recall*\n7th level (1 slot): *divine word*, *resurrection*\n8th level (1 slot): *holy aura*'}                                                                                 | ${'The commoner is a 16th-level spellcaster. Its spellcasting ability is Wisdom (spell save DC 18, +10 to hit with spell attacks). The commoner has the following cleric spells prepared:\n\nCantrips (at will): <em>guidance</em>, <em>light</em>, <em>sacred flame</em>, <em>spare the dying</em>, <em>thaumaturgy</em>\n1st level (4 slots): <em>bane</em>, <em>guiding bolt</em>, <em>inflict wounds</em>, <em>sanctuary</em>\n2nd level (3 slots): <em>prayer of healing</em>, <em>spiritual weapon</em>, <em>warding bond</em>\n3rd level (3 slots): <em>beacon of hope</em>, <em>mass healing word</em>, <em>spirit guardians</em>\n4th level (3 slots): <em>banishment</em>, <em>divination</em>, <em>guardian of faith</em>\n5th level (2 slots): <em>commune</em>, <em>hallow</em>, <em>legend lore</em>\n6th level (1 slot): <em>planar ally</em>, <em>word of recall</em>\n7th level (1 slot): <em>divine word</em>, <em>resurrection</em>\n8th level (1 slot): <em>holy aura</em>'}
      ${'Level 17 Cleric'} | ${17} | ${20}        | ${6}             | ${['Guidance', 'Light', 'Sacred Flame', 'Spare the Dying', 'Thaumaturgy']} | ${['Bane', 'Guiding Bolt', 'Inflict Wounds', 'Sanctuary']}          | ${['Prayer of Healing', 'Spiritual Weapon', 'Warding Bond']}                  | ${['Beacon of Hope', 'Mass Healing Word', 'Spirit Guardians']}                    | ${['Banishment', 'Divination', 'Guardian of Faith']} | ${['Commune', 'Hallow', 'Legend Lore']} | ${['Planar Ally', 'Word of Recall']} | ${['Divine Word', 'Resurrection']} | ${['Holy Aura']} | ${['Mass Heal']} | ${'[name] is a 17th-level spellcaster. Its spellcasting ability is Wisdom (spell save DC sdc[wis], atk[wis] to hit with spell attacks). [name] has the following cleric spells prepared:\n\nCantrips (at will): *guidance*, *light*, *sacred flame*, *spare the dying*, *thaumaturgy*\n1st level (4 slots): *bane*, *guiding bolt*, *inflict wounds*, *sanctuary*\n2nd level (3 slots): *prayer of healing*, *spiritual weapon*, *warding bond*\n3rd level (3 slots): *beacon of hope*, *mass healing word*, *spirit guardians*\n4th level (3 slots): *banishment*, *divination*, *guardian of faith*\n5th level (2 slots): *commune*, *hallow*, *legend lore*\n6th level (1 slot): *planar ally*, *word of recall*\n7th level (1 slot): *divine word*, *resurrection*\n8th level (1 slot): *holy aura*\n9th level (1 slot): *mass heal*'}                                                | ${'The commoner is a 17th-level spellcaster. Its spellcasting ability is Wisdom (spell save DC 19, +11 to hit with spell attacks). The commoner has the following cleric spells prepared:\n\nCantrips (at will): <em>guidance</em>, <em>light</em>, <em>sacred flame</em>, <em>spare the dying</em>, <em>thaumaturgy</em>\n1st level (4 slots): <em>bane</em>, <em>guiding bolt</em>, <em>inflict wounds</em>, <em>sanctuary</em>\n2nd level (3 slots): <em>prayer of healing</em>, <em>spiritual weapon</em>, <em>warding bond</em>\n3rd level (3 slots): <em>beacon of hope</em>, <em>mass healing word</em>, <em>spirit guardians</em>\n4th level (3 slots): <em>banishment</em>, <em>divination</em>, <em>guardian of faith</em>\n5th level (2 slots): <em>commune</em>, <em>hallow</em>, <em>legend lore</em>\n6th level (1 slot): <em>planar ally</em>, <em>word of recall</em>\n7th level (1 slot): <em>divine word</em>, <em>resurrection</em>\n8th level (1 slot): <em>holy aura</em>\n9th level (1 slot): <em>mass heal</em>'}
      ${'Level 18 Cleric'} | ${18} | ${20}        | ${6}             | ${['Guidance', 'Light', 'Sacred Flame', 'Spare the Dying', 'Thaumaturgy']} | ${['Bane', 'Bless', 'Guiding Bolt', 'Inflict Wounds', 'Sanctuary']} | ${['Prayer of Healing', 'Spiritual Weapon', 'Warding Bond']}                  | ${['Beacon of Hope', 'Mass Healing Word', 'Spirit Guardians']}                    | ${['Banishment', 'Divination', 'Guardian of Faith']} | ${['Commune', 'Hallow', 'Legend Lore']} | ${['Planar Ally', 'Word of Recall']} | ${['Divine Word', 'Resurrection']} | ${['Holy Aura']} | ${['Mass Heal']} | ${'[name] is a 18th-level spellcaster. Its spellcasting ability is Wisdom (spell save DC sdc[wis], atk[wis] to hit with spell attacks). [name] has the following cleric spells prepared:\n\nCantrips (at will): *guidance*, *light*, *sacred flame*, *spare the dying*, *thaumaturgy*\n1st level (4 slots): *bane*, *bless*, *guiding bolt*, *inflict wounds*, *sanctuary*\n2nd level (3 slots): *prayer of healing*, *spiritual weapon*, *warding bond*\n3rd level (3 slots): *beacon of hope*, *mass healing word*, *spirit guardians*\n4th level (3 slots): *banishment*, *divination*, *guardian of faith*\n5th level (3 slots): *commune*, *hallow*, *legend lore*\n6th level (1 slot): *planar ally*, *word of recall*\n7th level (1 slot): *divine word*, *resurrection*\n8th level (1 slot): *holy aura*\n9th level (1 slot): *mass heal*'}                                       | ${'The commoner is a 18th-level spellcaster. Its spellcasting ability is Wisdom (spell save DC 19, +11 to hit with spell attacks). The commoner has the following cleric spells prepared:\n\nCantrips (at will): <em>guidance</em>, <em>light</em>, <em>sacred flame</em>, <em>spare the dying</em>, <em>thaumaturgy</em>\n1st level (4 slots): <em>bane</em>, <em>bless</em>, <em>guiding bolt</em>, <em>inflict wounds</em>, <em>sanctuary</em>\n2nd level (3 slots): <em>prayer of healing</em>, <em>spiritual weapon</em>, <em>warding bond</em>\n3rd level (3 slots): <em>beacon of hope</em>, <em>mass healing word</em>, <em>spirit guardians</em>\n4th level (3 slots): <em>banishment</em>, <em>divination</em>, <em>guardian of faith</em>\n5th level (3 slots): <em>commune</em>, <em>hallow</em>, <em>legend lore</em>\n6th level (1 slot): <em>planar ally</em>, <em>word of recall</em>\n7th level (1 slot): <em>divine word</em>, <em>resurrection</em>\n8th level (1 slot): <em>holy aura</em>\n9th level (1 slot): <em>mass heal</em>'}
      ${'Level 19 Cleric'} | ${19} | ${22}        | ${6}             | ${['Guidance', 'Light', 'Sacred Flame', 'Spare the Dying', 'Thaumaturgy']} | ${['Bane', 'Bless', 'Guiding Bolt', 'Inflict Wounds', 'Sanctuary']} | ${['Calm Emotions', 'Prayer of Healing', 'Spiritual Weapon', 'Warding Bond']} | ${['Beacon of Hope', 'Mass Healing Word', 'Spirit Guardians']}                    | ${['Banishment', 'Divination', 'Guardian of Faith']} | ${['Commune', 'Hallow', 'Legend Lore']} | ${['Planar Ally', 'Word of Recall']} | ${['Divine Word', 'Resurrection']} | ${['Holy Aura']} | ${['Mass Heal']} | ${'[name] is a 19th-level spellcaster. Its spellcasting ability is Wisdom (spell save DC sdc[wis], atk[wis] to hit with spell attacks). [name] has the following cleric spells prepared:\n\nCantrips (at will): *guidance*, *light*, *sacred flame*, *spare the dying*, *thaumaturgy*\n1st level (4 slots): *bane*, *bless*, *guiding bolt*, *inflict wounds*, *sanctuary*\n2nd level (3 slots): *calm emotions*, *prayer of healing*, *spiritual weapon*, *warding bond*\n3rd level (3 slots): *beacon of hope*, *mass healing word*, *spirit guardians*\n4th level (3 slots): *banishment*, *divination*, *guardian of faith*\n5th level (3 slots): *commune*, *hallow*, *legend lore*\n6th level (2 slots): *planar ally*, *word of recall*\n7th level (1 slot): *divine word*, *resurrection*\n8th level (1 slot): *holy aura*\n9th level (1 slot): *mass heal*'}                     | ${'The commoner is a 19th-level spellcaster. Its spellcasting ability is Wisdom (spell save DC 20, +12 to hit with spell attacks). The commoner has the following cleric spells prepared:\n\nCantrips (at will): <em>guidance</em>, <em>light</em>, <em>sacred flame</em>, <em>spare the dying</em>, <em>thaumaturgy</em>\n1st level (4 slots): <em>bane</em>, <em>bless</em>, <em>guiding bolt</em>, <em>inflict wounds</em>, <em>sanctuary</em>\n2nd level (3 slots): <em>calm emotions</em>, <em>prayer of healing</em>, <em>spiritual weapon</em>, <em>warding bond</em>\n3rd level (3 slots): <em>beacon of hope</em>, <em>mass healing word</em>, <em>spirit guardians</em>\n4th level (3 slots): <em>banishment</em>, <em>divination</em>, <em>guardian of faith</em>\n5th level (3 slots): <em>commune</em>, <em>hallow</em>, <em>legend lore</em>\n6th level (2 slots): <em>planar ally</em>, <em>word of recall</em>\n7th level (1 slot): <em>divine word</em>, <em>resurrection</em>\n8th level (1 slot): <em>holy aura</em>\n9th level (1 slot): <em>mass heal</em>'}
      ${'Level 20 Cleric'} | ${20} | ${22}        | ${6}             | ${['Guidance', 'Light', 'Sacred Flame', 'Spare the Dying', 'Thaumaturgy']} | ${['Bane', 'Bless', 'Guiding Bolt', 'Inflict Wounds', 'Sanctuary']} | ${['Calm Emotions', 'Prayer of Healing', 'Spiritual Weapon', 'Warding Bond']} | ${['Beacon of Hope', 'Mass Healing Word', 'Speak with Dead', 'Spirit Guardians']} | ${['Banishment', 'Divination', 'Guardian of Faith']} | ${['Commune', 'Hallow', 'Legend Lore']} | ${['Planar Ally', 'Word of Recall']} | ${['Divine Word', 'Resurrection']} | ${['Holy Aura']} | ${['Mass Heal']} | ${'[name] is a 20th-level spellcaster. Its spellcasting ability is Wisdom (spell save DC sdc[wis], atk[wis] to hit with spell attacks). [name] has the following cleric spells prepared:\n\nCantrips (at will): *guidance*, *light*, *sacred flame*, *spare the dying*, *thaumaturgy*\n1st level (4 slots): *bane*, *bless*, *guiding bolt*, *inflict wounds*, *sanctuary*\n2nd level (3 slots): *calm emotions*, *prayer of healing*, *spiritual weapon*, *warding bond*\n3rd level (3 slots): *beacon of hope*, *mass healing word*, *speak with dead*, *spirit guardians*\n4th level (3 slots): *banishment*, *divination*, *guardian of faith*\n5th level (3 slots): *commune*, *hallow*, *legend lore*\n6th level (2 slots): *planar ally*, *word of recall*\n7th level (2 slots): *divine word*, *resurrection*\n8th level (1 slot): *holy aura*\n9th level (1 slot): *mass heal*'} | ${'The commoner is a 20th-level spellcaster. Its spellcasting ability is Wisdom (spell save DC 20, +12 to hit with spell attacks). The commoner has the following cleric spells prepared:\n\nCantrips (at will): <em>guidance</em>, <em>light</em>, <em>sacred flame</em>, <em>spare the dying</em>, <em>thaumaturgy</em>\n1st level (4 slots): <em>bane</em>, <em>bless</em>, <em>guiding bolt</em>, <em>inflict wounds</em>, <em>sanctuary</em>\n2nd level (3 slots): <em>calm emotions</em>, <em>prayer of healing</em>, <em>spiritual weapon</em>, <em>warding bond</em>\n3rd level (3 slots): <em>beacon of hope</em>, <em>mass healing word</em>, <em>speak with dead</em>, <em>spirit guardians</em>\n4th level (3 slots): <em>banishment</em>, <em>divination</em>, <em>guardian of faith</em>\n5th level (3 slots): <em>commune</em>, <em>hallow</em>, <em>legend lore</em>\n6th level (2 slots): <em>planar ally</em>, <em>word of recall</em>\n7th level (2 slots): <em>divine word</em>, <em>resurrection</em>\n8th level (1 slot): <em>holy aura</em>\n9th level (1 slot): <em>mass heal</em>'}
    `
    ('$description',
    ({level, abilityScore, proficiencyBonus, cantrips, level1Spells, level2Spells, level3Spells, level4Spells, level5Spells, level6Spells, level7Spells, level8Spells, level9Spells, expectedGeneratedText, expectedRenderedText}) => {
      const abilityName = 'wisdom';

      abilitiesModel.abilities[abilityName].score = abilityScore;
      challengeRatingModel.proficiencyBonus = proficiencyBonus;

      const spellcastingModel = new Spellcasting();
      spellcastingModel.spellcasterType = 'cleric';
      spellcastingModel.spellcasterAbility = abilityName;
      spellcastingModel.spellcasterLevel = level;

      spellcastingModel.spellCategories[0].spells = cantrips;
      for (let spellLevel = 1; spellLevel <= 9; spellLevel++) {
        spellcastingModel.spellCategories[spellLevel].spells = eval(`level${spellLevel}Spells`);
      }

      setDialogControls(spellcastingModel);

      verifyDialogModel(spellcastingModel, expectedGeneratedText);
      verifyDialogControls(spellcastingModel, expectedRenderedText);

      generateSpellcastingDialog.generateSpellcastingButton.click();

      verifySpecialTraitBlocks(spellcastingModel.spellcasterType, expectedGeneratedText, expectedRenderedText);
    });
    /* eslint-enable indent, no-unexpected-multiline, no-unused-vars */
  });

  describe('and the dialog is submitted for a druid spellcaster, it should add a new spellcasting block under special traits', () => {
    // TODO
  });

  describe('and the dialog is submitted for a paladin spellcaster, it should add a new spellcasting block under special traits', () => {
    /* eslint-disable indent, no-unexpected-multiline, no-unused-vars */
    it.each
    `
      description           | level | abilityScore | proficiencyBonus | level1Spells                                                                                      | level2Spells                              | level3Spells                                             | level4Spells                                       | level5Spells                              | expectedGeneratedText                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  | expectedRenderedText
      ${'Level 1 Paladin'}  | ${1}  | ${12}        | ${2}             | ${[]}                                                                                             | ${[]}                                     | ${[]}                                                    | ${[]}                                              | ${[]}                                     | ${'[name] is a 1st-level spellcaster. Its spellcasting ability is Charisma (spell save DC sdc[cha], atk[cha] to hit with spell attacks). [name] has the following paladin spells prepared:\n\n'}                                                                                                                                                                                                                                                                                                                                                                                       | ${'The commoner is a 1st-level spellcaster. Its spellcasting ability is Charisma (spell save DC 11, +3 to hit with spell attacks). The commoner has the following paladin spells prepared:\n\n'}
      ${'Level 2 Paladin'}  | ${2}  | ${12}        | ${2}             | ${['Divine Favor']}                                                                               | ${[]}                                     | ${[]}                                                    | ${[]}                                              | ${[]}                                     | ${'[name] is a 2nd-level spellcaster. Its spellcasting ability is Charisma (spell save DC sdc[cha], atk[cha] to hit with spell attacks). [name] has the following paladin spells prepared:\n\n1st level (2 slots): *divine favor*'}                                                                                                                                                                                                                                                                                                                                                    | ${'The commoner is a 2nd-level spellcaster. Its spellcasting ability is Charisma (spell save DC 11, +3 to hit with spell attacks). The commoner has the following paladin spells prepared:\n\n1st level (2 slots): <em>divine favor</em>'}
      ${'Level 3 Paladin'}  | ${3}  | ${12}        | ${2}             | ${['Divine Favor', 'Shield of Faith']}                                                            | ${[]}                                     | ${[]}                                                    | ${[]}                                              | ${[]}                                     | ${'[name] is a 3rd-level spellcaster. Its spellcasting ability is Charisma (spell save DC sdc[cha], atk[cha] to hit with spell attacks). [name] has the following paladin spells prepared:\n\n1st level (3 slots): *divine favor*, *shield of faith*'}                                                                                                                                                                                                                                                                                                                                 | ${'The commoner is a 3rd-level spellcaster. Its spellcasting ability is Charisma (spell save DC 11, +3 to hit with spell attacks). The commoner has the following paladin spells prepared:\n\n1st level (3 slots): <em>divine favor</em>, <em>shield of faith</em>'}
      ${'Level 4 Paladin'}  | ${4}  | ${14}        | ${2}             | ${['Command', 'Cure Wounds', 'Divine Favor', 'Shield of Faith']}                                  | ${[]}                                     | ${[]}                                                    | ${[]}                                              | ${[]}                                     | ${'[name] is a 4th-level spellcaster. Its spellcasting ability is Charisma (spell save DC sdc[cha], atk[cha] to hit with spell attacks). [name] has the following paladin spells prepared:\n\n1st level (3 slots): *command*, *cure wounds*, *divine favor*, *shield of faith*'}                                                                                                                                                                                                                                                                                                       | ${'The commoner is a 4th-level spellcaster. Its spellcasting ability is Charisma (spell save DC 12, +4 to hit with spell attacks). The commoner has the following paladin spells prepared:\n\n1st level (3 slots): <em>command</em>, <em>cure wounds</em>, <em>divine favor</em>, <em>shield of faith</em>'}
      ${'Level 5 Paladin'}  | ${5}  | ${14}        | ${3}             | ${['Cure Wounds', 'Divine Favor', 'Shield of Faith']}                                             | ${['Zone of Truth']}                      | ${[]}                                                    | ${[]}                                              | ${[]}                                     | ${'[name] is a 5th-level spellcaster. Its spellcasting ability is Charisma (spell save DC sdc[cha], atk[cha] to hit with spell attacks). [name] has the following paladin spells prepared:\n\n1st level (4 slots): *cure wounds*, *divine favor*, *shield of faith*\n2nd level (2 slots): *zone of truth*'}                                                                                                                                                                                                                                                                            | ${'The commoner is a 5th-level spellcaster. Its spellcasting ability is Charisma (spell save DC 13, +5 to hit with spell attacks). The commoner has the following paladin spells prepared:\n\n1st level (4 slots): <em>cure wounds</em>, <em>divine favor</em>, <em>shield of faith</em>\n2nd level (2 slots): <em>zone of truth</em>'}
      ${'Level 6 Paladin'}  | ${6}  | ${14}        | ${3}             | ${['Cure Wounds', 'Divine Favor', 'Shield of Faith']}                                             | ${['Find Steed', 'Zone of Truth']}        | ${[]}                                                    | ${[]}                                              | ${[]}                                     | ${'[name] is a 6th-level spellcaster. Its spellcasting ability is Charisma (spell save DC sdc[cha], atk[cha] to hit with spell attacks). [name] has the following paladin spells prepared:\n\n1st level (4 slots): *cure wounds*, *divine favor*, *shield of faith*\n2nd level (2 slots): *find steed*, *zone of truth*'}                                                                                                                                                                                                                                                              | ${'The commoner is a 6th-level spellcaster. Its spellcasting ability is Charisma (spell save DC 13, +5 to hit with spell attacks). The commoner has the following paladin spells prepared:\n\n1st level (4 slots): <em>cure wounds</em>, <em>divine favor</em>, <em>shield of faith</em>\n2nd level (2 slots): <em>find steed</em>, <em>zone of truth</em>'}
      ${'Level 7 Paladin'}  | ${7}  | ${14}        | ${3}             | ${['Cure Wounds', 'Divine Favor', 'Shield of Faith']}                                             | ${['Find Steed', 'Zone of Truth']}        | ${[]}                                                    | ${[]}                                              | ${[]}                                     | ${'[name] is a 7th-level spellcaster. Its spellcasting ability is Charisma (spell save DC sdc[cha], atk[cha] to hit with spell attacks). [name] has the following paladin spells prepared:\n\n1st level (4 slots): *cure wounds*, *divine favor*, *shield of faith*\n2nd level (3 slots): *find steed*, *zone of truth*'}                                                                                                                                                                                                                                                              | ${'The commoner is a 7th-level spellcaster. Its spellcasting ability is Charisma (spell save DC 13, +5 to hit with spell attacks). The commoner has the following paladin spells prepared:\n\n1st level (4 slots): <em>cure wounds</em>, <em>divine favor</em>, <em>shield of faith</em>\n2nd level (3 slots): <em>find steed</em>, <em>zone of truth</em>'}
      ${'Level 8 Paladin'}  | ${8}  | ${16}        | ${3}             | ${['Command', 'Cure Wounds', 'Divine Favor', 'Shield of Faith']}                                  | ${['Aid', 'Find Steed', 'Zone of Truth']} | ${[]}                                                    | ${[]}                                              | ${[]}                                     | ${'[name] is a 8th-level spellcaster. Its spellcasting ability is Charisma (spell save DC sdc[cha], atk[cha] to hit with spell attacks). [name] has the following paladin spells prepared:\n\n1st level (4 slots): *command*, *cure wounds*, *divine favor*, *shield of faith*\n2nd level (3 slots): *aid*, *find steed*, *zone of truth*'}                                                                                                                                                                                                                                            | ${'The commoner is a 8th-level spellcaster. Its spellcasting ability is Charisma (spell save DC 14, +6 to hit with spell attacks). The commoner has the following paladin spells prepared:\n\n1st level (4 slots): <em>command</em>, <em>cure wounds</em>, <em>divine favor</em>, <em>shield of faith</em>\n2nd level (3 slots): <em>aid</em>, <em>find steed</em>, <em>zone of truth</em>'}
      ${'Level 9 Paladin'}  | ${9}  | ${16}        | ${4}             | ${['Command', 'Cure Wounds', 'Divine Favor', 'Shield of Faith']}                                  | ${['Aid', 'Zone of Truth']}               | ${['Revivify']}                                          | ${[]}                                              | ${[]}                                     | ${'[name] is a 9th-level spellcaster. Its spellcasting ability is Charisma (spell save DC sdc[cha], atk[cha] to hit with spell attacks). [name] has the following paladin spells prepared:\n\n1st level (4 slots): *command*, *cure wounds*, *divine favor*, *shield of faith*\n2nd level (3 slots): *aid*, *zone of truth*\n3rd level (2 slots): *revivify*'}                                                                                                                                                                                                                         | ${'The commoner is a 9th-level spellcaster. Its spellcasting ability is Charisma (spell save DC 15, +7 to hit with spell attacks). The commoner has the following paladin spells prepared:\n\n1st level (4 slots): <em>command</em>, <em>cure wounds</em>, <em>divine favor</em>, <em>shield of faith</em>\n2nd level (3 slots): <em>aid</em>, <em>zone of truth</em>\n3rd level (2 slots): <em>revivify</em>'}
      ${'Level 10 Paladin'} | ${10} | ${16}        | ${4}             | ${['Command', 'Cure Wounds', 'Divine Favor', 'Shield of Faith']}                                  | ${['Aid', 'Zone of Truth']}               | ${['Remove Curse', 'Revivify']}                          | ${[]}                                              | ${[]}                                     | ${'[name] is a 10th-level spellcaster. Its spellcasting ability is Charisma (spell save DC sdc[cha], atk[cha] to hit with spell attacks). [name] has the following paladin spells prepared:\n\n1st level (4 slots): *command*, *cure wounds*, *divine favor*, *shield of faith*\n2nd level (3 slots): *aid*, *zone of truth*\n3rd level (2 slots): *remove curse*, *revivify*'}                                                                                                                                                                                                        | ${'The commoner is a 10th-level spellcaster. Its spellcasting ability is Charisma (spell save DC 15, +7 to hit with spell attacks). The commoner has the following paladin spells prepared:\n\n1st level (4 slots): <em>command</em>, <em>cure wounds</em>, <em>divine favor</em>, <em>shield of faith</em>\n2nd level (3 slots): <em>aid</em>, <em>zone of truth</em>\n3rd level (2 slots): <em>remove curse</em>, <em>revivify</em>'}
      ${'Level 11 Paladin'} | ${11} | ${16}        | ${4}             | ${['Command', 'Cure Wounds', 'Divine Favor', 'Shield of Faith']}                                  | ${['Aid', 'Zone of Truth']}               | ${['Remove Curse', 'Revivify']}                          | ${[]}                                              | ${[]}                                     | ${'[name] is a 11th-level spellcaster. Its spellcasting ability is Charisma (spell save DC sdc[cha], atk[cha] to hit with spell attacks). [name] has the following paladin spells prepared:\n\n1st level (4 slots): *command*, *cure wounds*, *divine favor*, *shield of faith*\n2nd level (3 slots): *aid*, *zone of truth*\n3rd level (3 slots): *remove curse*, *revivify*'}                                                                                                                                                                                                        | ${'The commoner is a 11th-level spellcaster. Its spellcasting ability is Charisma (spell save DC 15, +7 to hit with spell attacks). The commoner has the following paladin spells prepared:\n\n1st level (4 slots): <em>command</em>, <em>cure wounds</em>, <em>divine favor</em>, <em>shield of faith</em>\n2nd level (3 slots): <em>aid</em>, <em>zone of truth</em>\n3rd level (3 slots): <em>remove curse</em>, <em>revivify</em>'}
      ${'Level 12 Paladin'} | ${12} | ${18}        | ${4}             | ${['Command', 'Cure Wounds', 'Divine Favor', 'Shield of Faith']}                                  | ${['Aid', 'Find Steed', 'Zone of Truth']} | ${['Create Food and Water', 'Remove Curse', 'Revivify']} | ${[]}                                              | ${[]}                                     | ${'[name] is a 12th-level spellcaster. Its spellcasting ability is Charisma (spell save DC sdc[cha], atk[cha] to hit with spell attacks). [name] has the following paladin spells prepared:\n\n1st level (4 slots): *command*, *cure wounds*, *divine favor*, *shield of faith*\n2nd level (3 slots): *aid*, *find steed*, *zone of truth*\n3rd level (3 slots): *create food and water*, *remove curse*, *revivify*'}                                                                                                                                                                 | ${'The commoner is a 12th-level spellcaster. Its spellcasting ability is Charisma (spell save DC 16, +8 to hit with spell attacks). The commoner has the following paladin spells prepared:\n\n1st level (4 slots): <em>command</em>, <em>cure wounds</em>, <em>divine favor</em>, <em>shield of faith</em>\n2nd level (3 slots): <em>aid</em>, <em>find steed</em>, <em>zone of truth</em>\n3rd level (3 slots): <em>create food and water</em>, <em>remove curse</em>, <em>revivify</em>'}
      ${'Level 13 Paladin'} | ${13} | ${18}        | ${5}             | ${['Command', 'Cure Wounds', 'Divine Favor', 'Shield of Faith']}                                  | ${['Aid', 'Find Steed', 'Zone of Truth']} | ${['Remove Curse', 'Revivify']}                          | ${['Death Ward']}                                  | ${[]}                                     | ${'[name] is a 13th-level spellcaster. Its spellcasting ability is Charisma (spell save DC sdc[cha], atk[cha] to hit with spell attacks). [name] has the following paladin spells prepared:\n\n1st level (4 slots): *command*, *cure wounds*, *divine favor*, *shield of faith*\n2nd level (3 slots): *aid*, *find steed*, *zone of truth*\n3rd level (3 slots): *remove curse*, *revivify*\n4th level (1 slot): *death ward*'}                                                                                                                                                        | ${'The commoner is a 13th-level spellcaster. Its spellcasting ability is Charisma (spell save DC 17, +9 to hit with spell attacks). The commoner has the following paladin spells prepared:\n\n1st level (4 slots): <em>command</em>, <em>cure wounds</em>, <em>divine favor</em>, <em>shield of faith</em>\n2nd level (3 slots): <em>aid</em>, <em>find steed</em>, <em>zone of truth</em>\n3rd level (3 slots): <em>remove curse</em>, <em>revivify</em>\n4th level (1 slot): <em>death ward</em>'}
      ${'Level 14 Paladin'} | ${14} | ${18}        | ${5}             | ${['Command', 'Cure Wounds', 'Divine Favor', 'Shield of Faith']}                                  | ${['Aid', 'Find Steed', 'Zone of Truth']} | ${['Create Food and Water', 'Remove Curse', 'Revivify']} | ${['Death Ward']}                                  | ${[]}                                     | ${'[name] is a 14th-level spellcaster. Its spellcasting ability is Charisma (spell save DC sdc[cha], atk[cha] to hit with spell attacks). [name] has the following paladin spells prepared:\n\n1st level (4 slots): *command*, *cure wounds*, *divine favor*, *shield of faith*\n2nd level (3 slots): *aid*, *find steed*, *zone of truth*\n3rd level (3 slots): *create food and water*, *remove curse*, *revivify*\n4th level (1 slot): *death ward*'}                                                                                                                               | ${'The commoner is a 14th-level spellcaster. Its spellcasting ability is Charisma (spell save DC 17, +9 to hit with spell attacks). The commoner has the following paladin spells prepared:\n\n1st level (4 slots): <em>command</em>, <em>cure wounds</em>, <em>divine favor</em>, <em>shield of faith</em>\n2nd level (3 slots): <em>aid</em>, <em>find steed</em>, <em>zone of truth</em>\n3rd level (3 slots): <em>create food and water</em>, <em>remove curse</em>, <em>revivify</em>\n4th level (1 slot): <em>death ward</em>'}
      ${'Level 15 Paladin'} | ${15} | ${18}        | ${5}             | ${['Command', 'Cure Wounds', 'Divine Favor', 'Shield of Faith']}                                  | ${['Aid', 'Find Steed', 'Zone of Truth']} | ${['Create Food and Water', 'Remove Curse', 'Revivify']} | ${['Death Ward']}                                  | ${[]}                                     | ${'[name] is a 15th-level spellcaster. Its spellcasting ability is Charisma (spell save DC sdc[cha], atk[cha] to hit with spell attacks). [name] has the following paladin spells prepared:\n\n1st level (4 slots): *command*, *cure wounds*, *divine favor*, *shield of faith*\n2nd level (3 slots): *aid*, *find steed*, *zone of truth*\n3rd level (3 slots): *create food and water*, *remove curse*, *revivify*\n4th level (2 slots): *death ward*'}                                                                                                                              | ${'The commoner is a 15th-level spellcaster. Its spellcasting ability is Charisma (spell save DC 17, +9 to hit with spell attacks). The commoner has the following paladin spells prepared:\n\n1st level (4 slots): <em>command</em>, <em>cure wounds</em>, <em>divine favor</em>, <em>shield of faith</em>\n2nd level (3 slots): <em>aid</em>, <em>find steed</em>, <em>zone of truth</em>\n3rd level (3 slots): <em>create food and water</em>, <em>remove curse</em>, <em>revivify</em>\n4th level (2 slots): <em>death ward</em>'}
      ${'Level 16 Paladin'} | ${16} | ${20}        | ${5}             | ${['Command', 'Cure Wounds', 'Divine Favor', 'Protection from Evil and Good', 'Shield of Faith']} | ${['Aid', 'Find Steed', 'Zone of Truth']} | ${['Create Food and Water', 'Remove Curse', 'Revivify']} | ${['Death Ward', 'Locate Creature']}               | ${[]}                                     | ${'[name] is a 16th-level spellcaster. Its spellcasting ability is Charisma (spell save DC sdc[cha], atk[cha] to hit with spell attacks). [name] has the following paladin spells prepared:\n\n1st level (4 slots): *command*, *cure wounds*, *divine favor*, *protection from evil and good*, *shield of faith*\n2nd level (3 slots): *aid*, *find steed*, *zone of truth*\n3rd level (3 slots): *create food and water*, *remove curse*, *revivify*\n4th level (2 slots): *death ward*, *locate creature*'}                                                                          | ${'The commoner is a 16th-level spellcaster. Its spellcasting ability is Charisma (spell save DC 18, +10 to hit with spell attacks). The commoner has the following paladin spells prepared:\n\n1st level (4 slots): <em>command</em>, <em>cure wounds</em>, <em>divine favor</em>, <em>protection from evil and good</em>, <em>shield of faith</em>\n2nd level (3 slots): <em>aid</em>, <em>find steed</em>, <em>zone of truth</em>\n3rd level (3 slots): <em>create food and water</em>, <em>remove curse</em>, <em>revivify</em>\n4th level (2 slots): <em>death ward</em>, <em>locate creature</em>'}
      ${'Level 17 Paladin'} | ${17} | ${20}        | ${6}             | ${['Command', 'Cure Wounds', 'Divine Favor', 'Shield of Faith']}                                  | ${['Aid', 'Find Steed', 'Zone of Truth']} | ${['Create Food and Water', 'Remove Curse', 'Revivify']} | ${['Death Ward', 'Locate Creature']}               | ${['Dispel Evil and Good']}               | ${'[name] is a 17th-level spellcaster. Its spellcasting ability is Charisma (spell save DC sdc[cha], atk[cha] to hit with spell attacks). [name] has the following paladin spells prepared:\n\n1st level (4 slots): *command*, *cure wounds*, *divine favor*, *shield of faith*\n2nd level (3 slots): *aid*, *find steed*, *zone of truth*\n3rd level (3 slots): *create food and water*, *remove curse*, *revivify*\n4th level (3 slots): *death ward*, *locate creature*\n5th level (1 slot): *dispel evil and good*'}                                                               | ${'The commoner is a 17th-level spellcaster. Its spellcasting ability is Charisma (spell save DC 19, +11 to hit with spell attacks). The commoner has the following paladin spells prepared:\n\n1st level (4 slots): <em>command</em>, <em>cure wounds</em>, <em>divine favor</em>, <em>shield of faith</em>\n2nd level (3 slots): <em>aid</em>, <em>find steed</em>, <em>zone of truth</em>\n3rd level (3 slots): <em>create food and water</em>, <em>remove curse</em>, <em>revivify</em>\n4th level (3 slots): <em>death ward</em>, <em>locate creature</em>\n5th level (1 slot): <em>dispel evil and good</em>'}
      ${'Level 18 Paladin'} | ${18} | ${20}        | ${6}             | ${['Command', 'Cure Wounds', 'Divine Favor', 'Protection from Evil and Good', 'Shield of Faith']} | ${['Aid', 'Find Steed', 'Zone of Truth']} | ${['Create Food and Water', 'Remove Curse', 'Revivify']} | ${['Death Ward', 'Locate Creature']}               | ${['Dispel Evil and Good']}               | ${'[name] is a 18th-level spellcaster. Its spellcasting ability is Charisma (spell save DC sdc[cha], atk[cha] to hit with spell attacks). [name] has the following paladin spells prepared:\n\n1st level (4 slots): *command*, *cure wounds*, *divine favor*, *protection from evil and good*, *shield of faith*\n2nd level (3 slots): *aid*, *find steed*, *zone of truth*\n3rd level (3 slots): *create food and water*, *remove curse*, *revivify*\n4th level (3 slots): *death ward*, *locate creature*\n5th level (1 slot): *dispel evil and good*'}                              | ${'The commoner is a 18th-level spellcaster. Its spellcasting ability is Charisma (spell save DC 19, +11 to hit with spell attacks). The commoner has the following paladin spells prepared:\n\n1st level (4 slots): <em>command</em>, <em>cure wounds</em>, <em>divine favor</em>, <em>protection from evil and good</em>, <em>shield of faith</em>\n2nd level (3 slots): <em>aid</em>, <em>find steed</em>, <em>zone of truth</em>\n3rd level (3 slots): <em>create food and water</em>, <em>remove curse</em>, <em>revivify</em>\n4th level (3 slots): <em>death ward</em>, <em>locate creature</em>\n5th level (1 slot): <em>dispel evil and good</em>'}
      ${'Level 19 Paladin'} | ${19} | ${22}        | ${6}             | ${['Command', 'Cure Wounds', 'Divine Favor', 'Protection from Evil and Good', 'Shield of Faith']} | ${['Aid', 'Find Steed', 'Zone of Truth']} | ${['Create Food and Water', 'Remove Curse', 'Revivify']} | ${['Death Ward', 'Locate Creature']}               | ${['Dispel Evil and Good', 'Raise Dead']} | ${'[name] is a 19th-level spellcaster. Its spellcasting ability is Charisma (spell save DC sdc[cha], atk[cha] to hit with spell attacks). [name] has the following paladin spells prepared:\n\n1st level (4 slots): *command*, *cure wounds*, *divine favor*, *protection from evil and good*, *shield of faith*\n2nd level (3 slots): *aid*, *find steed*, *zone of truth*\n3rd level (3 slots): *create food and water*, *remove curse*, *revivify*\n4th level (3 slots): *death ward*, *locate creature*\n5th level (2 slots): *dispel evil and good*, *raise dead*'}               | ${'The commoner is a 19th-level spellcaster. Its spellcasting ability is Charisma (spell save DC 20, +12 to hit with spell attacks). The commoner has the following paladin spells prepared:\n\n1st level (4 slots): <em>command</em>, <em>cure wounds</em>, <em>divine favor</em>, <em>protection from evil and good</em>, <em>shield of faith</em>\n2nd level (3 slots): <em>aid</em>, <em>find steed</em>, <em>zone of truth</em>\n3rd level (3 slots): <em>create food and water</em>, <em>remove curse</em>, <em>revivify</em>\n4th level (3 slots): <em>death ward</em>, <em>locate creature</em>\n5th level (2 slots): <em>dispel evil and good</em>, <em>raise dead</em>'}
      ${'Level 20 Paladin'} | ${20} | ${22}        | ${6}             | ${['Command', 'Cure Wounds', 'Divine Favor', 'Protection from Evil and Good', 'Shield of Faith']} | ${['Aid', 'Find Steed', 'Zone of Truth']} | ${['Create Food and Water', 'Remove Curse', 'Revivify']} | ${['Banishment', 'Death Ward', 'Locate Creature']} | ${['Dispel Evil and Good', 'Raise Dead']} | ${'[name] is a 20th-level spellcaster. Its spellcasting ability is Charisma (spell save DC sdc[cha], atk[cha] to hit with spell attacks). [name] has the following paladin spells prepared:\n\n1st level (4 slots): *command*, *cure wounds*, *divine favor*, *protection from evil and good*, *shield of faith*\n2nd level (3 slots): *aid*, *find steed*, *zone of truth*\n3rd level (3 slots): *create food and water*, *remove curse*, *revivify*\n4th level (3 slots): *banishment*, *death ward*, *locate creature*\n5th level (2 slots): *dispel evil and good*, *raise dead*'} | ${'The commoner is a 20th-level spellcaster. Its spellcasting ability is Charisma (spell save DC 20, +12 to hit with spell attacks). The commoner has the following paladin spells prepared:\n\n1st level (4 slots): <em>command</em>, <em>cure wounds</em>, <em>divine favor</em>, <em>protection from evil and good</em>, <em>shield of faith</em>\n2nd level (3 slots): <em>aid</em>, <em>find steed</em>, <em>zone of truth</em>\n3rd level (3 slots): <em>create food and water</em>, <em>remove curse</em>, <em>revivify</em>\n4th level (3 slots): <em>banishment</em>, <em>death ward</em>, <em>locate creature</em>\n5th level (2 slots): <em>dispel evil and good</em>, <em>raise dead</em>'}
    `
    ('$description',
    ({level, abilityScore, proficiencyBonus, level1Spells, level2Spells, level3Spells, level4Spells, level5Spells, expectedGeneratedText, expectedRenderedText}) => {
      const abilityName = 'charisma';

      abilitiesModel.abilities[abilityName].score = abilityScore;
      challengeRatingModel.proficiencyBonus = proficiencyBonus;

      const spellcastingModel = new Spellcasting();
      spellcastingModel.spellcasterType = 'paladin';
      spellcastingModel.spellcasterAbility = abilityName;
      spellcastingModel.spellcasterLevel = level;

      for (let spellLevel = 1; spellLevel <= 5; spellLevel++) {
        spellcastingModel.spellCategories[spellLevel].spells = eval(`level${spellLevel}Spells`);
      }

      setDialogControls(spellcastingModel);

      verifyDialogModel(spellcastingModel, expectedGeneratedText);
      verifyDialogControls(spellcastingModel, expectedRenderedText);

      generateSpellcastingDialog.generateSpellcastingButton.click();

      verifySpecialTraitBlocks(spellcastingModel.spellcasterType, expectedGeneratedText, expectedRenderedText);
    });
    /* eslint-enable indent, no-unexpected-multiline, no-unused-vars */
  });

  describe('and the dialog is submitted for a ranger spellcaster, it should add a new spellcasting block under special traits', () => {
    /* eslint-disable indent, no-unexpected-multiline, no-unused-vars */
    it.each
    `
      description          | level | abilityScore | proficiencyBonus | level1Spells                                                     | level2Spells                         | level3Spells                                | level4Spells                                          | level5Spells                              | expectedGeneratedText                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               | expectedRenderedText
      ${'Level 1 Ranger'}  | ${1}  | ${12}        | ${2}             | ${[]}                                                            | ${[]}                                | ${[]}                                       | ${[]}                                                 | ${[]}                                     | ${'[name] is a 1st-level spellcaster. Its spellcasting ability is Wisdom (spell save DC sdc[wis], atk[wis] to hit with spell attacks). [name] has the following ranger spells prepared:\n\n'}                                                                                                                                                                                                                                                                                                                                       | ${'The commoner is a 1st-level spellcaster. Its spellcasting ability is Wisdom (spell save DC 11, +3 to hit with spell attacks). The commoner has the following ranger spells prepared:\n\n'}
      ${'Level 2 Ranger'}  | ${2}  | ${12}        | ${2}             | ${['Animal Friendship', 'Hunter\'s Mark']}                       | ${[]}                                | ${[]}                                       | ${[]}                                                 | ${[]}                                     | ${'[name] is a 2nd-level spellcaster. Its spellcasting ability is Wisdom (spell save DC sdc[wis], atk[wis] to hit with spell attacks). [name] has the following ranger spells prepared:\n\n1st level (2 slots): *animal friendship*, *hunter\'s mark*'}                                                                                                                                                                                                                                                                             | ${'The commoner is a 2nd-level spellcaster. Its spellcasting ability is Wisdom (spell save DC 11, +3 to hit with spell attacks). The commoner has the following ranger spells prepared:\n\n1st level (2 slots): <em>animal friendship</em>, <em>hunter\'s mark</em>'}
      ${'Level 3 Ranger'}  | ${3}  | ${12}        | ${2}             | ${['Animal Friendship', 'Hunter\'s Mark', 'Speak with Animals']} | ${[]}                                | ${[]}                                       | ${[]}                                                 | ${[]}                                     | ${'[name] is a 3rd-level spellcaster. Its spellcasting ability is Wisdom (spell save DC sdc[wis], atk[wis] to hit with spell attacks). [name] has the following ranger spells prepared:\n\n1st level (3 slots): *animal friendship*, *hunter\'s mark*, *speak with animals*'}                                                                                                                                                                                                                                                       | ${'The commoner is a 3rd-level spellcaster. Its spellcasting ability is Wisdom (spell save DC 11, +3 to hit with spell attacks). The commoner has the following ranger spells prepared:\n\n1st level (3 slots): <em>animal friendship</em>, <em>hunter\'s mark</em>, <em>speak with animals</em>'}
      ${'Level 4 Ranger'}  | ${4}  | ${14}        | ${2}             | ${['Animal Friendship', 'Hunter\'s Mark', 'Speak with Animals']} | ${[]}                                | ${[]}                                       | ${[]}                                                 | ${[]}                                     | ${'[name] is a 4th-level spellcaster. Its spellcasting ability is Wisdom (spell save DC sdc[wis], atk[wis] to hit with spell attacks). [name] has the following ranger spells prepared:\n\n1st level (3 slots): *animal friendship*, *hunter\'s mark*, *speak with animals*'}                                                                                                                                                                                                                                                       | ${'The commoner is a 4th-level spellcaster. Its spellcasting ability is Wisdom (spell save DC 12, +4 to hit with spell attacks). The commoner has the following ranger spells prepared:\n\n1st level (3 slots): <em>animal friendship</em>, <em>hunter\'s mark</em>, <em>speak with animals</em>'}
      ${'Level 5 Ranger'}  | ${5}  | ${14}        | ${3}             | ${['Animal Friendship', 'Hunter\'s Mark', 'Speak with Animals']} | ${['Silence']}                       | ${[]}                                       | ${[]}                                                 | ${[]}                                     | ${'[name] is a 5th-level spellcaster. Its spellcasting ability is Wisdom (spell save DC sdc[wis], atk[wis] to hit with spell attacks). [name] has the following ranger spells prepared:\n\n1st level (4 slots): *animal friendship*, *hunter\'s mark*, *speak with animals*\n2nd level (2 slots): *silence*'}                                                                                                                                                                                                                       | ${'The commoner is a 5th-level spellcaster. Its spellcasting ability is Wisdom (spell save DC 13, +5 to hit with spell attacks). The commoner has the following ranger spells prepared:\n\n1st level (4 slots): <em>animal friendship</em>, <em>hunter\'s mark</em>, <em>speak with animals</em>\n2nd level (2 slots): <em>silence</em>'}
      ${'Level 6 Ranger'}  | ${6}  | ${14}        | ${3}             | ${['Animal Friendship', 'Hunter\'s Mark', 'Speak with Animals']} | ${['Silence']}                       | ${[]}                                       | ${[]}                                                 | ${[]}                                     | ${'[name] is a 6th-level spellcaster. Its spellcasting ability is Wisdom (spell save DC sdc[wis], atk[wis] to hit with spell attacks). [name] has the following ranger spells prepared:\n\n1st level (4 slots): *animal friendship*, *hunter\'s mark*, *speak with animals*\n2nd level (2 slots): *silence*'}                                                                                                                                                                                                                       | ${'The commoner is a 6th-level spellcaster. Its spellcasting ability is Wisdom (spell save DC 13, +5 to hit with spell attacks). The commoner has the following ranger spells prepared:\n\n1st level (4 slots): <em>animal friendship</em>, <em>hunter\'s mark</em>, <em>speak with animals</em>\n2nd level (2 slots): <em>silence</em>'}
      ${'Level 7 Ranger'}  | ${7}  | ${14}        | ${3}             | ${['Animal Friendship', 'Hunter\'s Mark', 'Speak with Animals']} | ${['Lesser Restoration', 'Silence']} | ${[]}                                       | ${[]}                                                 | ${[]}                                     | ${'[name] is a 7th-level spellcaster. Its spellcasting ability is Wisdom (spell save DC sdc[wis], atk[wis] to hit with spell attacks). [name] has the following ranger spells prepared:\n\n1st level (4 slots): *animal friendship*, *hunter\'s mark*, *speak with animals*\n2nd level (3 slots): *lesser restoration*, *silence*'}                                                                                                                                                                                                 | ${'The commoner is a 7th-level spellcaster. Its spellcasting ability is Wisdom (spell save DC 13, +5 to hit with spell attacks). The commoner has the following ranger spells prepared:\n\n1st level (4 slots): <em>animal friendship</em>, <em>hunter\'s mark</em>, <em>speak with animals</em>\n2nd level (3 slots): <em>lesser restoration</em>, <em>silence</em>'}
      ${'Level 8 Ranger'}  | ${8}  | ${16}        | ${3}             | ${['Animal Friendship', 'Hunter\'s Mark', 'Speak with Animals']} | ${['Lesser Restoration', 'Silence']} | ${[]}                                       | ${[]}                                                 | ${[]}                                     | ${'[name] is a 8th-level spellcaster. Its spellcasting ability is Wisdom (spell save DC sdc[wis], atk[wis] to hit with spell attacks). [name] has the following ranger spells prepared:\n\n1st level (4 slots): *animal friendship*, *hunter\'s mark*, *speak with animals*\n2nd level (3 slots): *lesser restoration*, *silence*'}                                                                                                                                                                                                 | ${'The commoner is a 8th-level spellcaster. Its spellcasting ability is Wisdom (spell save DC 14, +6 to hit with spell attacks). The commoner has the following ranger spells prepared:\n\n1st level (4 slots): <em>animal friendship</em>, <em>hunter\'s mark</em>, <em>speak with animals</em>\n2nd level (3 slots): <em>lesser restoration</em>, <em>silence</em>'}
      ${'Level 9 Ranger'}  | ${9}  | ${16}        | ${4}             | ${['Animal Friendship', 'Hunter\'s Mark', 'Speak with Animals']} | ${['Lesser Restoration', 'Silence']} | ${['Conjure Animals']}                      | ${[]}                                                 | ${[]}                                     | ${'[name] is a 9th-level spellcaster. Its spellcasting ability is Wisdom (spell save DC sdc[wis], atk[wis] to hit with spell attacks). [name] has the following ranger spells prepared:\n\n1st level (4 slots): *animal friendship*, *hunter\'s mark*, *speak with animals*\n2nd level (3 slots): *lesser restoration*, *silence*\n3rd level (2 slots): *conjure animals*'}                                                                                                                                                         | ${'The commoner is a 9th-level spellcaster. Its spellcasting ability is Wisdom (spell save DC 15, +7 to hit with spell attacks). The commoner has the following ranger spells prepared:\n\n1st level (4 slots): <em>animal friendship</em>, <em>hunter\'s mark</em>, <em>speak with animals</em>\n2nd level (3 slots): <em>lesser restoration</em>, <em>silence</em>\n3rd level (2 slots): <em>conjure animals</em>'}
      ${'Level 10 Ranger'} | ${10} | ${16}        | ${4}             | ${['Animal Friendship', 'Hunter\'s Mark', 'Speak with Animals']} | ${['Lesser Restoration', 'Silence']} | ${['Conjure Animals']}                      | ${[]}                                                 | ${[]}                                     | ${'[name] is a 10th-level spellcaster. Its spellcasting ability is Wisdom (spell save DC sdc[wis], atk[wis] to hit with spell attacks). [name] has the following ranger spells prepared:\n\n1st level (4 slots): *animal friendship*, *hunter\'s mark*, *speak with animals*\n2nd level (3 slots): *lesser restoration*, *silence*\n3rd level (2 slots): *conjure animals*'}                                                                                                                                                        | ${'The commoner is a 10th-level spellcaster. Its spellcasting ability is Wisdom (spell save DC 15, +7 to hit with spell attacks). The commoner has the following ranger spells prepared:\n\n1st level (4 slots): <em>animal friendship</em>, <em>hunter\'s mark</em>, <em>speak with animals</em>\n2nd level (3 slots): <em>lesser restoration</em>, <em>silence</em>\n3rd level (2 slots): <em>conjure animals</em>'}
      ${'Level 11 Ranger'} | ${11} | ${16}        | ${4}             | ${['Animal Friendship', 'Hunter\'s Mark', 'Speak with Animals']} | ${['Lesser Restoration', 'Silence']} | ${['Conjure Animals', 'Speak with Plants']} | ${[]}                                                 | ${[]}                                     | ${'[name] is a 11th-level spellcaster. Its spellcasting ability is Wisdom (spell save DC sdc[wis], atk[wis] to hit with spell attacks). [name] has the following ranger spells prepared:\n\n1st level (4 slots): *animal friendship*, *hunter\'s mark*, *speak with animals*\n2nd level (3 slots): *lesser restoration*, *silence*\n3rd level (3 slots): *conjure animals*, *speak with plants*'}                                                                                                                                   | ${'The commoner is a 11th-level spellcaster. Its spellcasting ability is Wisdom (spell save DC 15, +7 to hit with spell attacks). The commoner has the following ranger spells prepared:\n\n1st level (4 slots): <em>animal friendship</em>, <em>hunter\'s mark</em>, <em>speak with animals</em>\n2nd level (3 slots): <em>lesser restoration</em>, <em>silence</em>\n3rd level (3 slots): <em>conjure animals</em>, <em>speak with plants</em>'}
      ${'Level 12 Ranger'} | ${12} | ${18}        | ${4}             | ${['Animal Friendship', 'Hunter\'s Mark', 'Speak with Animals']} | ${['Lesser Restoration', 'Silence']} | ${['Conjure Animals', 'Speak with Plants']} | ${[]}                                                 | ${[]}                                     | ${'[name] is a 12th-level spellcaster. Its spellcasting ability is Wisdom (spell save DC sdc[wis], atk[wis] to hit with spell attacks). [name] has the following ranger spells prepared:\n\n1st level (4 slots): *animal friendship*, *hunter\'s mark*, *speak with animals*\n2nd level (3 slots): *lesser restoration*, *silence*\n3rd level (3 slots): *conjure animals*, *speak with plants*'}                                                                                                                                   | ${'The commoner is a 12th-level spellcaster. Its spellcasting ability is Wisdom (spell save DC 16, +8 to hit with spell attacks). The commoner has the following ranger spells prepared:\n\n1st level (4 slots): <em>animal friendship</em>, <em>hunter\'s mark</em>, <em>speak with animals</em>\n2nd level (3 slots): <em>lesser restoration</em>, <em>silence</em>\n3rd level (3 slots): <em>conjure animals</em>, <em>speak with plants</em>'}
      ${'Level 13 Ranger'} | ${13} | ${18}        | ${5}             | ${['Animal Friendship', 'Hunter\'s Mark', 'Speak with Animals']} | ${['Lesser Restoration', 'Silence']} | ${['Conjure Animals', 'Speak with Plants']} | ${['Freedom of Movement']}                            | ${[]}                                     | ${'[name] is a 13th-level spellcaster. Its spellcasting ability is Wisdom (spell save DC sdc[wis], atk[wis] to hit with spell attacks). [name] has the following ranger spells prepared:\n\n1st level (4 slots): *animal friendship*, *hunter\'s mark*, *speak with animals*\n2nd level (3 slots): *lesser restoration*, *silence*\n3rd level (3 slots): *conjure animals*, *speak with plants*\n4th level (1 slot): *freedom of movement*'}                                                                                        | ${'The commoner is a 13th-level spellcaster. Its spellcasting ability is Wisdom (spell save DC 17, +9 to hit with spell attacks). The commoner has the following ranger spells prepared:\n\n1st level (4 slots): <em>animal friendship</em>, <em>hunter\'s mark</em>, <em>speak with animals</em>\n2nd level (3 slots): <em>lesser restoration</em>, <em>silence</em>\n3rd level (3 slots): <em>conjure animals</em>, <em>speak with plants</em>\n4th level (1 slot): <em>freedom of movement</em>'}
      ${'Level 14 Ranger'} | ${14} | ${18}        | ${5}             | ${['Animal Friendship', 'Hunter\'s Mark', 'Speak with Animals']} | ${['Lesser Restoration', 'Silence']} | ${['Conjure Animals', 'Speak with Plants']} | ${['Freedom of Movement']}                            | ${[]}                                     | ${'[name] is a 14th-level spellcaster. Its spellcasting ability is Wisdom (spell save DC sdc[wis], atk[wis] to hit with spell attacks). [name] has the following ranger spells prepared:\n\n1st level (4 slots): *animal friendship*, *hunter\'s mark*, *speak with animals*\n2nd level (3 slots): *lesser restoration*, *silence*\n3rd level (3 slots): *conjure animals*, *speak with plants*\n4th level (1 slot): *freedom of movement*'}                                                                                        | ${'The commoner is a 14th-level spellcaster. Its spellcasting ability is Wisdom (spell save DC 17, +9 to hit with spell attacks). The commoner has the following ranger spells prepared:\n\n1st level (4 slots): <em>animal friendship</em>, <em>hunter\'s mark</em>, <em>speak with animals</em>\n2nd level (3 slots): <em>lesser restoration</em>, <em>silence</em>\n3rd level (3 slots): <em>conjure animals</em>, <em>speak with plants</em>\n4th level (1 slot): <em>freedom of movement</em>'}
      ${'Level 15 Ranger'} | ${15} | ${18}        | ${5}             | ${['Animal Friendship', 'Hunter\'s Mark', 'Speak with Animals']} | ${['Lesser Restoration', 'Silence']} | ${['Conjure Animals', 'Speak with Plants']} | ${['Conjure Woodland Beings', 'Freedom of Movement']} | ${[]}                                     | ${'[name] is a 15th-level spellcaster. Its spellcasting ability is Wisdom (spell save DC sdc[wis], atk[wis] to hit with spell attacks). [name] has the following ranger spells prepared:\n\n1st level (4 slots): *animal friendship*, *hunter\'s mark*, *speak with animals*\n2nd level (3 slots): *lesser restoration*, *silence*\n3rd level (3 slots): *conjure animals*, *speak with plants*\n4th level (2 slots): *conjure woodland beings*, *freedom of movement*'}                                                            | ${'The commoner is a 15th-level spellcaster. Its spellcasting ability is Wisdom (spell save DC 17, +9 to hit with spell attacks). The commoner has the following ranger spells prepared:\n\n1st level (4 slots): <em>animal friendship</em>, <em>hunter\'s mark</em>, <em>speak with animals</em>\n2nd level (3 slots): <em>lesser restoration</em>, <em>silence</em>\n3rd level (3 slots): <em>conjure animals</em>, <em>speak with plants</em>\n4th level (2 slots): <em>conjure woodland beings</em>, <em>freedom of movement</em>'}
      ${'Level 16 Ranger'} | ${16} | ${20}        | ${5}             | ${['Animal Friendship', 'Hunter\'s Mark', 'Speak with Animals']} | ${['Lesser Restoration', 'Silence']} | ${['Conjure Animals', 'Speak with Plants']} | ${['Conjure Woodland Beings', 'Freedom of Movement']} | ${[]}                                     | ${'[name] is a 16th-level spellcaster. Its spellcasting ability is Wisdom (spell save DC sdc[wis], atk[wis] to hit with spell attacks). [name] has the following ranger spells prepared:\n\n1st level (4 slots): *animal friendship*, *hunter\'s mark*, *speak with animals*\n2nd level (3 slots): *lesser restoration*, *silence*\n3rd level (3 slots): *conjure animals*, *speak with plants*\n4th level (2 slots): *conjure woodland beings*, *freedom of movement*'}                                                            | ${'The commoner is a 16th-level spellcaster. Its spellcasting ability is Wisdom (spell save DC 18, +10 to hit with spell attacks). The commoner has the following ranger spells prepared:\n\n1st level (4 slots): <em>animal friendship</em>, <em>hunter\'s mark</em>, <em>speak with animals</em>\n2nd level (3 slots): <em>lesser restoration</em>, <em>silence</em>\n3rd level (3 slots): <em>conjure animals</em>, <em>speak with plants</em>\n4th level (2 slots): <em>conjure woodland beings</em>, <em>freedom of movement</em>'}
      ${'Level 17 Ranger'} | ${17} | ${20}        | ${6}             | ${['Animal Friendship', 'Hunter\'s Mark', 'Speak with Animals']} | ${['Lesser Restoration', 'Silence']} | ${['Conjure Animals', 'Speak with Plants']} | ${['Conjure Woodland Beings', 'Freedom of Movement']} | ${['Tree Stride']}                        | ${'[name] is a 17th-level spellcaster. Its spellcasting ability is Wisdom (spell save DC sdc[wis], atk[wis] to hit with spell attacks). [name] has the following ranger spells prepared:\n\n1st level (4 slots): *animal friendship*, *hunter\'s mark*, *speak with animals*\n2nd level (3 slots): *lesser restoration*, *silence*\n3rd level (3 slots): *conjure animals*, *speak with plants*\n4th level (3 slots): *conjure woodland beings*, *freedom of movement*\n5th level (1 slot): *tree stride*'}                         | ${'The commoner is a 17th-level spellcaster. Its spellcasting ability is Wisdom (spell save DC 19, +11 to hit with spell attacks). The commoner has the following ranger spells prepared:\n\n1st level (4 slots): <em>animal friendship</em>, <em>hunter\'s mark</em>, <em>speak with animals</em>\n2nd level (3 slots): <em>lesser restoration</em>, <em>silence</em>\n3rd level (3 slots): <em>conjure animals</em>, <em>speak with plants</em>\n4th level (3 slots): <em>conjure woodland beings</em>, <em>freedom of movement</em>\n5th level (1 slot): <em>tree stride</em>'}
      ${'Level 18 Ranger'} | ${18} | ${20}        | ${6}             | ${['Animal Friendship', 'Hunter\'s Mark', 'Speak with Animals']} | ${['Lesser Restoration', 'Silence']} | ${['Conjure Animals', 'Speak with Plants']} | ${['Conjure Woodland Beings', 'Freedom of Movement']} | ${['Tree Stride']}                        | ${'[name] is a 18th-level spellcaster. Its spellcasting ability is Wisdom (spell save DC sdc[wis], atk[wis] to hit with spell attacks). [name] has the following ranger spells prepared:\n\n1st level (4 slots): *animal friendship*, *hunter\'s mark*, *speak with animals*\n2nd level (3 slots): *lesser restoration*, *silence*\n3rd level (3 slots): *conjure animals*, *speak with plants*\n4th level (3 slots): *conjure woodland beings*, *freedom of movement*\n5th level (1 slot): *tree stride*'}                         | ${'The commoner is a 18th-level spellcaster. Its spellcasting ability is Wisdom (spell save DC 19, +11 to hit with spell attacks). The commoner has the following ranger spells prepared:\n\n1st level (4 slots): <em>animal friendship</em>, <em>hunter\'s mark</em>, <em>speak with animals</em>\n2nd level (3 slots): <em>lesser restoration</em>, <em>silence</em>\n3rd level (3 slots): <em>conjure animals</em>, <em>speak with plants</em>\n4th level (3 slots): <em>conjure woodland beings</em>, <em>freedom of movement</em>\n5th level (1 slot): <em>tree stride</em>'}
      ${'Level 19 Ranger'} | ${19} | ${22}        | ${6}             | ${['Animal Friendship', 'Hunter\'s Mark', 'Speak with Animals']} | ${['Lesser Restoration', 'Silence']} | ${['Conjure Animals', 'Speak with Plants']} | ${['Conjure Woodland Beings', 'Freedom of Movement']} | ${['Commune with Nature', 'Tree Stride']} | ${'[name] is a 19th-level spellcaster. Its spellcasting ability is Wisdom (spell save DC sdc[wis], atk[wis] to hit with spell attacks). [name] has the following ranger spells prepared:\n\n1st level (4 slots): *animal friendship*, *hunter\'s mark*, *speak with animals*\n2nd level (3 slots): *lesser restoration*, *silence*\n3rd level (3 slots): *conjure animals*, *speak with plants*\n4th level (3 slots): *conjure woodland beings*, *freedom of movement*\n5th level (2 slots): *commune with nature*, *tree stride*'} | ${'The commoner is a 19th-level spellcaster. Its spellcasting ability is Wisdom (spell save DC 20, +12 to hit with spell attacks). The commoner has the following ranger spells prepared:\n\n1st level (4 slots): <em>animal friendship</em>, <em>hunter\'s mark</em>, <em>speak with animals</em>\n2nd level (3 slots): <em>lesser restoration</em>, <em>silence</em>\n3rd level (3 slots): <em>conjure animals</em>, <em>speak with plants</em>\n4th level (3 slots): <em>conjure woodland beings</em>, <em>freedom of movement</em>\n5th level (2 slots): <em>commune with nature</em>, <em>tree stride</em>'}
      ${'Level 20 Ranger'} | ${20} | ${22}        | ${6}             | ${['Animal Friendship', 'Hunter\'s Mark', 'Speak with Animals']} | ${['Lesser Restoration', 'Silence']} | ${['Conjure Animals', 'Speak with Plants']} | ${['Conjure Woodland Beings', 'Freedom of Movement']} | ${['Commune with Nature', 'Tree Stride']} | ${'[name] is a 20th-level spellcaster. Its spellcasting ability is Wisdom (spell save DC sdc[wis], atk[wis] to hit with spell attacks). [name] has the following ranger spells prepared:\n\n1st level (4 slots): *animal friendship*, *hunter\'s mark*, *speak with animals*\n2nd level (3 slots): *lesser restoration*, *silence*\n3rd level (3 slots): *conjure animals*, *speak with plants*\n4th level (3 slots): *conjure woodland beings*, *freedom of movement*\n5th level (2 slots): *commune with nature*, *tree stride*'} | ${'The commoner is a 20th-level spellcaster. Its spellcasting ability is Wisdom (spell save DC 20, +12 to hit with spell attacks). The commoner has the following ranger spells prepared:\n\n1st level (4 slots): <em>animal friendship</em>, <em>hunter\'s mark</em>, <em>speak with animals</em>\n2nd level (3 slots): <em>lesser restoration</em>, <em>silence</em>\n3rd level (3 slots): <em>conjure animals</em>, <em>speak with plants</em>\n4th level (3 slots): <em>conjure woodland beings</em>, <em>freedom of movement</em>\n5th level (2 slots): <em>commune with nature</em>, <em>tree stride</em>'}
    `
    ('$description',
    ({level, abilityScore, proficiencyBonus, level1Spells, level2Spells, level3Spells, level4Spells, level5Spells, expectedGeneratedText, expectedRenderedText}) => {
      const abilityName = 'wisdom';

      abilitiesModel.abilities[abilityName].score = abilityScore;
      challengeRatingModel.proficiencyBonus = proficiencyBonus;

      const spellcastingModel = new Spellcasting();
      spellcastingModel.spellcasterType = 'ranger';
      spellcastingModel.spellcasterAbility = abilityName;
      spellcastingModel.spellcasterLevel = level;

      for (let spellLevel = 1; spellLevel <= 5; spellLevel++) {
        spellcastingModel.spellCategories[spellLevel].spells = eval(`level${spellLevel}Spells`);
      }

      setDialogControls(spellcastingModel);

      verifyDialogModel(spellcastingModel, expectedGeneratedText);
      verifyDialogControls(spellcastingModel, expectedRenderedText);

      generateSpellcastingDialog.generateSpellcastingButton.click();

      verifySpecialTraitBlocks(spellcastingModel.spellcasterType, expectedGeneratedText, expectedRenderedText);
    });
    /* eslint-enable indent, no-unexpected-multiline, no-unused-vars */
  });

  describe('and the dialog is submitted for a sorcerer spellcaster, it should add a new spellcasting block under special traits', () => {
    // TODO
  });

  describe('and the dialog is submitted for a warlock spellcaster, it should add a new spellcasting block under special traits', () => {
    /* eslint-disable indent, no-unexpected-multiline, no-unused-vars */
    it.each
    `
      description           | level | abilityScore | proficiencyBonus | cantrips                                                              | level1Spells                                                    | level2Spells                                                      | level3Spells                                                        | level4Spells                                                           | level5Spells                                                   | level6Spells         | level7Spells     | level8Spells     | level9Spells        | expectedGeneratedText                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           | expectedRenderedText
      ${'Level 1 Warlock'}  | ${1}  | ${12}        | ${2}             | ${['Eldritch Blast', 'True Strike']}                                  | ${['Expeditious Retreat', 'Hellish Rebuke']}                    | ${[]}                                                             | ${[]}                                                               | ${[]}                                                                  | ${[]}                                                          | ${[]}                | ${[]}            | ${[]}            | ${[]}               | ${'[name] is a 1st-level spellcaster. Its spellcasting ability is Charisma (spell save DC sdc[cha], atk[cha] to hit with spell attacks). [name] has the following warlock spells prepared:\n\nCantrips (at will): *eldritch blast*, *true strike*\n1st level (1 slot): *expeditious retreat*, *hellish rebuke*'}                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                | ${'The commoner is a 1st-level spellcaster. Its spellcasting ability is Charisma (spell save DC 11, +3 to hit with spell attacks). The commoner has the following warlock spells prepared:\n\nCantrips (at will): <em>eldritch blast</em>, <em>true strike</em>\n1st level (1 slot): <em>expeditious retreat</em>, <em>hellish rebuke</em>'}
      ${'Level 2 Warlock'}  | ${2}  | ${12}        | ${2}             | ${['Eldritch Blast', 'True Strike']}                                  | ${['Expeditious Retreat', 'Hellish Rebuke', 'Illusory Script']} | ${[]}                                                             | ${[]}                                                               | ${[]}                                                                  | ${[]}                                                          | ${[]}                | ${[]}            | ${[]}            | ${[]}               | ${'[name] is a 2nd-level spellcaster. Its spellcasting ability is Charisma (spell save DC sdc[cha], atk[cha] to hit with spell attacks). [name] has the following warlock spells prepared:\n\nCantrips (at will): *eldritch blast*, *true strike*\n1st level (2 slots): *expeditious retreat*, *hellish rebuke*, *illusory script*'}                                                                                                                                                                                                                                                                                                                                                                                                                                                                            | ${'The commoner is a 2nd-level spellcaster. Its spellcasting ability is Charisma (spell save DC 11, +3 to hit with spell attacks). The commoner has the following warlock spells prepared:\n\nCantrips (at will): <em>eldritch blast</em>, <em>true strike</em>\n1st level (2 slots): <em>expeditious retreat</em>, <em>hellish rebuke</em>, <em>illusory script</em>'}
      ${'Level 3 Warlock'}  | ${3}  | ${12}        | ${2}             | ${['Eldritch Blast', 'True Strike']}                                  | ${['Hellish Rebuke', 'Illusory Script']}                        | ${['Darkness', 'Ray of Enfeeblement']}                            | ${[]}                                                               | ${[]}                                                                  | ${[]}                                                          | ${[]}                | ${[]}            | ${[]}            | ${[]}               | ${'[name] is a 3rd-level spellcaster. Its spellcasting ability is Charisma (spell save DC sdc[cha], atk[cha] to hit with spell attacks). [name] has the following warlock spells prepared:\n\nCantrips (at will): *eldritch blast*, *true strike*\n1st level (0 slots): *hellish rebuke*, *illusory script*\n2nd level (2 slots): *darkness*, *ray of enfeeblement*'}                                                                                                                                                                                                                                                                                                                                                                                                                                           | ${'The commoner is a 3rd-level spellcaster. Its spellcasting ability is Charisma (spell save DC 11, +3 to hit with spell attacks). The commoner has the following warlock spells prepared:\n\nCantrips (at will): <em>eldritch blast</em>, <em>true strike</em>\n1st level (0 slots): <em>hellish rebuke</em>, <em>illusory script</em>\n2nd level (2 slots): <em>darkness</em>, <em>ray of enfeeblement</em>'}
      ${'Level 4 Warlock'}  | ${4}  | ${14}        | ${2}             | ${['Eldritch Blast', 'Minor Illusion', 'True Strike']}                | ${['Hellish Rebuke']}                                           | ${['Darkness', 'Ray of Enfeeblement', 'Shatter', 'Spider Climb']} | ${[]}                                                               | ${[]}                                                                  | ${[]}                                                          | ${[]}                | ${[]}            | ${[]}            | ${[]}               | ${'[name] is a 4th-level spellcaster. Its spellcasting ability is Charisma (spell save DC sdc[cha], atk[cha] to hit with spell attacks). [name] has the following warlock spells prepared:\n\nCantrips (at will): *eldritch blast*, *minor illusion*, *true strike*\n1st level (0 slots): *hellish rebuke*\n2nd level (2 slots): *darkness*, *ray of enfeeblement*, *shatter*, *spider climb*'}                                                                                                                                                                                                                                                                                                                                                                                                                 | ${'The commoner is a 4th-level spellcaster. Its spellcasting ability is Charisma (spell save DC 12, +4 to hit with spell attacks). The commoner has the following warlock spells prepared:\n\nCantrips (at will): <em>eldritch blast</em>, <em>minor illusion</em>, <em>true strike</em>\n1st level (0 slots): <em>hellish rebuke</em>\n2nd level (2 slots): <em>darkness</em>, <em>ray of enfeeblement</em>, <em>shatter</em>, <em>spider climb</em>'}
      ${'Level 5 Warlock'}  | ${5}  | ${14}        | ${3}             | ${['Eldritch Blast', 'Minor Illusion', 'True Strike']}                | ${['Hellish Rebuke']}                                           | ${['Darkness', 'Ray of Enfeeblement', 'Shatter']}                 | ${['Major Image', 'Vampiric Touch']}                                | ${[]}                                                                  | ${[]}                                                          | ${[]}                | ${[]}            | ${[]}            | ${[]}               | ${'[name] is a 5th-level spellcaster. Its spellcasting ability is Charisma (spell save DC sdc[cha], atk[cha] to hit with spell attacks). [name] has the following warlock spells prepared:\n\nCantrips (at will): *eldritch blast*, *minor illusion*, *true strike*\n1st level (0 slots): *hellish rebuke*\n2nd level (0 slots): *darkness*, *ray of enfeeblement*, *shatter*\n3rd level (2 slots): *major image*, *vampiric touch*'}                                                                                                                                                                                                                                                                                                                                                                           | ${'The commoner is a 5th-level spellcaster. Its spellcasting ability is Charisma (spell save DC 13, +5 to hit with spell attacks). The commoner has the following warlock spells prepared:\n\nCantrips (at will): <em>eldritch blast</em>, <em>minor illusion</em>, <em>true strike</em>\n1st level (0 slots): <em>hellish rebuke</em>\n2nd level (0 slots): <em>darkness</em>, <em>ray of enfeeblement</em>, <em>shatter</em>\n3rd level (2 slots): <em>major image</em>, <em>vampiric touch</em>'}
      ${'Level 6 Warlock'}  | ${6}  | ${14}        | ${3}             | ${['Eldritch Blast', 'Minor Illusion', 'True Strike']}                | ${['Hellish Rebuke']}                                           | ${['Darkness', 'Shatter']}                                        | ${['Hold Person', 'Magic Circle', 'Major Image', 'Vampiric Touch']} | ${[]}                                                                  | ${[]}                                                          | ${[]}                | ${[]}            | ${[]}            | ${[]}               | ${'[name] is a 6th-level spellcaster. Its spellcasting ability is Charisma (spell save DC sdc[cha], atk[cha] to hit with spell attacks). [name] has the following warlock spells prepared:\n\nCantrips (at will): *eldritch blast*, *minor illusion*, *true strike*\n1st level (0 slots): *hellish rebuke*\n2nd level (0 slots): *darkness*, *shatter*\n3rd level (2 slots): *hold person*, *magic circle*, *major image*, *vampiric touch*'}                                                                                                                                                                                                                                                                                                                                                                   | ${'The commoner is a 6th-level spellcaster. Its spellcasting ability is Charisma (spell save DC 13, +5 to hit with spell attacks). The commoner has the following warlock spells prepared:\n\nCantrips (at will): <em>eldritch blast</em>, <em>minor illusion</em>, <em>true strike</em>\n1st level (0 slots): <em>hellish rebuke</em>\n2nd level (0 slots): <em>darkness</em>, <em>shatter</em>\n3rd level (2 slots): <em>hold person</em>, <em>magic circle</em>, <em>major image</em>, <em>vampiric touch</em>'}
      ${'Level 7 Warlock'}  | ${7}  | ${14}        | ${3}             | ${['Eldritch Blast', 'Minor Illusion', 'True Strike']}                | ${['Hellish Rebuke']}                                           | ${['Darkness', 'Shatter']}                                        | ${['Hold Person', 'Major Image', 'Vampiric Touch']}                 | ${['Dimension Door', 'Hallucinatory Terrain']}                         | ${[]}                                                          | ${[]}                | ${[]}            | ${[]}            | ${[]}               | ${'[name] is a 7th-level spellcaster. Its spellcasting ability is Charisma (spell save DC sdc[cha], atk[cha] to hit with spell attacks). [name] has the following warlock spells prepared:\n\nCantrips (at will): *eldritch blast*, *minor illusion*, *true strike*\n1st level (0 slots): *hellish rebuke*\n2nd level (0 slots): *darkness*, *shatter*\n3rd level (0 slots): *hold person*, *major image*, *vampiric touch*\n4th level (2 slots): *dimension door*, *hallucinatory terrain*'}                                                                                                                                                                                                                                                                                                                   | ${'The commoner is a 7th-level spellcaster. Its spellcasting ability is Charisma (spell save DC 13, +5 to hit with spell attacks). The commoner has the following warlock spells prepared:\n\nCantrips (at will): <em>eldritch blast</em>, <em>minor illusion</em>, <em>true strike</em>\n1st level (0 slots): <em>hellish rebuke</em>\n2nd level (0 slots): <em>darkness</em>, <em>shatter</em>\n3rd level (0 slots): <em>hold person</em>, <em>major image</em>, <em>vampiric touch</em>\n4th level (2 slots): <em>dimension door</em>, <em>hallucinatory terrain</em>'}
      ${'Level 8 Warlock'}  | ${8}  | ${16}        | ${3}             | ${['Eldritch Blast', 'Minor Illusion', 'True Strike']}                | ${[]}                                                           | ${['Darkness', 'Shatter']}                                        | ${['Hold Person', 'Major Image', 'Vampiric Touch']}                 | ${['Banishment', 'Blight', 'Dimension Door', 'Hallucinatory Terrain']} | ${[]}                                                          | ${[]}                | ${[]}            | ${[]}            | ${[]}               | ${'[name] is a 8th-level spellcaster. Its spellcasting ability is Charisma (spell save DC sdc[cha], atk[cha] to hit with spell attacks). [name] has the following warlock spells prepared:\n\nCantrips (at will): *eldritch blast*, *minor illusion*, *true strike*\n2nd level (0 slots): *darkness*, *shatter*\n3rd level (0 slots): *hold person*, *major image*, *vampiric touch*\n4th level (2 slots): *banishment*, *blight*, *dimension door*, *hallucinatory terrain*'}                                                                                                                                                                                                                                                                                                                                  | ${'The commoner is a 8th-level spellcaster. Its spellcasting ability is Charisma (spell save DC 14, +6 to hit with spell attacks). The commoner has the following warlock spells prepared:\n\nCantrips (at will): <em>eldritch blast</em>, <em>minor illusion</em>, <em>true strike</em>\n2nd level (0 slots): <em>darkness</em>, <em>shatter</em>\n3rd level (0 slots): <em>hold person</em>, <em>major image</em>, <em>vampiric touch</em>\n4th level (2 slots): <em>banishment</em>, <em>blight</em>, <em>dimension door</em>, <em>hallucinatory terrain</em>'}
      ${'Level 9 Warlock'}  | ${9}  | ${16}        | ${4}             | ${['Eldritch Blast', 'Minor Illusion', 'True Strike']}                | ${[]}                                                           | ${['Darkness', 'Shatter']}                                        | ${['Hold Person', 'Major Image']}                                   | ${['Banishment', 'Blight', 'Dimension Door', 'Hallucinatory Terrain']} | ${['Dream', 'Scrying']}                                        | ${[]}                | ${[]}            | ${[]}            | ${[]}               | ${'[name] is a 9th-level spellcaster. Its spellcasting ability is Charisma (spell save DC sdc[cha], atk[cha] to hit with spell attacks). [name] has the following warlock spells prepared:\n\nCantrips (at will): *eldritch blast*, *minor illusion*, *true strike*\n2nd level (0 slots): *darkness*, *shatter*\n3rd level (0 slots): *hold person*, *major image*\n4th level (0 slots): *banishment*, *blight*, *dimension door*, *hallucinatory terrain*\n5th level (2 slots): *dream*, *scrying*'}                                                                                                                                                                                                                                                                                                           | ${'The commoner is a 9th-level spellcaster. Its spellcasting ability is Charisma (spell save DC 15, +7 to hit with spell attacks). The commoner has the following warlock spells prepared:\n\nCantrips (at will): <em>eldritch blast</em>, <em>minor illusion</em>, <em>true strike</em>\n2nd level (0 slots): <em>darkness</em>, <em>shatter</em>\n3rd level (0 slots): <em>hold person</em>, <em>major image</em>\n4th level (0 slots): <em>banishment</em>, <em>blight</em>, <em>dimension door</em>, <em>hallucinatory terrain</em>\n5th level (2 slots): <em>dream</em>, <em>scrying</em>'}
      ${'Level 10 Warlock'} | ${10} | ${16}        | ${4}             | ${['Chill Touch', 'Eldritch Blast', 'Minor Illusion', 'True Strike']} | ${[]}                                                           | ${['Shatter']}                                                    | ${['Hold Person', 'Major Image']}                                   | ${['Banishment', 'Blight', 'Dimension Door', 'Hallucinatory Terrain']} | ${['Dream', 'Hold Monster', 'Scrying']}                        | ${[]}                | ${[]}            | ${[]}            | ${[]}               | ${'[name] is a 10th-level spellcaster. Its spellcasting ability is Charisma (spell save DC sdc[cha], atk[cha] to hit with spell attacks). [name] has the following warlock spells prepared:\n\nCantrips (at will): *chill touch*, *eldritch blast*, *minor illusion*, *true strike*\n2nd level (0 slots): *shatter*\n3rd level (0 slots): *hold person*, *major image*\n4th level (0 slots): *banishment*, *blight*, *dimension door*, *hallucinatory terrain*\n5th level (2 slots): *dream*, *hold monster*, *scrying*'}                                                                                                                                                                                                                                                                                       | ${'The commoner is a 10th-level spellcaster. Its spellcasting ability is Charisma (spell save DC 15, +7 to hit with spell attacks). The commoner has the following warlock spells prepared:\n\nCantrips (at will): <em>chill touch</em>, <em>eldritch blast</em>, <em>minor illusion</em>, <em>true strike</em>\n2nd level (0 slots): <em>shatter</em>\n3rd level (0 slots): <em>hold person</em>, <em>major image</em>\n4th level (0 slots): <em>banishment</em>, <em>blight</em>, <em>dimension door</em>, <em>hallucinatory terrain</em>\n5th level (2 slots): <em>dream</em>, <em>hold monster</em>, <em>scrying</em>'}
      ${'Level 11 Warlock'} | ${11} | ${16}        | ${4}             | ${['Chill Touch', 'Eldritch Blast', 'Minor Illusion', 'True Strike']} | ${[]}                                                           | ${['Shatter']}                                                    | ${['Hold Person', 'Major Image']}                                   | ${['Banishment', 'Blight', 'Dimension Door', 'Hallucinatory Terrain']} | ${['Contact Other Plane', 'Dream', 'Hold Monster', 'Scrying']} | ${['Create Undead']} | ${[]}            | ${[]}            | ${[]}               | ${'[name] is a 11th-level spellcaster. Its spellcasting ability is Charisma (spell save DC sdc[cha], atk[cha] to hit with spell attacks). [name] has the following warlock spells prepared:\n\nCantrips (at will): *chill touch*, *eldritch blast*, *minor illusion*, *true strike*\n2nd level (0 slots): *shatter*\n3rd level (0 slots): *hold person*, *major image*\n4th level (0 slots): *banishment*, *blight*, *dimension door*, *hallucinatory terrain*\n5th level (3 slots): *contact other plane*, *dream*, *hold monster*, *scrying*\n6th level (1/long rest): *create undead*'}                                                                                                                                                                                                                      | ${'The commoner is a 11th-level spellcaster. Its spellcasting ability is Charisma (spell save DC 15, +7 to hit with spell attacks). The commoner has the following warlock spells prepared:\n\nCantrips (at will): <em>chill touch</em>, <em>eldritch blast</em>, <em>minor illusion</em>, <em>true strike</em>\n2nd level (0 slots): <em>shatter</em>\n3rd level (0 slots): <em>hold person</em>, <em>major image</em>\n4th level (0 slots): <em>banishment</em>, <em>blight</em>, <em>dimension door</em>, <em>hallucinatory terrain</em>\n5th level (3 slots): <em>contact other plane</em>, <em>dream</em>, <em>hold monster</em>, <em>scrying</em>\n6th level (1/long rest): <em>create undead</em>'}
      ${'Level 12 Warlock'} | ${12} | ${18}        | ${4}             | ${['Chill Touch', 'Eldritch Blast', 'Minor Illusion', 'True Strike']} | ${[]}                                                           | ${['Shatter']}                                                    | ${['Hold Person', 'Major Image']}                                   | ${['Banishment', 'Blight', 'Dimension Door', 'Hallucinatory Terrain']} | ${['Contact Other Plane', 'Dream', 'Hold Monster', 'Scrying']} | ${['Create Undead']} | ${[]}            | ${[]}            | ${[]}               | ${'[name] is a 12th-level spellcaster. Its spellcasting ability is Charisma (spell save DC sdc[cha], atk[cha] to hit with spell attacks). [name] has the following warlock spells prepared:\n\nCantrips (at will): *chill touch*, *eldritch blast*, *minor illusion*, *true strike*\n2nd level (0 slots): *shatter*\n3rd level (0 slots): *hold person*, *major image*\n4th level (0 slots): *banishment*, *blight*, *dimension door*, *hallucinatory terrain*\n5th level (3 slots): *contact other plane*, *dream*, *hold monster*, *scrying*\n6th level (1/long rest): *create undead*'}                                                                                                                                                                                                                      | ${'The commoner is a 12th-level spellcaster. Its spellcasting ability is Charisma (spell save DC 16, +8 to hit with spell attacks). The commoner has the following warlock spells prepared:\n\nCantrips (at will): <em>chill touch</em>, <em>eldritch blast</em>, <em>minor illusion</em>, <em>true strike</em>\n2nd level (0 slots): <em>shatter</em>\n3rd level (0 slots): <em>hold person</em>, <em>major image</em>\n4th level (0 slots): <em>banishment</em>, <em>blight</em>, <em>dimension door</em>, <em>hallucinatory terrain</em>\n5th level (3 slots): <em>contact other plane</em>, <em>dream</em>, <em>hold monster</em>, <em>scrying</em>\n6th level (1/long rest): <em>create undead</em>'}
      ${'Level 13 Warlock'} | ${13} | ${18}        | ${5}             | ${['Chill Touch', 'Eldritch Blast', 'Minor Illusion', 'True Strike']} | ${[]}                                                           | ${['Shatter']}                                                    | ${['Hold Person', 'Major Image', 'Vampiric Touch']}                 | ${['Banishment', 'Blight', 'Dimension Door', 'Hallucinatory Terrain']} | ${['Contact Other Plane', 'Dream', 'Hold Monster', 'Scrying']} | ${['Create Undead']} | ${['Forcecage']} | ${[]}            | ${[]}               | ${'[name] is a 13th-level spellcaster. Its spellcasting ability is Charisma (spell save DC sdc[cha], atk[cha] to hit with spell attacks). [name] has the following warlock spells prepared:\n\nCantrips (at will): *chill touch*, *eldritch blast*, *minor illusion*, *true strike*\n2nd level (0 slots): *shatter*\n3rd level (0 slots): *hold person*, *major image*, *vampiric touch*\n4th level (0 slots): *banishment*, *blight*, *dimension door*, *hallucinatory terrain*\n5th level (3 slots): *contact other plane*, *dream*, *hold monster*, *scrying*\n6th level (1/long rest): *create undead*\n7th level (1/long rest): *forcecage*'}                                                                                                                                                              | ${'The commoner is a 13th-level spellcaster. Its spellcasting ability is Charisma (spell save DC 17, +9 to hit with spell attacks). The commoner has the following warlock spells prepared:\n\nCantrips (at will): <em>chill touch</em>, <em>eldritch blast</em>, <em>minor illusion</em>, <em>true strike</em>\n2nd level (0 slots): <em>shatter</em>\n3rd level (0 slots): <em>hold person</em>, <em>major image</em>, <em>vampiric touch</em>\n4th level (0 slots): <em>banishment</em>, <em>blight</em>, <em>dimension door</em>, <em>hallucinatory terrain</em>\n5th level (3 slots): <em>contact other plane</em>, <em>dream</em>, <em>hold monster</em>, <em>scrying</em>\n6th level (1/long rest): <em>create undead</em>\n7th level (1/long rest): <em>forcecage</em>'}
      ${'Level 14 Warlock'} | ${14} | ${18}        | ${5}             | ${['Chill Touch', 'Eldritch Blast', 'Minor Illusion', 'True Strike']} | ${[]}                                                           | ${['Shatter']}                                                    | ${['Hold Person', 'Major Image', 'Vampiric Touch']}                 | ${['Banishment', 'Blight', 'Dimension Door', 'Hallucinatory Terrain']} | ${['Contact Other Plane', 'Dream', 'Hold Monster', 'Scrying']} | ${['Create Undead']} | ${['Forcecage']} | ${[]}            | ${[]}               | ${'[name] is a 14th-level spellcaster. Its spellcasting ability is Charisma (spell save DC sdc[cha], atk[cha] to hit with spell attacks). [name] has the following warlock spells prepared:\n\nCantrips (at will): *chill touch*, *eldritch blast*, *minor illusion*, *true strike*\n2nd level (0 slots): *shatter*\n3rd level (0 slots): *hold person*, *major image*, *vampiric touch*\n4th level (0 slots): *banishment*, *blight*, *dimension door*, *hallucinatory terrain*\n5th level (3 slots): *contact other plane*, *dream*, *hold monster*, *scrying*\n6th level (1/long rest): *create undead*\n7th level (1/long rest): *forcecage*'}                                                                                                                                                              | ${'The commoner is a 14th-level spellcaster. Its spellcasting ability is Charisma (spell save DC 17, +9 to hit with spell attacks). The commoner has the following warlock spells prepared:\n\nCantrips (at will): <em>chill touch</em>, <em>eldritch blast</em>, <em>minor illusion</em>, <em>true strike</em>\n2nd level (0 slots): <em>shatter</em>\n3rd level (0 slots): <em>hold person</em>, <em>major image</em>, <em>vampiric touch</em>\n4th level (0 slots): <em>banishment</em>, <em>blight</em>, <em>dimension door</em>, <em>hallucinatory terrain</em>\n5th level (3 slots): <em>contact other plane</em>, <em>dream</em>, <em>hold monster</em>, <em>scrying</em>\n6th level (1/long rest): <em>create undead</em>\n7th level (1/long rest): <em>forcecage</em>'}
      ${'Level 15 Warlock'} | ${15} | ${18}        | ${5}             | ${['Chill Touch', 'Eldritch Blast', 'Minor Illusion', 'True Strike']} | ${[]}                                                           | ${['Shatter']}                                                    | ${['Hold Person', 'Magic Circle', 'Major Image', 'Vampiric Touch']} | ${['Banishment', 'Blight', 'Dimension Door', 'Hallucinatory Terrain']} | ${['Contact Other Plane', 'Dream', 'Hold Monster', 'Scrying']} | ${['Create Undead']} | ${['Forcecage']} | ${['Demiplane']} | ${[]}               | ${'[name] is a 15th-level spellcaster. Its spellcasting ability is Charisma (spell save DC sdc[cha], atk[cha] to hit with spell attacks). [name] has the following warlock spells prepared:\n\nCantrips (at will): *chill touch*, *eldritch blast*, *minor illusion*, *true strike*\n2nd level (0 slots): *shatter*\n3rd level (0 slots): *hold person*, *magic circle*, *major image*, *vampiric touch*\n4th level (0 slots): *banishment*, *blight*, *dimension door*, *hallucinatory terrain*\n5th level (3 slots): *contact other plane*, *dream*, *hold monster*, *scrying*\n6th level (1/long rest): *create undead*\n7th level (1/long rest): *forcecage*\n8th level (1/long rest): *demiplane*'}                                                                                                        | ${'The commoner is a 15th-level spellcaster. Its spellcasting ability is Charisma (spell save DC 17, +9 to hit with spell attacks). The commoner has the following warlock spells prepared:\n\nCantrips (at will): <em>chill touch</em>, <em>eldritch blast</em>, <em>minor illusion</em>, <em>true strike</em>\n2nd level (0 slots): <em>shatter</em>\n3rd level (0 slots): <em>hold person</em>, <em>magic circle</em>, <em>major image</em>, <em>vampiric touch</em>\n4th level (0 slots): <em>banishment</em>, <em>blight</em>, <em>dimension door</em>, <em>hallucinatory terrain</em>\n5th level (3 slots): <em>contact other plane</em>, <em>dream</em>, <em>hold monster</em>, <em>scrying</em>\n6th level (1/long rest): <em>create undead</em>\n7th level (1/long rest): <em>forcecage</em>\n8th level (1/long rest): <em>demiplane</em>'}
      ${'Level 16 Warlock'} | ${16} | ${20}        | ${5}             | ${['Chill Touch', 'Eldritch Blast', 'Minor Illusion', 'True Strike']} | ${[]}                                                           | ${['Shatter']}                                                    | ${['Hold Person', 'Magic Circle', 'Major Image', 'Vampiric Touch']} | ${['Banishment', 'Blight', 'Dimension Door', 'Hallucinatory Terrain']} | ${['Contact Other Plane', 'Dream', 'Hold Monster', 'Scrying']} | ${['Create Undead']} | ${['Forcecage']} | ${['Demiplane']} | ${[]}               | ${'[name] is a 16th-level spellcaster. Its spellcasting ability is Charisma (spell save DC sdc[cha], atk[cha] to hit with spell attacks). [name] has the following warlock spells prepared:\n\nCantrips (at will): *chill touch*, *eldritch blast*, *minor illusion*, *true strike*\n2nd level (0 slots): *shatter*\n3rd level (0 slots): *hold person*, *magic circle*, *major image*, *vampiric touch*\n4th level (0 slots): *banishment*, *blight*, *dimension door*, *hallucinatory terrain*\n5th level (3 slots): *contact other plane*, *dream*, *hold monster*, *scrying*\n6th level (1/long rest): *create undead*\n7th level (1/long rest): *forcecage*\n8th level (1/long rest): *demiplane*'}                                                                                                        | ${'The commoner is a 16th-level spellcaster. Its spellcasting ability is Charisma (spell save DC 18, +10 to hit with spell attacks). The commoner has the following warlock spells prepared:\n\nCantrips (at will): <em>chill touch</em>, <em>eldritch blast</em>, <em>minor illusion</em>, <em>true strike</em>\n2nd level (0 slots): <em>shatter</em>\n3rd level (0 slots): <em>hold person</em>, <em>magic circle</em>, <em>major image</em>, <em>vampiric touch</em>\n4th level (0 slots): <em>banishment</em>, <em>blight</em>, <em>dimension door</em>, <em>hallucinatory terrain</em>\n5th level (3 slots): <em>contact other plane</em>, <em>dream</em>, <em>hold monster</em>, <em>scrying</em>\n6th level (1/long rest): <em>create undead</em>\n7th level (1/long rest): <em>forcecage</em>\n8th level (1/long rest): <em>demiplane</em>'}
      ${'Level 17 Warlock'} | ${17} | ${20}        | ${6}             | ${['Chill Touch', 'Eldritch Blast', 'Minor Illusion', 'True Strike']} | ${[]}                                                           | ${['Ray of Enfeeblement', 'Shatter']}                             | ${['Hold Person', 'Magic Circle', 'Major Image', 'Vampiric Touch']} | ${['Banishment', 'Blight', 'Dimension Door', 'Hallucinatory Terrain']} | ${['Contact Other Plane', 'Dream', 'Hold Monster', 'Scrying']} | ${['Create Undead']} | ${['Forcecage']} | ${['Demiplane']} | ${['Imprisonment']} | ${'[name] is a 17th-level spellcaster. Its spellcasting ability is Charisma (spell save DC sdc[cha], atk[cha] to hit with spell attacks). [name] has the following warlock spells prepared:\n\nCantrips (at will): *chill touch*, *eldritch blast*, *minor illusion*, *true strike*\n2nd level (0 slots): *ray of enfeeblement*, *shatter*\n3rd level (0 slots): *hold person*, *magic circle*, *major image*, *vampiric touch*\n4th level (0 slots): *banishment*, *blight*, *dimension door*, *hallucinatory terrain*\n5th level (4 slots): *contact other plane*, *dream*, *hold monster*, *scrying*\n6th level (1/long rest): *create undead*\n7th level (1/long rest): *forcecage*\n8th level (1/long rest): *demiplane*\n9th level (1/long rest): *imprisonment*'}                                        | ${'The commoner is a 17th-level spellcaster. Its spellcasting ability is Charisma (spell save DC 19, +11 to hit with spell attacks). The commoner has the following warlock spells prepared:\n\nCantrips (at will): <em>chill touch</em>, <em>eldritch blast</em>, <em>minor illusion</em>, <em>true strike</em>\n2nd level (0 slots): <em>ray of enfeeblement</em>, <em>shatter</em>\n3rd level (0 slots): <em>hold person</em>, <em>magic circle</em>, <em>major image</em>, <em>vampiric touch</em>\n4th level (0 slots): <em>banishment</em>, <em>blight</em>, <em>dimension door</em>, <em>hallucinatory terrain</em>\n5th level (4 slots): <em>contact other plane</em>, <em>dream</em>, <em>hold monster</em>, <em>scrying</em>\n6th level (1/long rest): <em>create undead</em>\n7th level (1/long rest): <em>forcecage</em>\n8th level (1/long rest): <em>demiplane</em>\n9th level (1/long rest): <em>imprisonment</em>'}
      ${'Level 18 Warlock'} | ${18} | ${20}        | ${6}             | ${['Chill Touch', 'Eldritch Blast', 'Minor Illusion', 'True Strike']} | ${[]}                                                           | ${['Ray of Enfeeblement', 'Shatter']}                             | ${['Hold Person', 'Magic Circle', 'Major Image', 'Vampiric Touch']} | ${['Banishment', 'Blight', 'Dimension Door', 'Hallucinatory Terrain']} | ${['Contact Other Plane', 'Dream', 'Hold Monster', 'Scrying']} | ${['Create Undead']} | ${['Forcecage']} | ${['Demiplane']} | ${['Imprisonment']} | ${'[name] is a 18th-level spellcaster. Its spellcasting ability is Charisma (spell save DC sdc[cha], atk[cha] to hit with spell attacks). [name] has the following warlock spells prepared:\n\nCantrips (at will): *chill touch*, *eldritch blast*, *minor illusion*, *true strike*\n2nd level (0 slots): *ray of enfeeblement*, *shatter*\n3rd level (0 slots): *hold person*, *magic circle*, *major image*, *vampiric touch*\n4th level (0 slots): *banishment*, *blight*, *dimension door*, *hallucinatory terrain*\n5th level (4 slots): *contact other plane*, *dream*, *hold monster*, *scrying*\n6th level (1/long rest): *create undead*\n7th level (1/long rest): *forcecage*\n8th level (1/long rest): *demiplane*\n9th level (1/long rest): *imprisonment*'}                                        | ${'The commoner is a 18th-level spellcaster. Its spellcasting ability is Charisma (spell save DC 19, +11 to hit with spell attacks). The commoner has the following warlock spells prepared:\n\nCantrips (at will): <em>chill touch</em>, <em>eldritch blast</em>, <em>minor illusion</em>, <em>true strike</em>\n2nd level (0 slots): <em>ray of enfeeblement</em>, <em>shatter</em>\n3rd level (0 slots): <em>hold person</em>, <em>magic circle</em>, <em>major image</em>, <em>vampiric touch</em>\n4th level (0 slots): <em>banishment</em>, <em>blight</em>, <em>dimension door</em>, <em>hallucinatory terrain</em>\n5th level (4 slots): <em>contact other plane</em>, <em>dream</em>, <em>hold monster</em>, <em>scrying</em>\n6th level (1/long rest): <em>create undead</em>\n7th level (1/long rest): <em>forcecage</em>\n8th level (1/long rest): <em>demiplane</em>\n9th level (1/long rest): <em>imprisonment</em>'}
      ${'Level 19 Warlock'} | ${19} | ${22}        | ${6}             | ${['Chill Touch', 'Eldritch Blast', 'Minor Illusion', 'True Strike']} | ${['Hellish Rebuke']}                                           | ${['Ray of Enfeeblement', 'Shatter']}                             | ${['Hold Person', 'Magic Circle', 'Major Image', 'Vampiric Touch']} | ${['Banishment', 'Blight', 'Dimension Door', 'Hallucinatory Terrain']} | ${['Contact Other Plane', 'Dream', 'Hold Monster', 'Scrying']} | ${['Create Undead']} | ${['Forcecage']} | ${['Demiplane']} | ${['Imprisonment']} | ${'[name] is a 19th-level spellcaster. Its spellcasting ability is Charisma (spell save DC sdc[cha], atk[cha] to hit with spell attacks). [name] has the following warlock spells prepared:\n\nCantrips (at will): *chill touch*, *eldritch blast*, *minor illusion*, *true strike*\n1st level (0 slots): *hellish rebuke*\n2nd level (0 slots): *ray of enfeeblement*, *shatter*\n3rd level (0 slots): *hold person*, *magic circle*, *major image*, *vampiric touch*\n4th level (0 slots): *banishment*, *blight*, *dimension door*, *hallucinatory terrain*\n5th level (4 slots): *contact other plane*, *dream*, *hold monster*, *scrying*\n6th level (1/long rest): *create undead*\n7th level (1/long rest): *forcecage*\n8th level (1/long rest): *demiplane*\n9th level (1/long rest): *imprisonment*'} | ${'The commoner is a 19th-level spellcaster. Its spellcasting ability is Charisma (spell save DC 20, +12 to hit with spell attacks). The commoner has the following warlock spells prepared:\n\nCantrips (at will): <em>chill touch</em>, <em>eldritch blast</em>, <em>minor illusion</em>, <em>true strike</em>\n1st level (0 slots): <em>hellish rebuke</em>\n2nd level (0 slots): <em>ray of enfeeblement</em>, <em>shatter</em>\n3rd level (0 slots): <em>hold person</em>, <em>magic circle</em>, <em>major image</em>, <em>vampiric touch</em>\n4th level (0 slots): <em>banishment</em>, <em>blight</em>, <em>dimension door</em>, <em>hallucinatory terrain</em>\n5th level (4 slots): <em>contact other plane</em>, <em>dream</em>, <em>hold monster</em>, <em>scrying</em>\n6th level (1/long rest): <em>create undead</em>\n7th level (1/long rest): <em>forcecage</em>\n8th level (1/long rest): <em>demiplane</em>\n9th level (1/long rest): <em>imprisonment</em>'}
      ${'Level 20 Warlock'} | ${20} | ${22}        | ${6}             | ${['Chill Touch', 'Eldritch Blast', 'Minor Illusion', 'True Strike']} | ${['Hellish Rebuke']}                                           | ${['Ray of Enfeeblement', 'Shatter']}                             | ${['Hold Person', 'Magic Circle', 'Major Image', 'Vampiric Touch']} | ${['Banishment', 'Blight', 'Dimension Door', 'Hallucinatory Terrain']} | ${['Contact Other Plane', 'Dream', 'Hold Monster', 'Scrying']} | ${['Create Undead']} | ${['Forcecage']} | ${['Demiplane']} | ${['Imprisonment']} | ${'[name] is a 20th-level spellcaster. Its spellcasting ability is Charisma (spell save DC sdc[cha], atk[cha] to hit with spell attacks). [name] has the following warlock spells prepared:\n\nCantrips (at will): *chill touch*, *eldritch blast*, *minor illusion*, *true strike*\n1st level (0 slots): *hellish rebuke*\n2nd level (0 slots): *ray of enfeeblement*, *shatter*\n3rd level (0 slots): *hold person*, *magic circle*, *major image*, *vampiric touch*\n4th level (0 slots): *banishment*, *blight*, *dimension door*, *hallucinatory terrain*\n5th level (4 slots): *contact other plane*, *dream*, *hold monster*, *scrying*\n6th level (1/long rest): *create undead*\n7th level (1/long rest): *forcecage*\n8th level (1/long rest): *demiplane*\n9th level (1/long rest): *imprisonment*'} | ${'The commoner is a 20th-level spellcaster. Its spellcasting ability is Charisma (spell save DC 20, +12 to hit with spell attacks). The commoner has the following warlock spells prepared:\n\nCantrips (at will): <em>chill touch</em>, <em>eldritch blast</em>, <em>minor illusion</em>, <em>true strike</em>\n1st level (0 slots): <em>hellish rebuke</em>\n2nd level (0 slots): <em>ray of enfeeblement</em>, <em>shatter</em>\n3rd level (0 slots): <em>hold person</em>, <em>magic circle</em>, <em>major image</em>, <em>vampiric touch</em>\n4th level (0 slots): <em>banishment</em>, <em>blight</em>, <em>dimension door</em>, <em>hallucinatory terrain</em>\n5th level (4 slots): <em>contact other plane</em>, <em>dream</em>, <em>hold monster</em>, <em>scrying</em>\n6th level (1/long rest): <em>create undead</em>\n7th level (1/long rest): <em>forcecage</em>\n8th level (1/long rest): <em>demiplane</em>\n9th level (1/long rest): <em>imprisonment</em>'}
    `
    ('$description',
    ({level, abilityScore, proficiencyBonus, cantrips, level1Spells, level2Spells, level3Spells, level4Spells, level5Spells, level6Spells, level7Spells, level8Spells, level9Spells, expectedGeneratedText, expectedRenderedText}) => {
      const abilityName = 'charisma';

      abilitiesModel.abilities[abilityName].score = abilityScore;
      challengeRatingModel.proficiencyBonus = proficiencyBonus;

      const spellcastingModel = new Spellcasting();
      spellcastingModel.spellcasterType = 'warlock';
      spellcastingModel.spellcasterAbility = abilityName;
      spellcastingModel.spellcasterLevel = level;

      spellcastingModel.spellCategories[0].spells = cantrips;
      for (let spellLevel = 1; spellLevel <= 9; spellLevel++) {
        spellcastingModel.spellCategories[spellLevel].spells = eval(`level${spellLevel}Spells`);
      }

      setDialogControls(spellcastingModel);

      verifyDialogModel(spellcastingModel, expectedGeneratedText);
      verifyDialogControls(spellcastingModel, expectedRenderedText);

      generateSpellcastingDialog.generateSpellcastingButton.click();

      verifySpecialTraitBlocks(spellcastingModel.spellcasterType, expectedGeneratedText, expectedRenderedText);
    });
    /* eslint-enable indent, no-unexpected-multiline, no-unused-vars */
  });

  describe('and the dialog is submitted for a wizard spellcaster, it should add a new spellcasting block under special traits', () => {
    // TODO
  });
});

function createDummySpellcastingModel() {
  const spellcastingModel = new Spellcasting();

  spellcastingModel.spellcasterType = 'wizard';
  spellcastingModel.spellcasterAbility = 'intelligence';
  spellcastingModel.spellcasterLevel = 18;

  spellcastingModel.spellCategories[0].spells = ['Fire Bolt', 'Light', 'Mage Hand', 'Prestidigitation', 'Shocking Grasp'];
  spellcastingModel.spellCategories[1].spells = ['Detect Magic', 'Identify', 'Mage Armor', 'Magic Missile'];
  spellcastingModel.spellCategories[2].spells = ['Detect Thoughts', 'Mirror Image', 'Misty Step'];
  spellcastingModel.spellCategories[3].spells = ['Counterspell', 'Fly', 'Lightning Bolt'];
  spellcastingModel.spellCategories[4].spells = ['Banishment', 'Fire Shield', 'Stoneskin'];
  spellcastingModel.spellCategories[5].spells = ['Cone of Cold', 'Scrying', 'Wall of Force'];
  spellcastingModel.spellCategories[6].spells = ['Globe of Invulnerability'];
  spellcastingModel.spellCategories[7].spells = ['Teleport'];
  spellcastingModel.spellCategories[8].spells = ['Mind Blank'];
  spellcastingModel.spellCategories[9].spells = ['Time Stop'];

  return spellcastingModel;
}

function setDialogControls(spellcastingModel, setSpellcasterAbility = false) {
  inputValueAndTriggerEvent(generateSpellcastingDialog.spellcasterTypeSelect, spellcastingModel.spellcasterType);

  // When the Spellcaster Type is changed, the Spellcaster Ability is
  // automatically set to the corresponding value. If we need to manually set
  // it to some other ability, set 'setSpellcasterAbility' to true.
  if (setSpellcasterAbility) {
    inputValueAndTriggerEvent(generateSpellcastingDialog.spellcasterAbilitySelect, spellcastingModel.spellcasterAbility);
  }

  inputValueAndTriggerEvent(generateSpellcastingDialog.spellcasterLevelInput, spellcastingModel.spellcasterLevel);

  if (! spellcastingModel.requiresVerbalComponents) generateSpellcastingDialog.verbalComponentInput.click();
  if (! spellcastingModel.requiresSomaticComponents) generateSpellcastingDialog.somaticComponentInput.click();
  if (! spellcastingModel.requiresMaterialComponents) generateSpellcastingDialog.materialComponentInput.click();

  for (let spellLevel = 0; spellLevel <= 9; spellLevel++) {
    const propertyList = generateSpellcastingDialog.spellCategoryBoxes[spellLevel].propertyList;
    const spells = spellcastingModel.spellCategories[spellLevel].spells;

    for (const spell of spells) {
      propertyList.input.value = spell;
      propertyList.addButton.click();
    }
  }
}

function verifyDialogModel(expectedModel, expectedGeneratedText) {
  const spellcastingModel = generateSpellcastingDialog.spellcastingModel;

  expect(spellcastingModel.spellcasterType).toBe(expectedModel.spellcasterType);
  expect(spellcastingModel.spellcasterAbility).toBe(expectedModel.spellcasterAbility);
  expect(spellcastingModel.spellcasterLevel).toBe(expectedModel.spellcasterLevel);

  expect(spellcastingModel.requiresVerbalComponents).toBe(spellcastingModel.requiresVerbalComponents);
  expect(spellcastingModel.requiresSomaticComponents).toBe(spellcastingModel.requiresSomaticComponents);
  expect(spellcastingModel.requiresMaterialComponents).toBe(spellcastingModel.requiresMaterialComponents);

  for (let spellLevel = 0; spellLevel <= 9; spellLevel++) {
    const spellCategory = spellcastingModel.spellCategories[spellLevel];
    const expectedSpellCategory = expectedModel.spellCategories[spellLevel];

    expectedSpellCategory.level = spellLevel;
    verifyDialogModelSpellCategory(spellCategory, expectedSpellCategory);
  }

  expect(spellcastingModel.generatedText).toBe(expectedGeneratedText);
}

function verifyDialogModelSpellCategory(spellCategory, expectedSpellCategory) {
  expect(spellCategory.isEnabled).toBe(expectedSpellCategory.isEnabled);
  expect(spellCategory.level).toBe(expectedSpellCategory.level);
  expect(spellCategory.spells).toStrictEqual(expectedSpellCategory.spells);
}

function verifyDialogControls(expectedModel, expectedRenderedText) {
  expect(generateSpellcastingDialog.spellcasterTypeSelect.value).toBe(expectedModel.spellcasterType);
  expect(generateSpellcastingDialog.spellcasterAbilitySelect.value).toBe(expectedModel.spellcasterAbility);
  expect(generateSpellcastingDialog.spellcasterLevelInput.valueAsInt).toBe(expectedModel.spellcasterLevel);

  expect(generateSpellcastingDialog.verbalComponentInput.checked).toBe(expectedModel.requiresVerbalComponents);
  expect(generateSpellcastingDialog.somaticComponentInput.checked).toBe(expectedModel.requiresSomaticComponents);
  expect(generateSpellcastingDialog.materialComponentInput.checked).toBe(expectedModel.requiresMaterialComponents);

  // Innate Spellcaster
  if (expectedModel.spellcasterType === 'innate') {
    for (let spellLevel = 0; spellLevel <= 9; spellLevel++) {
      const expectedSpellCategory = expectedModel.spellCategories[spellLevel];
      const spellCategoryBox = generateSpellcastingDialog.spellCategoryBoxes[spellLevel];

      switch(spellLevel) {
      case 0:
        expect(spellCategoryBox.disabled).toBe(false);
        expect(spellCategoryBox.heading.textContent).toBe('At will');
        break;
      case 1:
        expect(spellCategoryBox.disabled).toBe(false);
        expect(spellCategoryBox.heading.textContent).toBe('3/day each');
        break;
      case 2:
        expect(spellCategoryBox.disabled).toBe(false);
        expect(spellCategoryBox.heading.textContent).toBe('2/day each');
        break;
      case 3:
        expect(spellCategoryBox.disabled).toBe(false);
        expect(spellCategoryBox.heading.textContent).toBe('1/day each');
        break;
      default:
        expect(spellCategoryBox.disabled).toBe(true);
        expect(spellCategoryBox.heading.textContent).toBe('');
      }

      expect(spellCategoryBox.propertyList.itemsAsText).toStrictEqual(expectedSpellCategory.spells);
    }

    expect(generateSpellcastingDialog.previewNameElement.textContent).toBe('Innate Spellcasting');

  // Generic Spellcaster
  } else if (expectedModel.spellcasterType === 'generic') {
    for (let spellLevel = 0; spellLevel <= 9; spellLevel++) {
      const expectedSpellCategory = expectedModel.spellCategories[spellLevel];
      const spellCategoryBox = generateSpellcastingDialog.spellCategoryBoxes[spellLevel];
      const formattedSpellLevel = formatIntegerWithOrdinalIndicator(spellLevel);

      expect(spellCategoryBox.disabled).toBe(false);

      // Cantrips
      if (spellLevel === 0) {
        expect(spellCategoryBox.heading.textContent).toBe('Cantrips (at will)');

      // Levelled Spells
      } else {
        expect(spellCategoryBox.heading.textContent).toBe(`${formattedSpellLevel} level`);
      }

      expect(spellCategoryBox.propertyList.itemsAsText).toStrictEqual(expectedSpellCategory.spells);
    }

  // Class-specific Spellcaster
  } else {
    const expectedSpellSlots = SpellcasterTypes[expectedModel.spellcasterType].levels[expectedModel.spellcasterLevel].spellSlots;

    for (let spellLevel = 0; spellLevel <= 9; spellLevel++) {
      const expectedSpellCategory = expectedModel.spellCategories[spellLevel];
      const spellCategoryBox = generateSpellcastingDialog.spellCategoryBoxes[spellLevel];

      // Cantrips
      if (spellLevel === 0 && SpellcasterTypes[expectedModel.spellcasterType].hasCantrips) {
        expect(spellCategoryBox.disabled).toBe(false);
        expect(spellCategoryBox.heading.textContent).toBe('Cantrips (at will)');

      // Levelled Spells
      } else if (spellLevel > 0 && spellLevel <= expectedSpellSlots.length) {
        const formattedSpellLevel = formatIntegerWithOrdinalIndicator(spellLevel);

        expect(spellCategoryBox.disabled).toBe(false);

        let expectedHeading;

        // Warlock Mystic Arcanum Feature: Lavel 6 to 9 spells are available once per long rest
        if (expectedModel.spellcasterType === 'warlock' && spellLevel >= 6) {
          expectedHeading = `${formattedSpellLevel} level (1/long rest)`;
        } else {
          const expectedSlotQuantity = expectedSpellSlots[spellLevel - 1];
          const formattedSlotQuantity = formatSpellSlotQuantity(expectedSlotQuantity);
          expectedHeading = `${formattedSpellLevel} level (${formattedSlotQuantity})`;
        }

        expect(spellCategoryBox.heading.textContent).toBe(expectedHeading);

      // Everything else should be disabled
      } else {
        expect(spellCategoryBox.disabled).toBe(true);
        expect(spellCategoryBox.heading.textContent).toBe('');
      }

      expect(spellCategoryBox.propertyList.itemsAsText).toStrictEqual(expectedSpellCategory.spells);
    }

    expect(generateSpellcastingDialog.previewNameElement.textContent).toBe('Spellcasting');
  }

  expect(generateSpellcastingDialog.previewTextElement.innerHTMLSanitized).toBe(expectedRenderedText);
}

function verifyDialogResetToDefaults() {
  verifyDialogModelResetToDefaults();
  verifyDialogControlsResetToDefaults();

  expect(generateSpellcastingDialog.spellcasterTypeSelect).toHaveFocus();
}

function verifyDialogModelResetToDefaults() {
  const expectedGeneratedText = '[name] is a 1st-level spellcaster. Its spellcasting ability is Charisma (spell save DC sdc[cha], atk[cha] to hit with spell attacks). [name] has the following spells prepared:\n\n';

  verifyDialogModel(new Spellcasting(), expectedGeneratedText);
}

function verifyDialogControlsResetToDefaults() {
  const expectedRenderedText = 'The commoner is a 1st-level spellcaster. Its spellcasting ability is Charisma (spell save DC 10, +2 to hit with spell attacks). The commoner has the following spells prepared:\n\n';

  verifyDialogControls(new Spellcasting(), expectedRenderedText);
}

function verifySpecialTraitBlocks(expectedSpellcasterType, expectedGeneratedText, expectedRenderedText) {
  const blockName = (expectedSpellcasterType === 'innate') ? 'Innate Spellcasting' : 'Spellcasting';

  const editableBlock = specialTraitsSection.editElements.editableBlockList.blocks[0];
  expect(editableBlock.name).toBe(blockName);
  expect(editableBlock.text).toBe(expectedGeneratedText);
  expect(editableBlock.previewName).toBe(blockName);
  expect(editableBlock.previewText).toBe(expectedRenderedText);

  specialTraitsSection.editElements.submitForm();

  const displayBlock = specialTraitsSection.showElements.displayBlockList.blocks[0];
  expect(displayBlock.name).toBe(blockName);
  expect(displayBlock.text).toBe(expectedRenderedText);
}